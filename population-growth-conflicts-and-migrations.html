<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Population growth, conflicts and migrations | Methods Riddles, the ultimate revelations</title>
  <meta name="description" content="First draft of Rbookdown to describe how data have been generated" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Population growth, conflicts and migrations | Methods Riddles, the ultimate revelations" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="First draft of Rbookdown to describe how data have been generated" />
  <meta name="github-repo" content="acortell3/archaeoriddle" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Population growth, conflicts and migrations | Methods Riddles, the ultimate revelations" />
  
  <meta name="twitter:description" content="First draft of Rbookdown to describe how data have been generated" />
  

<meta name="author" content="CDAL" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="landscape-climate-environment.html"/>
<link rel="next" href="record-formation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.11/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-archaeoriddle"><i class="fa fa-check"></i><b>1.1</b> What is archaeoriddle?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-will-you-find-in-this-bookdown"><i class="fa fa-check"></i><b>1.2</b> What will you find in this bookdown?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-can-you-do-with-this"><i class="fa fa-check"></i><b>1.3</b> What can you do with this?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="landscape-climate-environment.html"><a href="landscape-climate-environment.html"><i class="fa fa-check"></i><b>2</b> Landscape, climate &amp; Environment</a>
<ul>
<li class="chapter" data-level="2.1" data-path="landscape-climate-environment.html"><a href="landscape-climate-environment.html#temperature-and-climate"><i class="fa fa-check"></i><b>2.1</b> Temperature and climate</a></li>
<li class="chapter" data-level="2.2" data-path="landscape-climate-environment.html"><a href="landscape-climate-environment.html#slope-and-elevation"><i class="fa fa-check"></i><b>2.2</b> Slope and Elevation</a></li>
<li class="chapter" data-level="2.3" data-path="landscape-climate-environment.html"><a href="landscape-climate-environment.html#environmental-resources"><i class="fa fa-check"></i><b>2.3</b> Environmental resources</a></li>
<li class="chapter" data-level="2.4" data-path="landscape-climate-environment.html"><a href="landscape-climate-environment.html#manual-selection"><i class="fa fa-check"></i><b>2.4</b> Manually Select Resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="population-growth-conflicts-and-migrations.html"><a href="population-growth-conflicts-and-migrations.html"><i class="fa fa-check"></i><b>3</b> Population growth, conflicts and migrations</a>
<ul>
<li class="chapter" data-level="3.1" data-path="population-growth-conflicts-and-migrations.html"><a href="population-growth-conflicts-and-migrations.html#settlements-position"><i class="fa fa-check"></i><b>3.1</b> Settlements position</a></li>
<li class="chapter" data-level="3.2" data-path="population-growth-conflicts-and-migrations.html"><a href="population-growth-conflicts-and-migrations.html#network-site-size-and-climate-deprecated"><i class="fa fa-check"></i><b>3.2</b> Network, Site Size And Climate – DEPRECATED</a></li>
<li class="chapter" data-level="3.3" data-path="population-growth-conflicts-and-migrations.html"><a href="population-growth-conflicts-and-migrations.html#initializing-site-size-and-culture"><i class="fa fa-check"></i><b>3.3</b> Initializing Site Size and Culture:</a></li>
<li class="chapter" data-level="3.4" data-path="population-growth-conflicts-and-migrations.html"><a href="population-growth-conflicts-and-migrations.html#population-growth"><i class="fa fa-check"></i><b>3.4</b> Population Growth</a></li>
<li class="chapter" data-level="3.5" data-path="population-growth-conflicts-and-migrations.html"><a href="population-growth-conflicts-and-migrations.html#migration"><i class="fa fa-check"></i><b>3.5</b> Migration</a></li>
<li class="chapter" data-level="3.6" data-path="population-growth-conflicts-and-migrations.html"><a href="population-growth-conflicts-and-migrations.html#conflict-and-war"><i class="fa fa-check"></i><b>3.6</b> Conflict and War</a></li>
<li class="chapter" data-level="3.7" data-path="population-growth-conflicts-and-migrations.html"><a href="population-growth-conflicts-and-migrations.html#run-simulation"><i class="fa fa-check"></i><b>3.7</b> Run Simulation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="record-formation.html"><a href="record-formation.html"><i class="fa fa-check"></i><b>4</b> Record formation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="record-formation.html"><a href="record-formation.html#theoretical-model"><i class="fa fa-check"></i><b>4.1</b> Theoretical model</a></li>
<li class="chapter" data-level="4.2" data-path="record-formation.html"><a href="record-formation.html#implementation"><i class="fa fa-check"></i><b>4.2</b> Implementation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="record-formation.html"><a href="record-formation.html#population-pop-protocol"><i class="fa fa-check"></i><b>4.2.1</b> Population <span class="math inline">\(Pop\)</span>-protocol</a></li>
<li class="chapter" data-level="4.2.2" data-path="record-formation.html"><a href="record-formation.html#anthropogenic-deposition-a-protocol"><i class="fa fa-check"></i><b>4.2.2</b> Anthropogenic deposition <span class="math inline">\(A\)</span>-protocol</a></li>
<li class="chapter" data-level="4.2.3" data-path="record-formation.html"><a href="record-formation.html#depth-d-protocol"><i class="fa fa-check"></i><b>4.2.3</b> Depth <span class="math inline">\(D\)</span>-protocol</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="record-formation.html"><a href="record-formation.html#example-and-simulation"><i class="fa fa-check"></i><b>4.3</b> Example and simulation</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="record-loss.html"><a href="record-loss.html"><i class="fa fa-check"></i><b>5</b> Record loss</a>
<ul>
<li class="chapter" data-level="5.1" data-path="record-loss.html"><a href="record-loss.html#theoretical-model-1"><i class="fa fa-check"></i><b>5.1</b> Theoretical model</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="record-loss.html"><a href="record-loss.html#general-purpose"><i class="fa fa-check"></i><b>5.1.1</b> General purpose</a></li>
<li class="chapter" data-level="5.1.2" data-path="record-loss.html"><a href="record-loss.html#model-layers"><i class="fa fa-check"></i><b>5.1.2</b> Model layers</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="record-loss.html"><a href="record-loss.html#implementation-1"><i class="fa fa-check"></i><b>5.2</b> Implementation</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="final-choice-and-simulation.html"><a href="final-choice-and-simulation.html"><i class="fa fa-check"></i><b>6</b> Final Choice and simulation</a></li>
<li class="chapter" data-level="7" data-path="generate-archaeological-remaind-and-squares.html"><a href="generate-archaeological-remaind-and-squares.html"><i class="fa fa-check"></i><b>7</b> Generate Archaeological remaind and squares</a>
<ul>
<li class="chapter" data-level="7.1" data-path="generate-archaeological-remaind-and-squares.html"><a href="generate-archaeological-remaind-and-squares.html#using-sites-size-to-generate-deposite"><i class="fa fa-check"></i><b>7.1</b> Using sites size to generate deposite</a></li>
<li class="chapter" data-level="7.2" data-path="generate-archaeological-remaind-and-squares.html"><a href="generate-archaeological-remaind-and-squares.html#split-environment-in-a-grid"><i class="fa fa-check"></i><b>7.2</b> Split environment in a grid</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="archaoriddle-the-original.html"><a href="archaoriddle-the-original.html"><i class="fa fa-check"></i><b>8</b> Archaoriddle: the original</a></li>
<li class="divider"></li>
<li><a href="https://github.com/acortell3/archaeoriddle/">
source</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Methods Riddles, the ultimate revelations</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="population-growth-conflicts-and-migrations" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Population growth, conflicts and migrations<a href="population-growth-conflicts-and-migrations.html#population-growth-conflicts-and-migrations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="settlements-position" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Settlements position<a href="population-growth-conflicts-and-migrations.html#settlements-position" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="population-growth-conflicts-and-migrations.html#cb26-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># we will create  20 sites</span></span>
<span id="cb26-2"><a href="population-growth-conflicts-and-migrations.html#cb26-2" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n) <span class="co">#assign a size for each site following an exponential distribution </span></span></code></pre></div>
<p>Thanks to the previous chapter, use <code>spatSample</code> from package <code>terra</code> to randomly select <code>n</code> points (20 for this simulation) on this viable polygon.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="population-growth-conflicts-and-migrations.html#cb27-1" tabindex="-1"></a>sites <span class="ot">&lt;-</span> <span class="fu">spatSample</span>(viable, n) <span class="co"># generate n random points within the viable polygon and assign to variable sites</span></span>
<span id="cb27-2"><a href="population-growth-conflicts-and-migrations.html#cb27-2" tabindex="-1"></a><span class="fu">plot</span>(height.ras<span class="sc">^</span><span class="fl">1.9</span>, <span class="at">col=</span><span class="fu">col_ramp</span>(<span class="dv">50</span>), <span class="at">legend=</span>F, <span class="at">reset=</span>F)</span>
<span id="cb27-3"><a href="population-growth-conflicts-and-migrations.html#cb27-3" tabindex="-1"></a><span class="fu">plot</span>(height.wat, <span class="at">col=</span><span class="st">&quot;lightblue&quot;</span>, <span class="at">add=</span>T, <span class="at">legend=</span>F)</span>
<span id="cb27-4"><a href="population-growth-conflicts-and-migrations.html#cb27-4" tabindex="-1"></a><span class="fu">plot</span>(sites, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">add=</span>T, <span class="at">bg=</span><span class="fu">rainbow</span>(<span class="fu">length</span>(sites), <span class="at">alpha=</span>.<span class="dv">6</span>))</span>
<span id="cb27-5"><a href="population-growth-conflicts-and-migrations.html#cb27-5" tabindex="-1"></a></span>
<span id="cb27-6"><a href="population-growth-conflicts-and-migrations.html#cb27-6" tabindex="-1"></a><span class="co"># get only the non submerged actual land and plot it</span></span>
<span id="cb27-7"><a href="population-growth-conflicts-and-migrations.html#cb27-7" tabindex="-1"></a>above_level <span class="ot">&lt;-</span> height.ras <span class="sc">&gt;</span> <span class="fu">mean</span>(height.ras[])</span>
<span id="cb27-8"><a href="population-growth-conflicts-and-migrations.html#cb27-8" tabindex="-1"></a>coastline <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="fu">as.polygons</span>(above_level))[<span class="dv">2</span>,]</span>
<span id="cb27-9"><a href="population-growth-conflicts-and-migrations.html#cb27-9" tabindex="-1"></a><span class="fu">plot</span>(coastline, <span class="at">col=</span><span class="cn">NA</span>, <span class="at">bgc=</span><span class="fu">adjustcolor</span>(<span class="st">&quot;cyan&quot;</span>, <span class="fl">0.1</span>), <span class="at">add=</span>T)</span></code></pre></div>
<p><img src="_main_files/figure-html/samplesites-1.png" width="672" /></p>
<p>In the context of <a href="https://theia.arch.cam.ac.uk/archaeoriddle/">the archaeoriddle challenge</a>, files that describe this newly generated environment (the DEM and the coastline), the resources and the positions of the sites sampled needs to be produced and given to the participant. This can be done as:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="population-growth-conflicts-and-migrations.html#cb28-1" tabindex="-1"></a>foldname<span class="ot">=</span><span class="st">&quot;data_toshare&quot;</span> <span class="co">#We will store all data that can/will be shared with participant in data_toshare</span></span>
<span id="cb28-2"><a href="population-growth-conflicts-and-migrations.html#cb28-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(foldname))<span class="fu">dir.create</span>(foldname)</span>
<span id="cb28-3"><a href="population-growth-conflicts-and-migrations.html#cb28-3" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">dsn=</span><span class="fu">file.path</span>(foldname,<span class="st">&quot;coastline.shp&quot;</span>), coastline,<span class="at">append=</span>F) <span class="co"># Write the coastline as a shapefile</span></span>
<span id="cb28-4"><a href="population-growth-conflicts-and-migrations.html#cb28-4" tabindex="-1"></a><span class="do">## Writing layer `coastline&#39; to data source </span></span>
<span id="cb28-5"><a href="population-growth-conflicts-and-migrations.html#cb28-5" tabindex="-1"></a><span class="do">##   `data_toshare/coastline.shp&#39; using driver `ESRI Shapefile&#39;</span></span>
<span id="cb28-6"><a href="population-growth-conflicts-and-migrations.html#cb28-6" tabindex="-1"></a><span class="do">## Writing 1 features with 1 fields and geometry type Multi Polygon.</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="population-growth-conflicts-and-migrations.html#cb29-1" tabindex="-1"></a><span class="fu">writeRaster</span>(<span class="at">filename=</span><span class="fu">file.path</span>(foldname,<span class="st">&quot;dem_raster.tiff&quot;</span>), height.ras, <span class="at">overwrite=</span>T) <span class="co">#write the DEM as a raster</span></span>
<span id="cb29-2"><a href="population-growth-conflicts-and-migrations.html#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="population-growth-conflicts-and-migrations.html#cb29-3" tabindex="-1"></a><span class="fu">writeRaster</span>(<span class="at">filename=</span><span class="fu">file.path</span>(foldname,<span class="st">&quot;resources.tiff&quot;</span>), ress, <span class="at">overwrite=</span>T) <span class="co">#write the resources as a raster</span></span></code></pre></div>
<p>The original data, saved and shared for the <em>archaeoriddle</em> are stored in <code>data_original/</code></p>
</div>
<div id="network-site-size-and-climate-deprecated" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Network, Site Size And Climate – DEPRECATED<a href="population-growth-conflicts-and-migrations.html#network-site-size-and-climate-deprecated" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following steps were designed but never used ; they can be quite fun and useful.</p>
<hr />
<p>Create a network between sites (requires <code>igraph</code>)</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="population-growth-conflicts-and-migrations.html#cb30-1" tabindex="-1"></a></span>
<span id="cb30-2"><a href="population-growth-conflicts-and-migrations.html#cb30-2" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb30-3"><a href="population-growth-conflicts-and-migrations.html#cb30-3" tabindex="-1"></a>subsites  <span class="ot">&lt;-</span> sites</span>
<span id="cb30-4"><a href="population-growth-conflicts-and-migrations.html#cb30-4" tabindex="-1"></a><span class="fu">crs</span>(subsites) <span class="ot">&lt;-</span> <span class="st">&quot;+proj=lonlat&quot;</span></span>
<span id="cb30-5"><a href="population-growth-conflicts-and-migrations.html#cb30-5" tabindex="-1"></a>subsites <span class="ot">&lt;-</span> sites[<span class="fu">sample</span>(<span class="fu">nrow</span>(sites), <span class="dv">20</span>), ]</span>
<span id="cb30-6"><a href="population-growth-conflicts-and-migrations.html#cb30-6" tabindex="-1"></a>ig <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(</span>
<span id="cb30-7"><a href="population-growth-conflicts-and-migrations.html#cb30-7" tabindex="-1"></a>  <span class="fu">as.matrix</span>(<span class="fu">distance</span>(subsites)), <span class="at">weighted=</span>T, <span class="at">mode=</span><span class="st">&quot;undirected&quot;</span>)</span>
<span id="cb30-8"><a href="population-growth-conflicts-and-migrations.html#cb30-8" tabindex="-1"></a>ig <span class="ot">&lt;-</span> <span class="fu">set_graph_attr</span>(ig, <span class="st">&quot;layout&quot;</span>, <span class="fu">crds</span>(subsites))</span>
<span id="cb30-9"><a href="population-growth-conflicts-and-migrations.html#cb30-9" tabindex="-1"></a></span>
<span id="cb30-10"><a href="population-growth-conflicts-and-migrations.html#cb30-10" tabindex="-1"></a><span class="fu">V</span>(ig)<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb30-11"><a href="population-growth-conflicts-and-migrations.html#cb30-11" tabindex="-1"></a><span class="fu">V</span>(ig)<span class="sc">$</span>size <span class="ot">&lt;-</span> (size<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">5</span></span>
<span id="cb30-12"><a href="population-growth-conflicts-and-migrations.html#cb30-12" tabindex="-1"></a><span class="fu">V</span>(ig)<span class="sc">$</span>frame.color <span class="ot">&lt;-</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb30-13"><a href="population-growth-conflicts-and-migrations.html#cb30-13" tabindex="-1"></a><span class="fu">V</span>(ig)<span class="sc">$</span>frame.width <span class="ot">&lt;-</span> .<span class="dv">5</span></span>
<span id="cb30-14"><a href="population-growth-conflicts-and-migrations.html#cb30-14" tabindex="-1"></a><span class="fu">E</span>(ig)<span class="sc">$</span>weight <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="fu">E</span>(ig)<span class="sc">$</span>weight<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb30-15"><a href="population-growth-conflicts-and-migrations.html#cb30-15" tabindex="-1"></a><span class="fu">E</span>(ig)<span class="sc">$</span>width <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">E</span>(ig)<span class="sc">$</span>weight)<span class="sc">+</span>.<span class="dv">6</span></span>
<span id="cb30-16"><a href="population-growth-conflicts-and-migrations.html#cb30-16" tabindex="-1"></a></span>
<span id="cb30-17"><a href="population-growth-conflicts-and-migrations.html#cb30-17" tabindex="-1"></a>allcomu <span class="ot">&lt;-</span> <span class="fu">cluster_louvain</span>(ig)<span class="sc">$</span>memberships[<span class="dv">1</span>,]</span>
<span id="cb30-18"><a href="population-growth-conflicts-and-migrations.html#cb30-18" tabindex="-1"></a><span class="fu">V</span>(ig)<span class="sc">$</span>color <span class="ot">&lt;-</span> allcomu</span>
<span id="cb30-19"><a href="population-growth-conflicts-and-migrations.html#cb30-19" tabindex="-1"></a><span class="fu">E</span>(ig)<span class="sc">$</span>color <span class="ot">&lt;-</span> allcomu[<span class="fu">head_of</span>(ig,<span class="fu">E</span>(ig))]</span>
<span id="cb30-20"><a href="population-growth-conflicts-and-migrations.html#cb30-20" tabindex="-1"></a></span>
<span id="cb30-21"><a href="population-growth-conflicts-and-migrations.html#cb30-21" tabindex="-1"></a><span class="fu">plot</span>(height.ras<span class="sc">^</span><span class="fl">1.9</span>, <span class="at">col=</span><span class="fu">col_ramp</span>(<span class="dv">50</span>), <span class="at">legend=</span>F, <span class="at">reset=</span>F)</span>
<span id="cb30-22"><a href="population-growth-conflicts-and-migrations.html#cb30-22" tabindex="-1"></a><span class="fu">plot</span>(height.wat, <span class="at">col=</span><span class="st">&quot;lightblue&quot;</span>, <span class="at">add=</span>T, <span class="at">legend=</span>F)</span>
<span id="cb30-23"><a href="population-growth-conflicts-and-migrations.html#cb30-23" tabindex="-1"></a><span class="fu">plot</span>(ig, <span class="at">add=</span>T, <span class="at">rescale=</span>F, <span class="at">alpha=</span>.<span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/sitesnetwork-1.png" width="672" /></p>
<p>Visualise sites on the 3D plot</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="population-growth-conflicts-and-migrations.html#cb31-1" tabindex="-1"></a></span>
<span id="cb31-2"><a href="population-growth-conflicts-and-migrations.html#cb31-2" tabindex="-1"></a><span class="fu">plot_3d</span>(</span>
<span id="cb31-3"><a href="population-growth-conflicts-and-migrations.html#cb31-3" tabindex="-1"></a>  hm_lamb,height_map, <span class="at">zscale=</span><span class="dv">20</span>, <span class="at">fov=</span><span class="dv">0</span>, <span class="at">theta=</span><span class="dv">20</span>, <span class="at">zoom=</span><span class="dv">1</span>, <span class="at">phi=</span><span class="dv">45</span>,</span>
<span id="cb31-4"><a href="population-growth-conflicts-and-migrations.html#cb31-4" tabindex="-1"></a>  <span class="at">windowsize=</span><span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">800</span>), <span class="at">water=</span><span class="cn">TRUE</span>, <span class="at">waterdepth=</span><span class="fu">mean</span>(height),</span>
<span id="cb31-5"><a href="population-growth-conflicts-and-migrations.html#cb31-5" tabindex="-1"></a>  <span class="at">wateralpha=</span><span class="dv">1</span>, <span class="at">watercolor=</span><span class="st">&quot;lightblue&quot;</span>, <span class="at">waterlinecolor=</span><span class="st">&quot;lightblue&quot;</span>,</span>
<span id="cb31-6"><a href="population-growth-conflicts-and-migrations.html#cb31-6" tabindex="-1"></a>  <span class="at">waterlinealpha=</span>.<span class="dv">7</span></span>
<span id="cb31-7"><a href="population-growth-conflicts-and-migrations.html#cb31-7" tabindex="-1"></a>)</span>
<span id="cb31-8"><a href="population-growth-conflicts-and-migrations.html#cb31-8" tabindex="-1"></a></span>
<span id="cb31-9"><a href="population-growth-conflicts-and-migrations.html#cb31-9" tabindex="-1"></a><span class="fu">render_points</span>(</span>
<span id="cb31-10"><a href="population-growth-conflicts-and-migrations.html#cb31-10" tabindex="-1"></a>  <span class="at">extent=</span>raster<span class="sc">::</span><span class="fu">extent</span>(raster<span class="sc">::</span><span class="fu">raster</span>(height.ras)),</span>
<span id="cb31-11"><a href="population-growth-conflicts-and-migrations.html#cb31-11" tabindex="-1"></a>  <span class="at">lat=</span><span class="fl">2.13828</span>, <span class="at">long=</span><span class="sc">-</span><span class="fl">1.685547</span>, <span class="at">altitude=</span><span class="fu">extract</span>(height.ras,sites)[,<span class="dv">1</span>]<span class="sc">+</span><span class="dv">20</span>,</span>
<span id="cb31-12"><a href="population-growth-conflicts-and-migrations.html#cb31-12" tabindex="-1"></a>  <span class="at">zscale=</span><span class="dv">20</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">categorical_pal</span>(<span class="fu">max</span>(allcomu))[allcomu],</span>
<span id="cb31-13"><a href="population-growth-conflicts-and-migrations.html#cb31-13" tabindex="-1"></a>  <span class="at">clear_previous=</span><span class="cn">TRUE</span></span>
<span id="cb31-14"><a href="population-growth-conflicts-and-migrations.html#cb31-14" tabindex="-1"></a>)</span>
<span id="cb31-15"><a href="population-growth-conflicts-and-migrations.html#cb31-15" tabindex="-1"></a></span>
<span id="cb31-16"><a href="population-growth-conflicts-and-migrations.html#cb31-16" tabindex="-1"></a><span class="fu">render_points</span>(</span>
<span id="cb31-17"><a href="population-growth-conflicts-and-migrations.html#cb31-17" tabindex="-1"></a>  <span class="at">extent=</span>raster<span class="sc">::</span><span class="fu">extent</span>(raster<span class="sc">::</span><span class="fu">raster</span>(height.ras)),</span>
<span id="cb31-18"><a href="population-growth-conflicts-and-migrations.html#cb31-18" tabindex="-1"></a>  <span class="at">lat=</span><span class="fu">crds</span>(sites)[,<span class="st">&quot;y&quot;</span>], <span class="at">long=</span><span class="fu">crds</span>(sites)[,<span class="st">&quot;x&quot;</span>], <span class="at">altitude=</span><span class="fu">extract</span>(height.ras, sites)[,<span class="dv">1</span>]<span class="sc">+</span><span class="dv">20</span>,</span>
<span id="cb31-19"><a href="population-growth-conflicts-and-migrations.html#cb31-19" tabindex="-1"></a>  <span class="at">zscale=</span><span class="dv">20</span>, <span class="at">size=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">categorical_pal</span>(<span class="fu">max</span>(allcomu))[allcomu],</span>
<span id="cb31-20"><a href="population-growth-conflicts-and-migrations.html#cb31-20" tabindex="-1"></a>  <span class="at">clear_previous=</span><span class="cn">TRUE</span></span>
<span id="cb31-21"><a href="population-growth-conflicts-and-migrations.html#cb31-21" tabindex="-1"></a>)</span>
<span id="cb31-22"><a href="population-growth-conflicts-and-migrations.html#cb31-22" tabindex="-1"></a>       </span>
<span id="cb31-23"><a href="population-growth-conflicts-and-migrations.html#cb31-23" tabindex="-1"></a><span class="fu">render_highquality</span>(<span class="at">point_radius=</span><span class="dv">5</span>, <span class="at">samples=</span><span class="dv">256</span>, <span class="at">clear=</span><span class="cn">TRUE</span>, <span class="at">light=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>let’s say the climate modulate site size in a naive way:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="population-growth-conflicts-and-migrations.html#cb32-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, tstep, <span class="at">length.out=</span><span class="dv">100</span>)){</span>
<span id="cb32-2"><a href="population-growth-conflicts-and-migrations.html#cb32-2" tabindex="-1"></a>    <span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">nrow=</span><span class="dv">2</span>, <span class="at">ncol=</span><span class="dv">1</span>), <span class="at">heights=</span><span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">2</span>))</span>
<span id="cb32-3"><a href="population-growth-conflicts-and-migrations.html#cb32-3" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb32-4"><a href="population-growth-conflicts-and-migrations.html#cb32-4" tabindex="-1"></a>    <span class="fu">image</span>(m, <span class="at">ann=</span>F, <span class="at">axes=</span>F, <span class="at">main=</span>i)</span>
<span id="cb32-5"><a href="population-growth-conflicts-and-migrations.html#cb32-5" tabindex="-1"></a>    <span class="fu">mtext</span>(<span class="fu">round</span>(i), <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb32-6"><a href="population-growth-conflicts-and-migrations.html#cb32-6" tabindex="-1"></a>    nsize <span class="ot">&lt;-</span> size<span class="sc">*</span>faketemp[i] <span class="sc">+</span> size <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb32-7"><a href="population-growth-conflicts-and-migrations.html#cb32-7" tabindex="-1"></a>    <span class="fu">points</span>(<span class="fu">crds</span>(sites), <span class="at">bg=</span><span class="st">&quot;green&quot;</span>, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">cex=</span>nsize)</span>
<span id="cb32-8"><a href="population-growth-conflicts-and-migrations.html#cb32-8" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb32-9"><a href="population-growth-conflicts-and-migrations.html#cb32-9" tabindex="-1"></a>    <span class="fu">plot</span>(</span>
<span id="cb32-10"><a href="population-growth-conflicts-and-migrations.html#cb32-10" tabindex="-1"></a>      <span class="dv">1</span><span class="sc">:</span>tstep, faketemp, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;temp&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;time&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(faketemp),</span>
<span id="cb32-11"><a href="population-growth-conflicts-and-migrations.html#cb32-11" tabindex="-1"></a>      <span class="at">ann=</span>F, <span class="at">frame.plot=</span>F)</span>
<span id="cb32-12"><a href="population-growth-conflicts-and-migrations.html#cb32-12" tabindex="-1"></a>    <span class="fu">points</span>(i, faketemp[i], <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch=</span><span class="dv">20</span>)</span>
<span id="cb32-13"><a href="population-growth-conflicts-and-migrations.html#cb32-13" tabindex="-1"></a>}</span></code></pre></div>
<p>Population will then grow, for years and years. This implies multiple things: population need resources and a way to grow with regard to these resources and their own technologies.We initialised the ressource layer in the previous chapter
in <a href="#ressource">the section about ressources</a>. In the following sectinos we will use this ressource raster to initialise site size et define how ressource are used by the different culture.</p>
</div>
<div id="initializing-site-size-and-culture" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Initializing Site Size and Culture:<a href="population-growth-conflicts-and-migrations.html#initializing-site-size-and-culture" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Each site is then assigned as either belonging to the hunter-gather (HG) or farmer (F) culture.</p>
<p>To generate a more realistic distribution, all sites are initially, designated as hunter-gatherer sites, except for the one located in the most southwest position. Please note that this decision was based on the specific shape of the initial archaeoriddle’s challenge. If needed, you may want to manually select the site culture for this specific location.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="population-growth-conflicts-and-migrations.html#cb33-1" tabindex="-1"></a>cultures <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;HG&quot;</span>,<span class="fu">length</span>(sites))</span>
<span id="cb33-2"><a href="population-growth-conflicts-and-migrations.html#cb33-2" tabindex="-1"></a>sw <span class="ot">&lt;-</span> <span class="fu">which.min</span>(<span class="fu">sqrt</span>((<span class="fu">crds</span>(sites)[,<span class="st">&quot;x&quot;</span>] <span class="sc">-</span> <span class="fu">min</span>(<span class="fu">crds</span>(sites)[,<span class="st">&quot;x&quot;</span>]))<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="fu">crds</span>(sites)[,<span class="st">&quot;y&quot;</span>] <span class="sc">-</span> <span class="fu">min</span>(<span class="fu">crds</span>(sites)[,<span class="st">&quot;y&quot;</span>]))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb33-3"><a href="population-growth-conflicts-and-migrations.html#cb33-3" tabindex="-1"></a>cultures[sw]<span class="ot">=</span><span class="st">&quot;F&quot;</span></span>
<span id="cb33-4"><a href="population-growth-conflicts-and-migrations.html#cb33-4" tabindex="-1"></a>sites<span class="sc">$</span>culture <span class="ot">&lt;-</span> cultures</span>
<span id="cb33-5"><a href="population-growth-conflicts-and-migrations.html#cb33-5" tabindex="-1"></a></span>
<span id="cb33-6"><a href="population-growth-conflicts-and-migrations.html#cb33-6" tabindex="-1"></a><span class="fu">plotMap</span>(height.ras,height.wat)</span>
<span id="cb33-7"><a href="population-growth-conflicts-and-migrations.html#cb33-7" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">crds</span>(sites),<span class="at">bg=</span><span class="fu">as.factor</span>(cultures),<span class="at">pch=</span><span class="dv">21</span>,<span class="at">cex=</span><span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/setcultures-1.png" width="672" /></p>
<p>Each site will then be assigned a carrying capacity (how many people can leave on the site), probabilistically defined using the resource raster and the culture of the site.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="population-growth-conflicts-and-migrations.html#cb34-1" tabindex="-1"></a></span>
<span id="cb34-2"><a href="population-growth-conflicts-and-migrations.html#cb34-2" tabindex="-1"></a>Kbase <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">45</span>,<span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">120</span>) <span class="co">#difference in base-K for the two cultures</span></span>
<span id="cb34-3"><a href="population-growth-conflicts-and-migrations.html#cb34-3" tabindex="-1"></a></span>
<span id="cb34-4"><a href="population-growth-conflicts-and-migrations.html#cb34-4" tabindex="-1"></a><span class="co"># The base Ks  are then modulated given the ressource raster</span></span>
<span id="cb34-5"><a href="population-growth-conflicts-and-migrations.html#cb34-5" tabindex="-1"></a>sites<span class="sc">$</span>Ks <span class="ot">&lt;-</span> <span class="fu">initKs</span>(Kbase, sites, ress, <span class="at">sizeexp=</span><span class="st">&quot;F&quot;</span>)</span></code></pre></div>
<p>Using these carrying capacities, we then set initial number of people, and the population structure for each sites:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="population-growth-conflicts-and-migrations.html#cb35-1" tabindex="-1"></a><span class="co"># Population size at initialisation, a number close to Ks</span></span>
<span id="cb35-2"><a href="population-growth-conflicts-and-migrations.html#cb35-2" tabindex="-1"></a>INs <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="fu">length</span>(sites), <span class="fl">0.85</span>, <span class="fl">0.95</span>)<span class="sc">*</span>sites<span class="sc">$</span>Ks)</span>
<span id="cb35-3"><a href="population-growth-conflicts-and-migrations.html#cb35-3" tabindex="-1"></a></span>
<span id="cb35-4"><a href="population-growth-conflicts-and-migrations.html#cb35-4" tabindex="-1"></a><span class="co"># initialise population structure for all sites</span></span>
<span id="cb35-5"><a href="population-growth-conflicts-and-migrations.html#cb35-5" tabindex="-1"></a>Ips <span class="ot">&lt;-</span> <span class="fu">lapply</span>(INs, initpopstruc)</span>
<span id="cb35-6"><a href="population-growth-conflicts-and-migrations.html#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="population-growth-conflicts-and-migrations.html#cb35-7" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb35-8"><a href="population-growth-conflicts-and-migrations.html#cb35-8" tabindex="-1"></a></span>
<span id="cb35-9"><a href="population-growth-conflicts-and-migrations.html#cb35-9" tabindex="-1"></a><span class="co"># We put the population structure across the years in a matrix: each row will represent a time step of the simulation ; each column a sites</span></span>
<span id="cb35-10"><a href="population-growth-conflicts-and-migrations.html#cb35-10" tabindex="-1"></a></span>
<span id="cb35-11"><a href="population-growth-conflicts-and-migrations.html#cb35-11" tabindex="-1"></a>Nts <span class="ot">&lt;-</span> <span class="fu">initlistsites</span>(Ips, <span class="at">ts=</span>ts)</span></code></pre></div>
<p>We can look at the population structure of the biggest site:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="population-growth-conflicts-and-migrations.html#cb36-1" tabindex="-1"></a>biggest <span class="ot">&lt;-</span> <span class="fu">which.max</span>(INs)</span>
<span id="cb36-2"><a href="population-growth-conflicts-and-migrations.html#cb36-2" tabindex="-1"></a>pop.biggest <span class="ot">&lt;-</span> Ips[[biggest]]</span>
<span id="cb36-3"><a href="population-growth-conflicts-and-migrations.html#cb36-3" tabindex="-1"></a>poplist<span class="ot">=</span><span class="fu">sapply</span>(<span class="fu">c</span>(<span class="at">F=</span><span class="st">&quot;F&quot;</span>,<span class="at">M=</span><span class="st">&quot;M&quot;</span>),<span class="cf">function</span>(s)<span class="fu">table</span>(<span class="fu">cut</span>(pop.biggest[pop.biggest[,<span class="dv">2</span>]<span class="sc">==</span>s,<span class="dv">1</span>],<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="dv">4</span>))))</span>
<span id="cb36-4"><a href="population-growth-conflicts-and-migrations.html#cb36-4" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb36-5"><a href="population-growth-conflicts-and-migrations.html#cb36-5" tabindex="-1"></a><span class="fu">barplot</span>(<span class="sc">-</span>poplist[,<span class="dv">1</span>],<span class="at">beside=</span>T,<span class="at">horiz=</span>T,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>),<span class="at">axes=</span>F,<span class="at">las=</span><span class="dv">1</span>)</span>
<span id="cb36-6"><a href="population-growth-conflicts-and-migrations.html#cb36-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>))</span>
<span id="cb36-7"><a href="population-growth-conflicts-and-migrations.html#cb36-7" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">unname</span>(poplist[,<span class="dv">1</span>]),<span class="at">beside=</span>T,<span class="at">horiz=</span>T,<span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>),<span class="at">axes=</span>F)</span></code></pre></div>
<p><img src="_main_files/figure-html/agestruc-1.png" width="40%" /><img src="_main_files/figure-html/agestruc-2.png" width="40%" /></p>
You can see the code of <code>initKs</code>, <code>initpopstruct</code> and <code>initlistsites</code> functions here:
<details>
<summary>
Show code
</summary>
<p><strong>Code</strong></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="population-growth-conflicts-and-migrations.html#cb37-1" tabindex="-1"></a><span class="do">## Function 14. Initial carrying capacity</span></span>
<span id="cb37-2"><a href="population-growth-conflicts-and-migrations.html#cb37-2" tabindex="-1"></a>initKs <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">Kbase=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">30</span>,<span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">120</span>), sites, ressources,</span>
<span id="cb37-3"><a href="population-growth-conflicts-and-migrations.html#cb37-3" tabindex="-1"></a>                   <span class="at">sizeexp=</span><span class="cn">NULL</span>, <span class="at">rate=</span>.<span class="dv">5</span>){</span>
<span id="cb37-4"><a href="population-growth-conflicts-and-migrations.html#cb37-4" tabindex="-1"></a>  Ks <span class="ot">&lt;-</span> <span class="fu">round</span>(Kbase[sites<span class="sc">$</span>culture] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(sites), <span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb37-5"><a href="population-growth-conflicts-and-migrations.html#cb37-5" tabindex="-1"></a>  <span class="cf">while</span>(<span class="fu">any</span>(Ks<span class="sc">&lt;</span><span class="dv">1</span>)){</span>
<span id="cb37-6"><a href="population-growth-conflicts-and-migrations.html#cb37-6" tabindex="-1"></a>    Ks <span class="ot">&lt;-</span> <span class="fu">round</span>( Kbase[sites<span class="sc">$</span>culture] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(sites), <span class="dv">0</span>, <span class="dv">10</span>) )</span>
<span id="cb37-7"><a href="population-growth-conflicts-and-migrations.html#cb37-7" tabindex="-1"></a>  }</span>
<span id="cb37-8"><a href="population-growth-conflicts-and-migrations.html#cb37-8" tabindex="-1"></a>  <span class="co">#Ks[sites$culture==&quot;F&quot;]=Ks[sites$culture==&quot;F&quot;]*runif(sum(sites$culture==&quot;F&quot;),1,1)</span></span>
<span id="cb37-9"><a href="population-growth-conflicts-and-migrations.html#cb37-9" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> Ks <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">extract</span>(ressources, sites)[, <span class="dv">2</span>])</span>
<span id="cb37-10"><a href="population-growth-conflicts-and-migrations.html#cb37-10" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(sizeexp)){</span>
<span id="cb37-11"><a href="population-growth-conflicts-and-migrations.html#cb37-11" tabindex="-1"></a>    tmp[sites<span class="sc">$</span>culture<span class="sc">==</span>sizeexp] <span class="ot">&lt;-</span> (</span>
<span id="cb37-12"><a href="population-growth-conflicts-and-migrations.html#cb37-12" tabindex="-1"></a>      (Ks[sites<span class="sc">$</span>culture<span class="sc">==</span>sizeexp]) <span class="sc">*</span></span>
<span id="cb37-13"><a href="population-growth-conflicts-and-migrations.html#cb37-13" tabindex="-1"></a>        (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">rexp</span>(<span class="fu">sum</span>(sites<span class="sc">$</span>culture<span class="sc">==</span>sizeexp), <span class="at">rate=</span>rate) <span class="sc">*</span> <span class="fu">extract</span>(ressources, sites[sites<span class="sc">$</span>culture<span class="sc">==</span>sizeexp])[,<span class="dv">2</span>])</span>
<span id="cb37-14"><a href="population-growth-conflicts-and-migrations.html#cb37-14" tabindex="-1"></a>    )</span>
<span id="cb37-15"><a href="population-growth-conflicts-and-migrations.html#cb37-15" tabindex="-1"></a>  }</span>
<span id="cb37-16"><a href="population-growth-conflicts-and-migrations.html#cb37-16" tabindex="-1"></a>  tmp</span>
<span id="cb37-17"><a href="population-growth-conflicts-and-migrations.html#cb37-17" tabindex="-1"></a>}</span>
<span id="cb37-18"><a href="population-growth-conflicts-and-migrations.html#cb37-18" tabindex="-1"></a></span>
<span id="cb37-19"><a href="population-growth-conflicts-and-migrations.html#cb37-19" tabindex="-1"></a></span>
<span id="cb37-20"><a href="population-growth-conflicts-and-migrations.html#cb37-20" tabindex="-1"></a> </span>
<span id="cb37-21"><a href="population-growth-conflicts-and-migrations.html#cb37-21" tabindex="-1"></a><span class="do">## Function 15. Create population matrix</span></span>
<span id="cb37-22"><a href="population-growth-conflicts-and-migrations.html#cb37-22" tabindex="-1"></a>initpopstruc <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n=</span><span class="dv">100</span>, <span class="at">ages=</span><span class="dv">10</span><span class="sc">:</span><span class="dv">30</span>, <span class="at">p_sex=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)){</span>
<span id="cb37-23"><a href="population-growth-conflicts-and-migrations.html#cb37-23" tabindex="-1"></a>  initpop <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb37-24"><a href="population-growth-conflicts-and-migrations.html#cb37-24" tabindex="-1"></a>    <span class="st">&quot;Age&quot;</span> <span class="ot">=</span> <span class="fu">sample</span>(ages, n, ages, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb37-25"><a href="population-growth-conflicts-and-migrations.html#cb37-25" tabindex="-1"></a>    <span class="st">&quot;Sex&quot;</span> <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>), n, <span class="at">prob =</span> p_sex, <span class="at">replace =</span> <span class="cn">TRUE</span>))   </span>
<span id="cb37-26"><a href="population-growth-conflicts-and-migrations.html#cb37-26" tabindex="-1"></a>  <span class="fu">return</span>(initpop)</span>
<span id="cb37-27"><a href="population-growth-conflicts-and-migrations.html#cb37-27" tabindex="-1"></a>}</span>
<span id="cb37-28"><a href="population-growth-conflicts-and-migrations.html#cb37-28" tabindex="-1"></a></span>
<span id="cb37-29"><a href="population-growth-conflicts-and-migrations.html#cb37-29" tabindex="-1"></a></span>
<span id="cb37-30"><a href="population-growth-conflicts-and-migrations.html#cb37-30" tabindex="-1"></a><span class="do">## Function 16. Initialize initial list of sites</span></span>
<span id="cb37-31"><a href="population-growth-conflicts-and-migrations.html#cb37-31" tabindex="-1"></a>initlistsites <span class="ot">&lt;-</span> <span class="cf">function</span>(list_sites, <span class="at">ts=</span><span class="dv">200</span>){</span>
<span id="cb37-32"><a href="population-growth-conflicts-and-migrations.html#cb37-32" tabindex="-1"></a>  Nts <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>ts<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(list_sites))</span>
<span id="cb37-33"><a href="population-growth-conflicts-and-migrations.html#cb37-33" tabindex="-1"></a>  Nts[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(list_sites, nrow)</span>
<span id="cb37-34"><a href="population-growth-conflicts-and-migrations.html#cb37-34" tabindex="-1"></a>  <span class="fu">return</span>(Nts)</span>
<span id="cb37-35"><a href="population-growth-conflicts-and-migrations.html#cb37-35" tabindex="-1"></a>}</span></code></pre></div>
</details>
</div>
<div id="population-growth" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Population Growth<a href="population-growth-conflicts-and-migrations.html#population-growth" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>changePopSize</code>: Change population size by moving population from one to another; or remove a group of people</p>
</div>
<div id="migration" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Migration<a href="population-growth-conflicts-and-migrations.html#migration" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="conflict-and-war" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Conflict and War<a href="population-growth-conflicts-and-migrations.html#conflict-and-war" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>whotouch</code></p>
</div>
<div id="run-simulation" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Run Simulation<a href="population-growth-conflicts-and-migrations.html#run-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now have sites with two cultures. The grow of the sites will depend on a lot of parameters; which are all a bit different depending on the two cultures. The list of parameters used is defined below:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="population-growth-conflicts-and-migrations.html#cb38-1" tabindex="-1"></a></span>
<span id="cb38-2"><a href="population-growth-conflicts-and-migrations.html#cb38-2" tabindex="-1"></a><span class="co">#initialisation</span></span>
<span id="cb38-3"><a href="population-growth-conflicts-and-migrations.html#cb38-3" tabindex="-1"></a></span>
<span id="cb38-4"><a href="population-growth-conflicts-and-migrations.html#cb38-4" tabindex="-1"></a>Kbase<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">45</span>,<span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">120</span>) <span class="co">#difference in K for the two cultures use and defined before ; will be use in simulation to define new site</span></span>
<span id="cb38-5"><a href="population-growth-conflicts-and-migrations.html#cb38-5" tabindex="-1"></a></span>
<span id="cb38-6"><a href="population-growth-conflicts-and-migrations.html#cb38-6" tabindex="-1"></a><span class="co"># spatial penality for cultural extentions, ie for population to move out of initial site : lower, bigger penality</span></span>
<span id="cb38-7"><a href="population-growth-conflicts-and-migrations.html#cb38-7" tabindex="-1"></a>cul_ext <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">7</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">6</span>)</span>
<span id="cb38-8"><a href="population-growth-conflicts-and-migrations.html#cb38-8" tabindex="-1"></a></span>
<span id="cb38-9"><a href="population-growth-conflicts-and-migrations.html#cb38-9" tabindex="-1"></a><span class="co"># penality of occupational area ie how hard it is to come close to your site ; if low, other sites can come close</span></span>
<span id="cb38-10"><a href="population-growth-conflicts-and-migrations.html#cb38-10" tabindex="-1"></a>penal_cul <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">4</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">5</span>)</span>
<span id="cb38-11"><a href="population-growth-conflicts-and-migrations.html#cb38-11" tabindex="-1"></a><span class="co"># proba to give birth every year</span></span>
<span id="cb38-12"><a href="population-growth-conflicts-and-migrations.html#cb38-12" tabindex="-1"></a>prob_birth <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.3</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.5</span>)</span>
<span id="cb38-13"><a href="population-growth-conflicts-and-migrations.html#cb38-13" tabindex="-1"></a><span class="co"># proba to die when pop &gt; K</span></span>
<span id="cb38-14"><a href="population-growth-conflicts-and-migrations.html#cb38-14" tabindex="-1"></a>prob_survive <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.8</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.6</span>)</span>
<span id="cb38-15"><a href="population-growth-conflicts-and-migrations.html#cb38-15" tabindex="-1"></a><span class="co"># proba to create new settlement when Ne &gt; K</span></span>
<span id="cb38-16"><a href="population-growth-conflicts-and-migrations.html#cb38-16" tabindex="-1"></a>prob_split <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.2</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.6</span>)</span>
<span id="cb38-17"><a href="population-growth-conflicts-and-migrations.html#cb38-17" tabindex="-1"></a><span class="co"># how big the group of migrant should be to create a new city vs</span></span>
<span id="cb38-18"><a href="population-growth-conflicts-and-migrations.html#cb38-18" tabindex="-1"></a><span class="co"># migrate to a existing one</span></span>
<span id="cb38-19"><a href="population-growth-conflicts-and-migrations.html#cb38-19" tabindex="-1"></a>minimals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.14</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.20</span>)</span>
<span id="cb38-20"><a href="population-growth-conflicts-and-migrations.html#cb38-20" tabindex="-1"></a><span class="co"># prob to migrate to existing settlement when Ne &gt; K</span></span>
<span id="cb38-21"><a href="population-growth-conflicts-and-migrations.html#cb38-21" tabindex="-1"></a>prob_move <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.2</span>,<span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.1</span>)</span></code></pre></div>
<p>Let’s see our raster map again, and put the sites on top, with their ids and showing there initial population size:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="population-growth-conflicts-and-migrations.html#cb39-1" tabindex="-1"></a><span class="fu">plotMap</span>(height.ras,height.wat,<span class="fu">paste0</span>(<span class="st">&quot;year &quot;</span>, <span class="dv">0</span>))</span>
<span id="cb39-2"><a href="population-growth-conflicts-and-migrations.html#cb39-2" tabindex="-1"></a><span class="fu">plot</span>(sites, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">add=</span>T, <span class="at">bg=</span><span class="fu">rainbow</span>(<span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.6</span>)[<span class="fu">as.factor</span>(sites<span class="sc">$</span>culture)],<span class="at">cex=</span>(<span class="dv">1</span><span class="sc">+</span>Nts[<span class="dv">1</span>,]<span class="sc">/</span><span class="dv">100</span>))</span>
<span id="cb39-3"><a href="population-growth-conflicts-and-migrations.html#cb39-3" tabindex="-1"></a><span class="fu">text</span>(sites,<span class="at">pos=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>The <code>run_simulation</code> function will take the raster data and parameters for defined before for the two different cultures and run for the specified number of years <code>ts</code> (150).</p>
<p>It uses a number of other functions to model contacts between sites, the outcomes of fights and migrations</p>
<p>The general organisation of the algorithm is as follow:</p>
<blockquote>
<p>initialisation
for all sites s:
N_s &lt;- growth(N_s)
if(N_s&gt;K_s):
moving people:
if( N_s - K-S &gt; min_s * K_s and probsplit_s):
create new city:
find the closest most attractive spot and move there
else if(proba move ):
migration
war(s)</p>
</blockquote>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="population-growth-conflicts-and-migrations.html#cb40-1" tabindex="-1"></a></span>
<span id="cb40-2"><a href="population-growth-conflicts-and-migrations.html#cb40-2" tabindex="-1"></a><span class="fl">1.</span> <span class="sc">**</span> initialisation <span class="sc">**</span></span>
<span id="cb40-3"><a href="population-growth-conflicts-and-migrations.html#cb40-3" tabindex="-1"></a>  </span>
<span id="cb40-4"><a href="population-growth-conflicts-and-migrations.html#cb40-4" tabindex="-1"></a><span class="fl">2.</span> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(ts<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb40-5"><a href="population-growth-conflicts-and-migrations.html#cb40-5" tabindex="-1"></a>    inactives <span class="ot">&lt;-</span> (Nts[i<span class="dv">-1</span>,]<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb40-6"><a href="population-growth-conflicts-and-migrations.html#cb40-6" tabindex="-1"></a>    <span class="cf">for</span> ( s <span class="cf">in</span> <span class="fu">sample</span>(<span class="fu">seq_along</span>(sites)[<span class="sc">!</span>inactives]) <span class="sc">:</span> <span class="co">#among all active site</span></span>
<span id="cb40-7"><a href="population-growth-conflicts-and-migrations.html#cb40-7" tabindex="-1"></a>        N_s <span class="ot">&lt;-</span> <span class="fu">Gpd</span>()</span>
<span id="cb40-8"><a href="population-growth-conflicts-and-migrations.html#cb40-8" tabindex="-1"></a>        <span class="cf">if</span> <span class="sc">$</span>N_s<span class="sc">&gt;</span> K_s<span class="sc">$</span> <span class="er">:</span></span>
<span id="cb40-9"><a href="population-growth-conflicts-and-migrations.html#cb40-9" tabindex="-1"></a>            migrants <span class="ot">&lt;-</span> newN <span class="sc">-</span> <span class="fu">round</span>(Ks[[s]]<span class="sc">*</span><span class="fl">0.9</span>)</span>
<span id="cb40-10"><a href="population-growth-conflicts-and-migrations.html#cb40-10" tabindex="-1"></a>            <span class="cf">if</span> (migrants <span class="sc">&gt;=</span> (minimals[sites<span class="sc">$</span>culture[s]]<span class="sc">*</span>sites<span class="sc">$</span>Ks[s]) <span class="sc">&amp;</span> <span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">&lt;</span>prob_split[sites<span class="sc">$</span>culture[s]] ){</span>
<span id="cb40-11"><a href="population-growth-conflicts-and-migrations.html#cb40-11" tabindex="-1"></a>          <span class="co">#if subpopulation &gt; 10 people, 10% chance of creation of a new city</span></span>
<span id="cb40-12"><a href="population-growth-conflicts-and-migrations.html#cb40-12" tabindex="-1"></a></span>
<span id="cb40-13"><a href="population-growth-conflicts-and-migrations.html#cb40-13" tabindex="-1"></a>          infarea <span class="ot">&lt;-</span> (<span class="fu">sqrt</span>(tmp)<span class="sc">+</span>penal_cul[cultures]) <span class="sc">*</span> buffersettl</span>
<span id="cb40-14"><a href="population-growth-conflicts-and-migrations.html#cb40-14" tabindex="-1"></a>          buffersize <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(infarea), infarea, infarea <span class="sc">*</span> <span class="fl">0.1</span>)</span>
<span id="cb40-15"><a href="population-growth-conflicts-and-migrations.html#cb40-15" tabindex="-1"></a>          buffersize[tmp<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-16"><a href="population-growth-conflicts-and-migrations.html#cb40-16" tabindex="-1"></a>          territory <span class="ot">&lt;-</span> <span class="fu">erase</span>(viable, <span class="fu">buffer</span>(sites, buffersize))</span>
<span id="cb40-17"><a href="population-growth-conflicts-and-migrations.html#cb40-17" tabindex="-1"></a>          </span>
<span id="cb40-18"><a href="population-growth-conflicts-and-migrations.html#cb40-18" tabindex="-1"></a>          <span class="cf">if</span>( <span class="fu">length</span>(territory)<span class="sc">&gt;</span><span class="dv">0</span> ){</span>
<span id="cb40-19"><a href="population-growth-conflicts-and-migrations.html#cb40-19" tabindex="-1"></a>            <span class="do">##select a new site given its distance to the old one and the ressourcesource available in ressources</span></span>
<span id="cb40-20"><a href="population-growth-conflicts-and-migrations.html#cb40-20" tabindex="-1"></a>            d2 <span class="ot">&lt;-</span> <span class="fu">logisticdecay</span>( sites[s], dem, <span class="at">x=</span><span class="dv">20000</span><span class="sc">*</span>cul_ext[sites<span class="sc">$</span>culture[s]])</span>
<span id="cb40-21"><a href="population-growth-conflicts-and-migrations.html#cb40-21" tabindex="-1"></a>            w <span class="ot">&lt;-</span> (<span class="fl">0.7</span> <span class="sc">*</span> d2 <span class="sc">+</span> <span class="fl">0.3</span><span class="sc">*</span>ressources) <span class="sc">/</span> (<span class="fl">0.7</span><span class="sc">*</span><span class="fu">minmax</span>(d2)[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.3</span><span class="sc">*</span><span class="fu">minmax</span>(ressources)[<span class="dv">2</span>])</span>
<span id="cb40-22"><a href="population-growth-conflicts-and-migrations.html#cb40-22" tabindex="-1"></a>            new_site <span class="ot">&lt;-</span> <span class="fu">spatSample</span>(</span>
<span id="cb40-23"><a href="population-growth-conflicts-and-migrations.html#cb40-23" tabindex="-1"></a>              <span class="at">x=</span><span class="fu">mask</span>(</span>
<span id="cb40-24"><a href="population-growth-conflicts-and-migrations.html#cb40-24" tabindex="-1"></a>                w <span class="sc">*</span> <span class="fu">logisticdecay</span>(sites[s], dem, <span class="at">k=</span><span class="fl">0.00002</span>,</span>
<span id="cb40-25"><a href="population-growth-conflicts-and-migrations.html#cb40-25" tabindex="-1"></a>                                  <span class="at">x=</span><span class="dv">20000</span><span class="sc">*</span>cul_ext[sites<span class="sc">$</span>culture[s]]),</span>
<span id="cb40-26"><a href="population-growth-conflicts-and-migrations.html#cb40-26" tabindex="-1"></a>                territory),</span>
<span id="cb40-27"><a href="population-growth-conflicts-and-migrations.html#cb40-27" tabindex="-1"></a>              <span class="at">size=</span><span class="dv">1</span>, <span class="at">method=</span><span class="st">&quot;weights&quot;</span>, <span class="at">xy=</span>T)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb40-28"><a href="population-growth-conflicts-and-migrations.html#cb40-28" tabindex="-1"></a>            new_site <span class="ot">&lt;-</span> <span class="fu">vect</span>(new_site, <span class="at">geom=</span><span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>))</span>
<span id="cb40-29"><a href="population-growth-conflicts-and-migrations.html#cb40-29" tabindex="-1"></a>            </span>
<span id="cb40-30"><a href="population-growth-conflicts-and-migrations.html#cb40-30" tabindex="-1"></a>            <span class="cf">if</span> ( <span class="fu">length</span>(new_site)<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">crds</span>(new_site))) ){</span>
<span id="cb40-31"><a href="population-growth-conflicts-and-migrations.html#cb40-31" tabindex="-1"></a>              <span class="do">##add new site to site listes</span></span>
<span id="cb40-32"><a href="population-growth-conflicts-and-migrations.html#cb40-32" tabindex="-1"></a>              Ips[[<span class="fu">length</span>(Ips)<span class="sc">+</span><span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">initpopstruc</span>(<span class="at">n=</span>migrants) <span class="co">#initialise a fake populaition, will be updated by real migrants later</span></span>
<span id="cb40-33"><a href="population-growth-conflicts-and-migrations.html#cb40-33" tabindex="-1"></a>              new_site<span class="sc">$</span>culture <span class="ot">&lt;-</span> sites<span class="sc">$</span>culture[s]</span>
<span id="cb40-34"><a href="population-growth-conflicts-and-migrations.html#cb40-34" tabindex="-1"></a>              new_site<span class="sc">$</span>Ks <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">initKs</span>(</span>
<span id="cb40-35"><a href="population-growth-conflicts-and-migrations.html#cb40-35" tabindex="-1"></a>                Kbase, <span class="at">sites=</span>new_site, ressources,</span>
<span id="cb40-36"><a href="population-growth-conflicts-and-migrations.html#cb40-36" tabindex="-1"></a>                <span class="at">sizeex=</span><span class="st">&quot;F&quot;</span>, <span class="at">rate=</span><span class="fl">0.45</span>))</span>
<span id="cb40-37"><a href="population-growth-conflicts-and-migrations.html#cb40-37" tabindex="-1"></a>              sites <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sites, new_site)</span>
<span id="cb40-38"><a href="population-growth-conflicts-and-migrations.html#cb40-38" tabindex="-1"></a>              Ks[<span class="fu">length</span>(Ks)<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> new_site<span class="sc">$</span>Ks</span>
<span id="cb40-39"><a href="population-growth-conflicts-and-migrations.html#cb40-39" tabindex="-1"></a>            }</span>
<span id="cb40-40"><a href="population-growth-conflicts-and-migrations.html#cb40-40" tabindex="-1"></a>          }</span>
<span id="cb40-41"><a href="population-growth-conflicts-and-migrations.html#cb40-41" tabindex="-1"></a>        }</span>
<span id="cb40-42"><a href="population-growth-conflicts-and-migrations.html#cb40-42" tabindex="-1"></a>        <span class="do">## if no creation of new city happen, there is a certain probability that people will move</span></span>
<span id="cb40-43"><a href="population-growth-conflicts-and-migrations.html#cb40-43" tabindex="-1"></a>        <span class="cf">if</span>( <span class="fu">length</span>(new_site)<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> prob_move[sites<span class="sc">$</span>culture[s]] ){</span>
<span id="cb40-44"><a href="population-growth-conflicts-and-migrations.html#cb40-44" tabindex="-1"></a>           <span class="co">#migration to existing site</span></span>
<span id="cb40-45"><a href="population-growth-conflicts-and-migrations.html#cb40-45" tabindex="-1"></a>          att <span class="ot">&lt;-</span> <span class="fu">extract</span>(ressources,sites)[,<span class="dv">2</span>]</span>
<span id="cb40-46"><a href="population-growth-conflicts-and-migrations.html#cb40-46" tabindex="-1"></a>          space <span class="ot">&lt;-</span> sites<span class="sc">$</span>Ks <span class="sc">-</span> (Nts[i<span class="dv">-1</span>,] <span class="sc">+</span> migrants)</span>
<span id="cb40-47"><a href="population-growth-conflicts-and-migrations.html#cb40-47" tabindex="-1"></a>          dis <span class="ot">&lt;-</span> <span class="fu">extract</span>(<span class="fu">logisticdecay</span>(sites[s], dem, <span class="at">k=</span><span class="fl">0.00002</span>, <span class="at">x=</span><span class="dv">1</span>), sites)[,<span class="dv">2</span>]</span>
<span id="cb40-48"><a href="population-growth-conflicts-and-migrations.html#cb40-48" tabindex="-1"></a>          attractivity <span class="ot">&lt;-</span> att <span class="sc">*</span> space <span class="sc">*</span> dis</span>
<span id="cb40-49"><a href="population-growth-conflicts-and-migrations.html#cb40-49" tabindex="-1"></a>          <span class="co">#attractivity=attractivity*(1+10*(sites$culture[s]==sites$culture)) #4 times more likely to go to similar culture</span></span>
<span id="cb40-50"><a href="population-growth-conflicts-and-migrations.html#cb40-50" tabindex="-1"></a>          attractivity[s] <span class="ot">&lt;-</span> <span class="fu">min</span>(attractivity)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb40-51"><a href="population-growth-conflicts-and-migrations.html#cb40-51" tabindex="-1"></a>          attractivity <span class="ot">&lt;-</span> <span class="fu">exp</span>(attractivity)<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">exp</span>(attractivity))</span>
<span id="cb40-52"><a href="population-growth-conflicts-and-migrations.html#cb40-52" tabindex="-1"></a>          attractivity[Nts[i<span class="dv">-1</span>,]<span class="sc">&lt;</span><span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb40-53"><a href="population-growth-conflicts-and-migrations.html#cb40-53" tabindex="-1"></a>          attractivity[sites<span class="sc">$</span>culture<span class="sc">!=</span>sites<span class="sc">$</span>culture[s]] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb40-54"><a href="population-growth-conflicts-and-migrations.html#cb40-54" tabindex="-1"></a>          <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">is.na</span>(attractivity))){</span>
<span id="cb40-55"><a href="population-growth-conflicts-and-migrations.html#cb40-55" tabindex="-1"></a>            <span class="fu">print</span>(attractivity)</span>
<span id="cb40-56"><a href="population-growth-conflicts-and-migrations.html#cb40-56" tabindex="-1"></a>            attractivity[<span class="fu">is.na</span>(attractivity)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-57"><a href="population-growth-conflicts-and-migrations.html#cb40-57" tabindex="-1"></a>          }</span>
<span id="cb40-58"><a href="population-growth-conflicts-and-migrations.html#cb40-58" tabindex="-1"></a>          </span>
<span id="cb40-59"><a href="population-growth-conflicts-and-migrations.html#cb40-59" tabindex="-1"></a>          city <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">size=</span><span class="dv">1</span>, <span class="at">x=</span><span class="fu">seq_along</span>(sites), <span class="at">prob=</span>attractivity)</span>
<span id="cb40-60"><a href="population-growth-conflicts-and-migrations.html#cb40-60" tabindex="-1"></a>          Nts[i,city] <span class="ot">&lt;-</span> Nts[i<span class="dv">-1</span>,city] <span class="sc">+</span> migrants</span>
<span id="cb40-61"><a href="population-growth-conflicts-and-migrations.html#cb40-61" tabindex="-1"></a>        }</span>
<span id="cb40-62"><a href="population-growth-conflicts-and-migrations.html#cb40-62" tabindex="-1"></a>        <span class="cf">if</span>( havemoved ){</span>
<span id="cb40-63"><a href="population-growth-conflicts-and-migrations.html#cb40-63" tabindex="-1"></a>          Ips[<span class="fu">c</span>(s,city)] <span class="ot">&lt;-</span> <span class="fu">changePopSize</span>( <span class="at">loosingPop=</span>Ips[[s]], <span class="at">winingPop=</span>Ips[[city]], <span class="at">size=</span>migrants)</span>
<span id="cb40-64"><a href="population-growth-conflicts-and-migrations.html#cb40-64" tabindex="-1"></a>          newN <span class="ot">&lt;-</span> newN <span class="sc">-</span> migrants</span>
<span id="cb40-65"><a href="population-growth-conflicts-and-migrations.html#cb40-65" tabindex="-1"></a>        }</span>
<span id="cb40-66"><a href="population-growth-conflicts-and-migrations.html#cb40-66" tabindex="-1"></a>        </span>
<span id="cb40-67"><a href="population-growth-conflicts-and-migrations.html#cb40-67" tabindex="-1"></a>      <span class="er">}</span></span>
<span id="cb40-68"><a href="population-growth-conflicts-and-migrations.html#cb40-68" tabindex="-1"></a>      Nts[i,s] <span class="ot">&lt;-</span> newN</span>
<span id="cb40-69"><a href="population-growth-conflicts-and-migrations.html#cb40-69" tabindex="-1"></a>      </span>
<span id="cb40-70"><a href="population-growth-conflicts-and-migrations.html#cb40-70" tabindex="-1"></a>    <span class="er">}</span></span>
<span id="cb40-71"><a href="population-growth-conflicts-and-migrations.html#cb40-71" tabindex="-1"></a>    <span class="do">## WAR =======================</span></span>
<span id="cb40-72"><a href="population-growth-conflicts-and-migrations.html#cb40-72" tabindex="-1"></a>    potentialfighters <span class="ot">&lt;-</span> <span class="fu">which</span>(sites<span class="sc">$</span>culture<span class="sc">==</span><span class="st">&quot;F&quot;</span> <span class="sc">&amp;</span> Nts[i,]<span class="sc">&gt;</span><span class="dv">50</span>)</span>
<span id="cb40-73"><a href="population-growth-conflicts-and-migrations.html#cb40-73" tabindex="-1"></a>    <span class="cf">for</span> (s <span class="cf">in</span> <span class="fu">sample</span>(<span class="at">x=</span>potentialfighters, <span class="at">size=</span><span class="fu">round</span>(<span class="fu">length</span>(potentialfighters)<span class="sc">*</span><span class="fl">0.1</span>))){</span>
<span id="cb40-74"><a href="population-growth-conflicts-and-migrations.html#cb40-74" tabindex="-1"></a>      buff <span class="ot">&lt;-</span> bufferatack</span>
<span id="cb40-75"><a href="population-growth-conflicts-and-migrations.html#cb40-75" tabindex="-1"></a>      potentialvictims <span class="ot">&lt;-</span> <span class="fu">which</span>(sites<span class="sc">$</span>culture <span class="sc">!=</span>sites<span class="sc">$</span>culture[s] <span class="sc">&amp;</span> Nts[i,]<span class="sc">&gt;</span><span class="dv">0</span>) </span>
<span id="cb40-76"><a href="population-growth-conflicts-and-migrations.html#cb40-76" tabindex="-1"></a>      clash <span class="ot">&lt;-</span> <span class="fu">whotouch</span>(s, sites, <span class="at">Ne=</span>Nts[i,], <span class="at">buffersize=</span>buff)</span>
<span id="cb40-77"><a href="population-growth-conflicts-and-migrations.html#cb40-77" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(clash)<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(clash)){</span>
<span id="cb40-78"><a href="population-growth-conflicts-and-migrations.html#cb40-78" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(clash) <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb40-79"><a href="population-growth-conflicts-and-migrations.html#cb40-79" tabindex="-1"></a>          attack <span class="ot">&lt;-</span> clash</span>
<span id="cb40-80"><a href="population-growth-conflicts-and-migrations.html#cb40-80" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb40-81"><a href="population-growth-conflicts-and-migrations.html#cb40-81" tabindex="-1"></a>          attack <span class="ot">&lt;-</span> <span class="fu">sample</span>(clash, <span class="dv">1</span>)</span>
<span id="cb40-82"><a href="population-growth-conflicts-and-migrations.html#cb40-82" tabindex="-1"></a>        }</span>
<span id="cb40-83"><a href="population-growth-conflicts-and-migrations.html#cb40-83" tabindex="-1"></a>        newns <span class="ot">&lt;-</span> <span class="fu">fightbetterloss</span>(<span class="at">Ne=</span>Nts[i,], <span class="at">a=</span>s, <span class="at">b=</span>attack)</span>
<span id="cb40-84"><a href="population-growth-conflicts-and-migrations.html#cb40-84" tabindex="-1"></a>        casualties <span class="ot">&lt;-</span> <span class="fu">sum</span>(Nts[i, <span class="fu">c</span>(s,attack)] <span class="sc">-</span> newns[<span class="fu">c</span>(s,attack)])</span>
<span id="cb40-85"><a href="population-growth-conflicts-and-migrations.html#cb40-85" tabindex="-1"></a>        warcasualties[i] <span class="ot">&lt;-</span> casualties</span>
<span id="cb40-86"><a href="population-growth-conflicts-and-migrations.html#cb40-86" tabindex="-1"></a>        sizew <span class="ot">&lt;-</span> casualties<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">4000</span></span>
<span id="cb40-87"><a href="population-growth-conflicts-and-migrations.html#cb40-87" tabindex="-1"></a>        <span class="fu">warpoints</span>(sites, s, attack, <span class="at">Ne=</span>Nts[i,],</span>
<span id="cb40-88"><a href="population-growth-conflicts-and-migrations.html#cb40-88" tabindex="-1"></a>                  <span class="at">buffersize=</span>buff, <span class="at">sizewar=</span>sizew<span class="fl">+0.5</span>)</span>
<span id="cb40-89"><a href="population-growth-conflicts-and-migrations.html#cb40-89" tabindex="-1"></a>        </span>
<span id="cb40-90"><a href="population-growth-conflicts-and-migrations.html#cb40-90" tabindex="-1"></a>        <span class="co">#effectively kill people in population (should be done taking into account age pyramid to be more realistic)</span></span>
<span id="cb40-91"><a href="population-growth-conflicts-and-migrations.html#cb40-91" tabindex="-1"></a>        Ips[[s]] <span class="ot">&lt;-</span> <span class="fu">changePopSize</span>(<span class="at">loosingPop=</span>Ips[[s]],</span>
<span id="cb40-92"><a href="population-growth-conflicts-and-migrations.html#cb40-92" tabindex="-1"></a>                                  <span class="at">size=</span>(Nts[i,s] <span class="sc">-</span> newns[s]))</span>
<span id="cb40-93"><a href="population-growth-conflicts-and-migrations.html#cb40-93" tabindex="-1"></a>        Ips[[attack]] <span class="ot">&lt;-</span> <span class="fu">changePopSize</span>(<span class="at">loosingPop=</span>Ips[[attack]],</span>
<span id="cb40-94"><a href="population-growth-conflicts-and-migrations.html#cb40-94" tabindex="-1"></a>                                       <span class="at">size=</span>(Nts[i, attack] <span class="sc">-</span> newns[attack]))</span>
<span id="cb40-95"><a href="population-growth-conflicts-and-migrations.html#cb40-95" tabindex="-1"></a>        Nts[i,] <span class="ot">&lt;-</span> newns</span>
<span id="cb40-96"><a href="population-growth-conflicts-and-migrations.html#cb40-96" tabindex="-1"></a>      }</span>
<span id="cb40-97"><a href="population-growth-conflicts-and-migrations.html#cb40-97" tabindex="-1"></a>  }</span>
<span id="cb40-98"><a href="population-growth-conflicts-and-migrations.html#cb40-98" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Nts=</span>Nts, <span class="at">warcasualties=</span>warcasualties, <span class="at">Ips=</span>Ips, <span class="at">sites=</span>sites))</span>
<span id="cb40-99"><a href="population-growth-conflicts-and-migrations.html#cb40-99" tabindex="-1"></a><span class="er">}</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="population-growth-conflicts-and-migrations.html#cb41-1" tabindex="-1"></a>onesimu <span class="ot">&lt;-</span> <span class="fu">run_simulation</span>(</span>
<span id="cb41-2"><a href="population-growth-conflicts-and-migrations.html#cb41-2" tabindex="-1"></a>  <span class="at">sites=</span>sites, <span class="at">viable=</span>viable, <span class="at">dem=</span>height.ras,</span>
<span id="cb41-3"><a href="population-growth-conflicts-and-migrations.html#cb41-3" tabindex="-1"></a>  <span class="at">ressources=</span>ress,</span>
<span id="cb41-4"><a href="population-growth-conflicts-and-migrations.html#cb41-4" tabindex="-1"></a>  <span class="at">water=</span>height.wat,</span>
<span id="cb41-5"><a href="population-growth-conflicts-and-migrations.html#cb41-5" tabindex="-1"></a>  <span class="at">foldervid=</span><span class="st">&quot;nan&quot;</span>,</span>
<span id="cb41-6"><a href="population-growth-conflicts-and-migrations.html#cb41-6" tabindex="-1"></a>  <span class="at">visu=</span>F, <span class="at">visumin=</span>F,</span>
<span id="cb41-7"><a href="population-growth-conflicts-and-migrations.html#cb41-7" tabindex="-1"></a>  <span class="at">ts=</span>ts, <span class="co">#length of simulation in year</span></span>
<span id="cb41-8"><a href="population-growth-conflicts-and-migrations.html#cb41-8" tabindex="-1"></a>  <span class="at">Kbase=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">35</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">110</span>), <span class="co">#difference in K for the two cultures</span></span>
<span id="cb41-9"><a href="population-growth-conflicts-and-migrations.html#cb41-9" tabindex="-1"></a>  <span class="at">cul_ext=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">7</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">6</span>), <span class="co">#spatial penality to extent: lower, bigger penality</span></span>
<span id="cb41-10"><a href="population-growth-conflicts-and-migrations.html#cb41-10" tabindex="-1"></a>  <span class="at">penal_cul=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">4</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">5</span>), <span class="co">#penality of occupational area: low, other sites can cam close</span></span>
<span id="cb41-11"><a href="population-growth-conflicts-and-migrations.html#cb41-11" tabindex="-1"></a>  <span class="at">prob_birth=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.3</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.5</span>), <span class="co">#proba of giving birth every year</span></span>
<span id="cb41-12"><a href="population-growth-conflicts-and-migrations.html#cb41-12" tabindex="-1"></a>  <span class="at">prob_survive=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.8</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.65</span>), <span class="co">#proba of dying when pop &gt; K</span></span>
<span id="cb41-13"><a href="population-growth-conflicts-and-migrations.html#cb41-13" tabindex="-1"></a>  <span class="at">prob_split=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.5</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.6</span>), <span class="co">#proba of creating a new settlement when Ne &gt; K</span></span>
<span id="cb41-14"><a href="population-growth-conflicts-and-migrations.html#cb41-14" tabindex="-1"></a>  <span class="at">minimals=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.14</span>,<span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.20</span>), <span class="co">#how big the group of migrant should be to create a new city vs migrate to a existing one </span></span>
<span id="cb41-15"><a href="population-growth-conflicts-and-migrations.html#cb41-15" tabindex="-1"></a>  <span class="at">bufferatack=</span><span class="dv">300</span>, <span class="co">#distance max around which settlement can fight</span></span>
<span id="cb41-16"><a href="population-growth-conflicts-and-migrations.html#cb41-16" tabindex="-1"></a>  <span class="at">prob_move=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.2</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.1</span>) <span class="co">#proba of migrating to existing settlement when Ne &gt; K</span></span>
<span id="cb41-17"><a href="population-growth-conflicts-and-migrations.html#cb41-17" tabindex="-1"></a>)</span>
<span id="cb41-18"><a href="population-growth-conflicts-and-migrations.html#cb41-18" tabindex="-1"></a><span class="do">## [1] &quot;year 2 total 1095 with 20 sites ( F:1,HG:19 )&quot;</span></span>
<span id="cb41-19"><a href="population-growth-conflicts-and-migrations.html#cb41-19" tabindex="-1"></a><span class="do">## [1] &quot;year 3 total 1209 with 20 sites ( F:1,HG:19 )&quot;</span></span>
<span id="cb41-20"><a href="population-growth-conflicts-and-migrations.html#cb41-20" tabindex="-1"></a><span class="do">## [1] &quot;year 4 total 1251 with 20 sites ( F:1,HG:19 )&quot;</span></span>
<span id="cb41-21"><a href="population-growth-conflicts-and-migrations.html#cb41-21" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 25 and pop 9&quot;</span></span>
<span id="cb41-22"><a href="population-growth-conflicts-and-migrations.html#cb41-22" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb41-23"><a href="population-growth-conflicts-and-migrations.html#cb41-23" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 28 and pop 5&quot;</span></span>
<span id="cb41-24"><a href="population-growth-conflicts-and-migrations.html#cb41-24" tabindex="-1"></a><span class="do">## [1] &quot;year 5 total 1273 with 22 sites ( F:1,HG:21 )&quot;</span></span>
<span id="cb41-25"><a href="population-growth-conflicts-and-migrations.html#cb41-25" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 36 and pop 4&quot;</span></span>
<span id="cb41-26"><a href="population-growth-conflicts-and-migrations.html#cb41-26" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;8 migrant from HG to HG&quot;</span></span>
<span id="cb41-27"><a href="population-growth-conflicts-and-migrations.html#cb41-27" tabindex="-1"></a><span class="do">## [1] &quot;year 6 total 1264 with 23 sites ( F:1,HG:22 )&quot;</span></span>
<span id="cb41-28"><a href="population-growth-conflicts-and-migrations.html#cb41-28" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;40 migrant from F to F&quot;</span></span>
<span id="cb41-29"><a href="population-growth-conflicts-and-migrations.html#cb41-29" tabindex="-1"></a><span class="do">## [1] &quot;year 7 total 1296 with 23 sites ( F:1,HG:22 )&quot;</span></span>
<span id="cb41-30"><a href="population-growth-conflicts-and-migrations.html#cb41-30" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 37 and pop 9&quot;</span></span>
<span id="cb41-31"><a href="population-growth-conflicts-and-migrations.html#cb41-31" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb41-32"><a href="population-growth-conflicts-and-migrations.html#cb41-32" tabindex="-1"></a><span class="do">## [1] &quot;year 8 total 1274 with 24 sites ( F:1,HG:23 )&quot;</span></span>
<span id="cb41-33"><a href="population-growth-conflicts-and-migrations.html#cb41-33" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb41-34"><a href="population-growth-conflicts-and-migrations.html#cb41-34" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-35"><a href="population-growth-conflicts-and-migrations.html#cb41-35" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb41-36"><a href="population-growth-conflicts-and-migrations.html#cb41-36" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;38 migrant from F to F&quot;</span></span>
<span id="cb41-37"><a href="population-growth-conflicts-and-migrations.html#cb41-37" tabindex="-1"></a><span class="do">## [1] &quot;year 9 total 1301 with 24 sites ( F:1,HG:23 )&quot;</span></span>
<span id="cb41-38"><a href="population-growth-conflicts-and-migrations.html#cb41-38" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 35 and pop 4&quot;</span></span>
<span id="cb41-39"><a href="population-growth-conflicts-and-migrations.html#cb41-39" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 55 and pop 4&quot;</span></span>
<span id="cb41-40"><a href="population-growth-conflicts-and-migrations.html#cb41-40" tabindex="-1"></a><span class="do">## [1] &quot;year 10 total 1294 with 26 sites ( F:1,HG:25 )&quot;</span></span>
<span id="cb41-41"><a href="population-growth-conflicts-and-migrations.html#cb41-41" tabindex="-1"></a><span class="do">## [1] &quot;year 11 total 1282 with 26 sites ( F:1,HG:25 )&quot;</span></span>
<span id="cb41-42"><a href="population-growth-conflicts-and-migrations.html#cb41-42" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 38 and pop 9&quot;</span></span>
<span id="cb41-43"><a href="population-growth-conflicts-and-migrations.html#cb41-43" tabindex="-1"></a><span class="do">## [1] &quot;year 12 total 1274 with 27 sites ( F:1,HG:26 )&quot;</span></span>
<span id="cb41-44"><a href="population-growth-conflicts-and-migrations.html#cb41-44" tabindex="-1"></a><span class="do">## [1] &quot;year 13 total 1283 with 27 sites ( F:1,HG:26 )&quot;</span></span>
<span id="cb41-45"><a href="population-growth-conflicts-and-migrations.html#cb41-45" tabindex="-1"></a><span class="do">## [1] &quot;year 14 total 1286 with 27 sites ( F:1,HG:26 )&quot;</span></span>
<span id="cb41-46"><a href="population-growth-conflicts-and-migrations.html#cb41-46" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb41-47"><a href="population-growth-conflicts-and-migrations.html#cb41-47" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb41-48"><a href="population-growth-conflicts-and-migrations.html#cb41-48" tabindex="-1"></a><span class="do">## [1] &quot;year 15 total 1291 with 27 sites ( F:1,HG:26 )&quot;</span></span>
<span id="cb41-49"><a href="population-growth-conflicts-and-migrations.html#cb41-49" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb41-50"><a href="population-growth-conflicts-and-migrations.html#cb41-50" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-51"><a href="population-growth-conflicts-and-migrations.html#cb41-51" tabindex="-1"></a><span class="do">## [1] &quot;year 16 total 1294 with 27 sites ( F:1,HG:26 )&quot;</span></span>
<span id="cb41-52"><a href="population-growth-conflicts-and-migrations.html#cb41-52" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;9 migrant from HG to HG&quot;</span></span>
<span id="cb41-53"><a href="population-growth-conflicts-and-migrations.html#cb41-53" tabindex="-1"></a><span class="do">## [1] &quot;year 17 total 1292 with 27 sites ( F:1,HG:26 )&quot;</span></span>
<span id="cb41-54"><a href="population-growth-conflicts-and-migrations.html#cb41-54" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 28 and pop 6&quot;</span></span>
<span id="cb41-55"><a href="population-growth-conflicts-and-migrations.html#cb41-55" tabindex="-1"></a><span class="do">## [1] &quot;year 18 total 1314 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-56"><a href="population-growth-conflicts-and-migrations.html#cb41-56" tabindex="-1"></a><span class="do">## [1] &quot;year 19 total 1314 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-57"><a href="population-growth-conflicts-and-migrations.html#cb41-57" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;38 migrant from F to F&quot;</span></span>
<span id="cb41-58"><a href="population-growth-conflicts-and-migrations.html#cb41-58" tabindex="-1"></a><span class="do">## [1] &quot;year 20 total 1335 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-59"><a href="population-growth-conflicts-and-migrations.html#cb41-59" tabindex="-1"></a><span class="do">## [1] &quot;year 21 total 1299 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-60"><a href="population-growth-conflicts-and-migrations.html#cb41-60" tabindex="-1"></a><span class="do">## [1] &quot;year 22 total 1296 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-61"><a href="population-growth-conflicts-and-migrations.html#cb41-61" tabindex="-1"></a><span class="do">## [1] &quot;year 23 total 1283 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-62"><a href="population-growth-conflicts-and-migrations.html#cb41-62" tabindex="-1"></a><span class="do">## [1] &quot;year 24 total 1278 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-63"><a href="population-growth-conflicts-and-migrations.html#cb41-63" tabindex="-1"></a><span class="do">## [1] &quot;year 25 total 1260 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-64"><a href="population-growth-conflicts-and-migrations.html#cb41-64" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-65"><a href="population-growth-conflicts-and-migrations.html#cb41-65" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb41-66"><a href="population-growth-conflicts-and-migrations.html#cb41-66" tabindex="-1"></a><span class="do">## [1] &quot;year 26 total 1270 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-67"><a href="population-growth-conflicts-and-migrations.html#cb41-67" tabindex="-1"></a><span class="do">## [1] &quot;year 27 total 1275 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-68"><a href="population-growth-conflicts-and-migrations.html#cb41-68" tabindex="-1"></a><span class="do">## [1] &quot;year 28 total 1266 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-69"><a href="population-growth-conflicts-and-migrations.html#cb41-69" tabindex="-1"></a><span class="do">## [1] &quot;year 29 total 1266 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-70"><a href="population-growth-conflicts-and-migrations.html#cb41-70" tabindex="-1"></a><span class="do">## [1] &quot;year 30 total 1265 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-71"><a href="population-growth-conflicts-and-migrations.html#cb41-71" tabindex="-1"></a><span class="do">## [1] &quot;year 31 total 1270 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-72"><a href="population-growth-conflicts-and-migrations.html#cb41-72" tabindex="-1"></a><span class="do">## [1] &quot;year 32 total 1281 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-73"><a href="population-growth-conflicts-and-migrations.html#cb41-73" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;36 migrant from F to F&quot;</span></span>
<span id="cb41-74"><a href="population-growth-conflicts-and-migrations.html#cb41-74" tabindex="-1"></a><span class="do">## [1] &quot;year 33 total 1310 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-75"><a href="population-growth-conflicts-and-migrations.html#cb41-75" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb41-76"><a href="population-growth-conflicts-and-migrations.html#cb41-76" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb41-77"><a href="population-growth-conflicts-and-migrations.html#cb41-77" tabindex="-1"></a><span class="do">## [1] &quot;year 34 total 1289 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-78"><a href="population-growth-conflicts-and-migrations.html#cb41-78" tabindex="-1"></a><span class="do">## [1] &quot;year 35 total 1259 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-79"><a href="population-growth-conflicts-and-migrations.html#cb41-79" tabindex="-1"></a><span class="do">## [1] &quot;year 36 total 1238 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-80"><a href="population-growth-conflicts-and-migrations.html#cb41-80" tabindex="-1"></a><span class="do">## [1] &quot;year 37 total 1225 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-81"><a href="population-growth-conflicts-and-migrations.html#cb41-81" tabindex="-1"></a><span class="do">## [1] &quot;year 38 total 1210 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-82"><a href="population-growth-conflicts-and-migrations.html#cb41-82" tabindex="-1"></a><span class="do">## [1] &quot;year 39 total 1204 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-83"><a href="population-growth-conflicts-and-migrations.html#cb41-83" tabindex="-1"></a><span class="do">## [1] &quot;year 40 total 1227 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-84"><a href="population-growth-conflicts-and-migrations.html#cb41-84" tabindex="-1"></a><span class="do">## [1] &quot;year 41 total 1234 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-85"><a href="population-growth-conflicts-and-migrations.html#cb41-85" tabindex="-1"></a><span class="do">## [1] &quot;year 42 total 1232 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-86"><a href="population-growth-conflicts-and-migrations.html#cb41-86" tabindex="-1"></a><span class="do">## [1] &quot;year 43 total 1230 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-87"><a href="population-growth-conflicts-and-migrations.html#cb41-87" tabindex="-1"></a><span class="do">## [1] &quot;year 44 total 1243 with 28 sites ( F:1,HG:27 )&quot;</span></span>
<span id="cb41-88"><a href="population-growth-conflicts-and-migrations.html#cb41-88" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;8 migrant from HG to HG&quot;</span></span>
<span id="cb41-89"><a href="population-growth-conflicts-and-migrations.html#cb41-89" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb41-90"><a href="population-growth-conflicts-and-migrations.html#cb41-90" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-91"><a href="population-growth-conflicts-and-migrations.html#cb41-91" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;35 migrant from F to F&quot;</span></span>
<span id="cb41-92"><a href="population-growth-conflicts-and-migrations.html#cb41-92" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 41 and pop 6&quot;</span></span>
<span id="cb41-93"><a href="population-growth-conflicts-and-migrations.html#cb41-93" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 36 and pop 4&quot;</span></span>
<span id="cb41-94"><a href="population-growth-conflicts-and-migrations.html#cb41-94" tabindex="-1"></a><span class="do">## [1] &quot;year 45 total 1308 with 30 sites ( F:1,HG:29 )&quot;</span></span>
<span id="cb41-95"><a href="population-growth-conflicts-and-migrations.html#cb41-95" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb41-96"><a href="population-growth-conflicts-and-migrations.html#cb41-96" tabindex="-1"></a><span class="do">## [1] &quot;year 46 total 1303 with 30 sites ( F:1,HG:29 )&quot;</span></span>
<span id="cb41-97"><a href="population-growth-conflicts-and-migrations.html#cb41-97" tabindex="-1"></a><span class="do">## [1] &quot;year 47 total 1307 with 30 sites ( F:1,HG:29 )&quot;</span></span>
<span id="cb41-98"><a href="population-growth-conflicts-and-migrations.html#cb41-98" tabindex="-1"></a><span class="do">## [1] &quot;year 48 total 1302 with 30 sites ( F:1,HG:29 )&quot;</span></span>
<span id="cb41-99"><a href="population-growth-conflicts-and-migrations.html#cb41-99" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 30 and pop 7&quot;</span></span>
<span id="cb41-100"><a href="population-growth-conflicts-and-migrations.html#cb41-100" tabindex="-1"></a><span class="do">## [1] &quot;year 49 total 1318 with 31 sites ( F:1,HG:30 )&quot;</span></span>
<span id="cb41-101"><a href="population-growth-conflicts-and-migrations.html#cb41-101" tabindex="-1"></a><span class="do">## [1] &quot;year 50 total 1332 with 31 sites ( F:1,HG:30 )&quot;</span></span>
<span id="cb41-102"><a href="population-growth-conflicts-and-migrations.html#cb41-102" tabindex="-1"></a><span class="do">## [1] &quot;year 51 total 1334 with 31 sites ( F:1,HG:30 )&quot;</span></span>
<span id="cb41-103"><a href="population-growth-conflicts-and-migrations.html#cb41-103" tabindex="-1"></a><span class="do">## [1] &quot;year 52 total 1344 with 31 sites ( F:1,HG:30 )&quot;</span></span>
<span id="cb41-104"><a href="population-growth-conflicts-and-migrations.html#cb41-104" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb41-105"><a href="population-growth-conflicts-and-migrations.html#cb41-105" tabindex="-1"></a><span class="do">## [1] &quot;year 53 total 1336 with 31 sites ( F:1,HG:30 )&quot;</span></span>
<span id="cb41-106"><a href="population-growth-conflicts-and-migrations.html#cb41-106" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;8 migrant from HG to HG&quot;</span></span>
<span id="cb41-107"><a href="population-growth-conflicts-and-migrations.html#cb41-107" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 38 and pop 9&quot;</span></span>
<span id="cb41-108"><a href="population-growth-conflicts-and-migrations.html#cb41-108" tabindex="-1"></a><span class="do">## [1] &quot;year 54 total 1359 with 32 sites ( F:1,HG:31 )&quot;</span></span>
<span id="cb41-109"><a href="population-growth-conflicts-and-migrations.html#cb41-109" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 17 and pop 4&quot;</span></span>
<span id="cb41-110"><a href="population-growth-conflicts-and-migrations.html#cb41-110" tabindex="-1"></a><span class="do">## [1] &quot;year 55 total 1358 with 33 sites ( F:1,HG:32 )&quot;</span></span>
<span id="cb41-111"><a href="population-growth-conflicts-and-migrations.html#cb41-111" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-112"><a href="population-growth-conflicts-and-migrations.html#cb41-112" tabindex="-1"></a><span class="do">## [1] &quot;year 56 total 1366 with 33 sites ( F:1,HG:32 )&quot;</span></span>
<span id="cb41-113"><a href="population-growth-conflicts-and-migrations.html#cb41-113" tabindex="-1"></a><span class="do">## [1] &quot;year 57 total 1374 with 33 sites ( F:1,HG:32 )&quot;</span></span>
<span id="cb41-114"><a href="population-growth-conflicts-and-migrations.html#cb41-114" tabindex="-1"></a><span class="do">## [1] &quot;year 58 total 1376 with 33 sites ( F:1,HG:32 )&quot;</span></span>
<span id="cb41-115"><a href="population-growth-conflicts-and-migrations.html#cb41-115" tabindex="-1"></a><span class="do">## [1] &quot;year 59 total 1377 with 33 sites ( F:1,HG:32 )&quot;</span></span>
<span id="cb41-116"><a href="population-growth-conflicts-and-migrations.html#cb41-116" tabindex="-1"></a><span class="do">## [1] &quot;year 60 total 1379 with 33 sites ( F:1,HG:32 )&quot;</span></span>
<span id="cb41-117"><a href="population-growth-conflicts-and-migrations.html#cb41-117" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb41-118"><a href="population-growth-conflicts-and-migrations.html#cb41-118" tabindex="-1"></a><span class="do">## [1] &quot;year 61 total 1386 with 33 sites ( F:1,HG:32 )&quot;</span></span>
<span id="cb41-119"><a href="population-growth-conflicts-and-migrations.html#cb41-119" tabindex="-1"></a><span class="do">## [1] &quot;year 62 total 1399 with 33 sites ( F:1,HG:32 )&quot;</span></span>
<span id="cb41-120"><a href="population-growth-conflicts-and-migrations.html#cb41-120" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb41-121"><a href="population-growth-conflicts-and-migrations.html#cb41-121" tabindex="-1"></a><span class="do">## [1] &quot;year 63 total 1406 with 33 sites ( F:1,HG:32 )&quot;</span></span>
<span id="cb41-122"><a href="population-growth-conflicts-and-migrations.html#cb41-122" tabindex="-1"></a><span class="do">## [1] &quot;year 64 total 1410 with 33 sites ( F:1,HG:32 )&quot;</span></span>
<span id="cb41-123"><a href="population-growth-conflicts-and-migrations.html#cb41-123" tabindex="-1"></a><span class="do">## [1] &quot;year 65 total 1398 with 33 sites ( F:1,HG:32 )&quot;</span></span>
<span id="cb41-124"><a href="population-growth-conflicts-and-migrations.html#cb41-124" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb41-125"><a href="population-growth-conflicts-and-migrations.html#cb41-125" tabindex="-1"></a><span class="do">## [1] &quot;year 66 total 1382 with 33 sites ( F:1,HG:32 )&quot;</span></span>
<span id="cb41-126"><a href="population-growth-conflicts-and-migrations.html#cb41-126" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;34 migrant from F to F&quot;</span></span>
<span id="cb41-127"><a href="population-growth-conflicts-and-migrations.html#cb41-127" tabindex="-1"></a><span class="do">## [1] &quot;year 67 total 1430 with 33 sites ( F:1,HG:32 )&quot;</span></span>
<span id="cb41-128"><a href="population-growth-conflicts-and-migrations.html#cb41-128" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-129"><a href="population-growth-conflicts-and-migrations.html#cb41-129" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 44 and pop 4&quot;</span></span>
<span id="cb41-130"><a href="population-growth-conflicts-and-migrations.html#cb41-130" tabindex="-1"></a><span class="do">## [1] &quot;year 68 total 1417 with 34 sites ( F:1,HG:33 )&quot;</span></span>
<span id="cb41-131"><a href="population-growth-conflicts-and-migrations.html#cb41-131" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;8 migrant from HG to HG&quot;</span></span>
<span id="cb41-132"><a href="population-growth-conflicts-and-migrations.html#cb41-132" tabindex="-1"></a><span class="do">## [1] &quot;year 69 total 1399 with 34 sites ( F:1,HG:33 )&quot;</span></span>
<span id="cb41-133"><a href="population-growth-conflicts-and-migrations.html#cb41-133" tabindex="-1"></a><span class="do">## [1] &quot;year 70 total 1388 with 34 sites ( F:1,HG:33 )&quot;</span></span>
<span id="cb41-134"><a href="population-growth-conflicts-and-migrations.html#cb41-134" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-135"><a href="population-growth-conflicts-and-migrations.html#cb41-135" tabindex="-1"></a><span class="do">## [1] &quot;year 71 total 1403 with 34 sites ( F:1,HG:33 )&quot;</span></span>
<span id="cb41-136"><a href="population-growth-conflicts-and-migrations.html#cb41-136" tabindex="-1"></a><span class="do">## [1] &quot;year 72 total 1418 with 34 sites ( F:1,HG:33 )&quot;</span></span>
<span id="cb41-137"><a href="population-growth-conflicts-and-migrations.html#cb41-137" tabindex="-1"></a><span class="do">## [1] &quot;year 73 total 1430 with 34 sites ( F:1,HG:33 )&quot;</span></span>
<span id="cb41-138"><a href="population-growth-conflicts-and-migrations.html#cb41-138" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb41-139"><a href="population-growth-conflicts-and-migrations.html#cb41-139" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;39 migrant from F to F&quot;</span></span>
<span id="cb41-140"><a href="population-growth-conflicts-and-migrations.html#cb41-140" tabindex="-1"></a><span class="do">## [1] &quot;year 74 total 1468 with 34 sites ( F:1,HG:33 )&quot;</span></span>
<span id="cb41-141"><a href="population-growth-conflicts-and-migrations.html#cb41-141" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 4 and pop 4&quot;</span></span>
<span id="cb41-142"><a href="population-growth-conflicts-and-migrations.html#cb41-142" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb41-143"><a href="population-growth-conflicts-and-migrations.html#cb41-143" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 36 and pop 6&quot;</span></span>
<span id="cb41-144"><a href="population-growth-conflicts-and-migrations.html#cb41-144" tabindex="-1"></a><span class="do">## [1] &quot;year 75 total 1456 with 36 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-145"><a href="population-growth-conflicts-and-migrations.html#cb41-145" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;8 migrant from HG to HG&quot;</span></span>
<span id="cb41-146"><a href="population-growth-conflicts-and-migrations.html#cb41-146" tabindex="-1"></a><span class="do">## [1] &quot;year 76 total 1459 with 36 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-147"><a href="population-growth-conflicts-and-migrations.html#cb41-147" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb41-148"><a href="population-growth-conflicts-and-migrations.html#cb41-148" tabindex="-1"></a><span class="do">## [1] &quot;year 77 total 1438 with 36 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-149"><a href="population-growth-conflicts-and-migrations.html#cb41-149" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb41-150"><a href="population-growth-conflicts-and-migrations.html#cb41-150" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;0 migrant from HG to HG&quot;</span></span>
<span id="cb41-151"><a href="population-growth-conflicts-and-migrations.html#cb41-151" tabindex="-1"></a><span class="do">## [1] &quot;year 78 total 1439 with 36 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-152"><a href="population-growth-conflicts-and-migrations.html#cb41-152" tabindex="-1"></a><span class="do">## [1] &quot;year 79 total 1433 with 36 sites ( F:1,HG:34 )&quot;</span></span>
<span id="cb41-153"><a href="population-growth-conflicts-and-migrations.html#cb41-153" tabindex="-1"></a><span class="do">## [1] &quot;year 80 total 1427 with 36 sites ( F:1,HG:34 )&quot;</span></span>
<span id="cb41-154"><a href="population-growth-conflicts-and-migrations.html#cb41-154" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;8 migrant from HG to HG&quot;</span></span>
<span id="cb41-155"><a href="population-growth-conflicts-and-migrations.html#cb41-155" tabindex="-1"></a><span class="do">## [1] &quot;year 81 total 1434 with 36 sites ( F:1,HG:34 )&quot;</span></span>
<span id="cb41-156"><a href="population-growth-conflicts-and-migrations.html#cb41-156" tabindex="-1"></a><span class="do">## [1] &quot;year 82 total 1415 with 36 sites ( F:1,HG:34 )&quot;</span></span>
<span id="cb41-157"><a href="population-growth-conflicts-and-migrations.html#cb41-157" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb41-158"><a href="population-growth-conflicts-and-migrations.html#cb41-158" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-159"><a href="population-growth-conflicts-and-migrations.html#cb41-159" tabindex="-1"></a><span class="do">## [1] &quot;year 83 total 1402 with 36 sites ( F:1,HG:34 )&quot;</span></span>
<span id="cb41-160"><a href="population-growth-conflicts-and-migrations.html#cb41-160" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 46 and pop 3&quot;</span></span>
<span id="cb41-161"><a href="population-growth-conflicts-and-migrations.html#cb41-161" tabindex="-1"></a><span class="do">## [1] &quot;year 84 total 1405 with 37 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-162"><a href="population-growth-conflicts-and-migrations.html#cb41-162" tabindex="-1"></a><span class="do">## [1] &quot;year 85 total 1426 with 37 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-163"><a href="population-growth-conflicts-and-migrations.html#cb41-163" tabindex="-1"></a><span class="do">## [1] &quot;year 86 total 1433 with 37 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-164"><a href="population-growth-conflicts-and-migrations.html#cb41-164" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-165"><a href="population-growth-conflicts-and-migrations.html#cb41-165" tabindex="-1"></a><span class="do">## [1] &quot;year 87 total 1420 with 37 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-166"><a href="population-growth-conflicts-and-migrations.html#cb41-166" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb41-167"><a href="population-growth-conflicts-and-migrations.html#cb41-167" tabindex="-1"></a><span class="do">## [1] &quot;year 88 total 1444 with 37 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-168"><a href="population-growth-conflicts-and-migrations.html#cb41-168" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;8 migrant from HG to HG&quot;</span></span>
<span id="cb41-169"><a href="population-growth-conflicts-and-migrations.html#cb41-169" tabindex="-1"></a><span class="do">## [1] &quot;year 89 total 1430 with 37 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-170"><a href="population-growth-conflicts-and-migrations.html#cb41-170" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;11 migrant from HG to HG&quot;</span></span>
<span id="cb41-171"><a href="population-growth-conflicts-and-migrations.html#cb41-171" tabindex="-1"></a><span class="do">## [1] &quot;year 90 total 1439 with 37 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-172"><a href="population-growth-conflicts-and-migrations.html#cb41-172" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 39 and pop 6&quot;</span></span>
<span id="cb41-173"><a href="population-growth-conflicts-and-migrations.html#cb41-173" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb41-174"><a href="population-growth-conflicts-and-migrations.html#cb41-174" tabindex="-1"></a><span class="do">## [1] &quot;year 91 total 1475 with 38 sites ( F:1,HG:36 )&quot;</span></span>
<span id="cb41-175"><a href="population-growth-conflicts-and-migrations.html#cb41-175" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-176"><a href="population-growth-conflicts-and-migrations.html#cb41-176" tabindex="-1"></a><span class="do">## [1] &quot;year 92 total 1470 with 38 sites ( F:1,HG:36 )&quot;</span></span>
<span id="cb41-177"><a href="population-growth-conflicts-and-migrations.html#cb41-177" tabindex="-1"></a><span class="do">## [1] &quot;year 93 total 1472 with 38 sites ( F:1,HG:36 )&quot;</span></span>
<span id="cb41-178"><a href="population-growth-conflicts-and-migrations.html#cb41-178" tabindex="-1"></a><span class="do">## [1] &quot;year 94 total 1478 with 38 sites ( F:1,HG:36 )&quot;</span></span>
<span id="cb41-179"><a href="population-growth-conflicts-and-migrations.html#cb41-179" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-180"><a href="population-growth-conflicts-and-migrations.html#cb41-180" tabindex="-1"></a><span class="do">## [1] &quot;year 95 total 1479 with 38 sites ( F:1,HG:36 )&quot;</span></span>
<span id="cb41-181"><a href="population-growth-conflicts-and-migrations.html#cb41-181" tabindex="-1"></a><span class="do">## [1] &quot;year 96 total 1464 with 38 sites ( F:1,HG:36 )&quot;</span></span>
<span id="cb41-182"><a href="population-growth-conflicts-and-migrations.html#cb41-182" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 28 and pop 10&quot;</span></span>
<span id="cb41-183"><a href="population-growth-conflicts-and-migrations.html#cb41-183" tabindex="-1"></a><span class="do">## [1] &quot;year 97 total 1492 with 39 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-184"><a href="population-growth-conflicts-and-migrations.html#cb41-184" tabindex="-1"></a><span class="do">## [1] &quot;year 98 total 1481 with 39 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-185"><a href="population-growth-conflicts-and-migrations.html#cb41-185" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb41-186"><a href="population-growth-conflicts-and-migrations.html#cb41-186" tabindex="-1"></a><span class="do">## [1] &quot;year 99 total 1490 with 39 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-187"><a href="population-growth-conflicts-and-migrations.html#cb41-187" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb41-188"><a href="population-growth-conflicts-and-migrations.html#cb41-188" tabindex="-1"></a><span class="do">## [1] &quot;year 100 total 1504 with 39 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-189"><a href="population-growth-conflicts-and-migrations.html#cb41-189" tabindex="-1"></a><span class="do">## [1] &quot;year 101 total 1497 with 39 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-190"><a href="population-growth-conflicts-and-migrations.html#cb41-190" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-191"><a href="population-growth-conflicts-and-migrations.html#cb41-191" tabindex="-1"></a><span class="do">## [1] &quot;year 102 total 1506 with 39 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-192"><a href="population-growth-conflicts-and-migrations.html#cb41-192" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-193"><a href="population-growth-conflicts-and-migrations.html#cb41-193" tabindex="-1"></a><span class="do">## [1] &quot;year 103 total 1507 with 39 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-194"><a href="population-growth-conflicts-and-migrations.html#cb41-194" tabindex="-1"></a><span class="do">## [1] &quot;year 104 total 1506 with 39 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-195"><a href="population-growth-conflicts-and-migrations.html#cb41-195" tabindex="-1"></a><span class="do">## [1] &quot;year 105 total 1511 with 39 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-196"><a href="population-growth-conflicts-and-migrations.html#cb41-196" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb41-197"><a href="population-growth-conflicts-and-migrations.html#cb41-197" tabindex="-1"></a><span class="do">## [1] &quot;year 106 total 1509 with 39 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-198"><a href="population-growth-conflicts-and-migrations.html#cb41-198" tabindex="-1"></a><span class="do">## [1] &quot;year 107 total 1474 with 39 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-199"><a href="population-growth-conflicts-and-migrations.html#cb41-199" tabindex="-1"></a><span class="do">## [1] &quot;year 108 total 1478 with 39 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-200"><a href="population-growth-conflicts-and-migrations.html#cb41-200" tabindex="-1"></a><span class="do">## [1] &quot;year 109 total 1495 with 39 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-201"><a href="population-growth-conflicts-and-migrations.html#cb41-201" tabindex="-1"></a><span class="do">## [1] &quot;year 110 total 1503 with 39 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-202"><a href="population-growth-conflicts-and-migrations.html#cb41-202" tabindex="-1"></a><span class="do">## [1] &quot;year 111 total 1515 with 39 sites ( F:1,HG:36 )&quot;</span></span>
<span id="cb41-203"><a href="population-growth-conflicts-and-migrations.html#cb41-203" tabindex="-1"></a><span class="do">## [1] &quot;year 112 total 1517 with 39 sites ( F:1,HG:36 )&quot;</span></span>
<span id="cb41-204"><a href="population-growth-conflicts-and-migrations.html#cb41-204" tabindex="-1"></a><span class="do">## [1] &quot;year 113 total 1516 with 39 sites ( F:1,HG:36 )&quot;</span></span>
<span id="cb41-205"><a href="population-growth-conflicts-and-migrations.html#cb41-205" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb41-206"><a href="population-growth-conflicts-and-migrations.html#cb41-206" tabindex="-1"></a><span class="do">## [1] &quot;year 114 total 1518 with 39 sites ( F:1,HG:36 )&quot;</span></span>
<span id="cb41-207"><a href="population-growth-conflicts-and-migrations.html#cb41-207" tabindex="-1"></a><span class="do">## [1] &quot;year 115 total 1505 with 39 sites ( F:1,HG:36 )&quot;</span></span>
<span id="cb41-208"><a href="population-growth-conflicts-and-migrations.html#cb41-208" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 40 and pop 5&quot;</span></span>
<span id="cb41-209"><a href="population-growth-conflicts-and-migrations.html#cb41-209" tabindex="-1"></a><span class="do">## [1] &quot;year 116 total 1515 with 40 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-210"><a href="population-growth-conflicts-and-migrations.html#cb41-210" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;36 migrant from F to F&quot;</span></span>
<span id="cb41-211"><a href="population-growth-conflicts-and-migrations.html#cb41-211" tabindex="-1"></a><span class="do">## [1] &quot;year 117 total 1560 with 40 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-212"><a href="population-growth-conflicts-and-migrations.html#cb41-212" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;59 migrant from F to F&quot;</span></span>
<span id="cb41-213"><a href="population-growth-conflicts-and-migrations.html#cb41-213" tabindex="-1"></a><span class="do">## [1] &quot;year 118 total 1615 with 40 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-214"><a href="population-growth-conflicts-and-migrations.html#cb41-214" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-215"><a href="population-growth-conflicts-and-migrations.html#cb41-215" tabindex="-1"></a><span class="do">## [1] &quot;year 119 total 1558 with 40 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-216"><a href="population-growth-conflicts-and-migrations.html#cb41-216" tabindex="-1"></a><span class="do">## [1] &quot;year 120 total 1538 with 40 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-217"><a href="population-growth-conflicts-and-migrations.html#cb41-217" tabindex="-1"></a><span class="do">## [1] &quot;year 121 total 1545 with 40 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-218"><a href="population-growth-conflicts-and-migrations.html#cb41-218" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;9 migrant from HG to HG&quot;</span></span>
<span id="cb41-219"><a href="population-growth-conflicts-and-migrations.html#cb41-219" tabindex="-1"></a><span class="do">## [1] &quot;year 122 total 1551 with 40 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-220"><a href="population-growth-conflicts-and-migrations.html#cb41-220" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb41-221"><a href="population-growth-conflicts-and-migrations.html#cb41-221" tabindex="-1"></a><span class="do">## [1] &quot;year 123 total 1554 with 40 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-222"><a href="population-growth-conflicts-and-migrations.html#cb41-222" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-223"><a href="population-growth-conflicts-and-migrations.html#cb41-223" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;2 migrant from HG to HG&quot;</span></span>
<span id="cb41-224"><a href="population-growth-conflicts-and-migrations.html#cb41-224" tabindex="-1"></a><span class="do">## [1] &quot;year 124 total 1559 with 40 sites ( F:1,HG:35 )&quot;</span></span>
<span id="cb41-225"><a href="population-growth-conflicts-and-migrations.html#cb41-225" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 40 and pop 9&quot;</span></span>
<span id="cb41-226"><a href="population-growth-conflicts-and-migrations.html#cb41-226" tabindex="-1"></a><span class="do">## [1] &quot;year 125 total 1565 with 41 sites ( F:1,HG:36 )&quot;</span></span>
<span id="cb41-227"><a href="population-growth-conflicts-and-migrations.html#cb41-227" tabindex="-1"></a><span class="do">## [1] &quot;year 126 total 1549 with 41 sites ( F:1,HG:36 )&quot;</span></span>
<span id="cb41-228"><a href="population-growth-conflicts-and-migrations.html#cb41-228" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb41-229"><a href="population-growth-conflicts-and-migrations.html#cb41-229" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb41-230"><a href="population-growth-conflicts-and-migrations.html#cb41-230" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 23 and pop 5&quot;</span></span>
<span id="cb41-231"><a href="population-growth-conflicts-and-migrations.html#cb41-231" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb41-232"><a href="population-growth-conflicts-and-migrations.html#cb41-232" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;2 migrant from HG to HG&quot;</span></span>
<span id="cb41-233"><a href="population-growth-conflicts-and-migrations.html#cb41-233" tabindex="-1"></a><span class="do">## [1] &quot;year 127 total 1581 with 42 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-234"><a href="population-growth-conflicts-and-migrations.html#cb41-234" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb41-235"><a href="population-growth-conflicts-and-migrations.html#cb41-235" tabindex="-1"></a><span class="do">## [1] &quot;year 128 total 1571 with 42 sites ( F:1,HG:37 )&quot;</span></span>
<span id="cb41-236"><a href="population-growth-conflicts-and-migrations.html#cb41-236" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb41-237"><a href="population-growth-conflicts-and-migrations.html#cb41-237" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 34 and pop 6&quot;</span></span>
<span id="cb41-238"><a href="population-growth-conflicts-and-migrations.html#cb41-238" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb41-239"><a href="population-growth-conflicts-and-migrations.html#cb41-239" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb41-240"><a href="population-growth-conflicts-and-migrations.html#cb41-240" tabindex="-1"></a><span class="do">## [1] &quot;year 129 total 1571 with 43 sites ( F:1,HG:38 )&quot;</span></span>
<span id="cb41-241"><a href="population-growth-conflicts-and-migrations.html#cb41-241" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;7 migrant from HG to HG&quot;</span></span>
<span id="cb41-242"><a href="population-growth-conflicts-and-migrations.html#cb41-242" tabindex="-1"></a><span class="do">## [1] &quot;year 130 total 1570 with 43 sites ( F:1,HG:38 )&quot;</span></span>
<span id="cb41-243"><a href="population-growth-conflicts-and-migrations.html#cb41-243" tabindex="-1"></a><span class="do">## [1] &quot;year 131 total 1557 with 43 sites ( F:1,HG:38 )&quot;</span></span>
<span id="cb41-244"><a href="population-growth-conflicts-and-migrations.html#cb41-244" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb41-245"><a href="population-growth-conflicts-and-migrations.html#cb41-245" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 27 and pop 7&quot;</span></span>
<span id="cb41-246"><a href="population-growth-conflicts-and-migrations.html#cb41-246" tabindex="-1"></a><span class="do">## [1] &quot;year 132 total 1577 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-247"><a href="population-growth-conflicts-and-migrations.html#cb41-247" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb41-248"><a href="population-growth-conflicts-and-migrations.html#cb41-248" tabindex="-1"></a><span class="do">## [1] &quot;year 133 total 1587 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-249"><a href="population-growth-conflicts-and-migrations.html#cb41-249" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-250"><a href="population-growth-conflicts-and-migrations.html#cb41-250" tabindex="-1"></a><span class="do">## [1] &quot;year 134 total 1600 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-251"><a href="population-growth-conflicts-and-migrations.html#cb41-251" tabindex="-1"></a><span class="do">## [1] &quot;year 135 total 1614 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-252"><a href="population-growth-conflicts-and-migrations.html#cb41-252" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-253"><a href="population-growth-conflicts-and-migrations.html#cb41-253" tabindex="-1"></a><span class="do">## [1] &quot;year 136 total 1619 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-254"><a href="population-growth-conflicts-and-migrations.html#cb41-254" tabindex="-1"></a><span class="do">## [1] &quot;year 137 total 1614 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-255"><a href="population-growth-conflicts-and-migrations.html#cb41-255" tabindex="-1"></a><span class="do">## [1] &quot;year 138 total 1605 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-256"><a href="population-growth-conflicts-and-migrations.html#cb41-256" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-257"><a href="population-growth-conflicts-and-migrations.html#cb41-257" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-258"><a href="population-growth-conflicts-and-migrations.html#cb41-258" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb41-259"><a href="population-growth-conflicts-and-migrations.html#cb41-259" tabindex="-1"></a><span class="do">## [1] &quot;year 139 total 1627 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-260"><a href="population-growth-conflicts-and-migrations.html#cb41-260" tabindex="-1"></a><span class="do">## [1] &quot;year 140 total 1638 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-261"><a href="population-growth-conflicts-and-migrations.html#cb41-261" tabindex="-1"></a><span class="do">## [1] &quot;year 141 total 1637 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-262"><a href="population-growth-conflicts-and-migrations.html#cb41-262" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;2 migrant from HG to HG&quot;</span></span>
<span id="cb41-263"><a href="population-growth-conflicts-and-migrations.html#cb41-263" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;3 migrant from HG to HG&quot;</span></span>
<span id="cb41-264"><a href="population-growth-conflicts-and-migrations.html#cb41-264" tabindex="-1"></a><span class="do">## [1] &quot;year 142 total 1646 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-265"><a href="population-growth-conflicts-and-migrations.html#cb41-265" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;8 migrant from HG to HG&quot;</span></span>
<span id="cb41-266"><a href="population-growth-conflicts-and-migrations.html#cb41-266" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;2 migrant from HG to HG&quot;</span></span>
<span id="cb41-267"><a href="population-growth-conflicts-and-migrations.html#cb41-267" tabindex="-1"></a><span class="do">## [1] &quot;year 143 total 1653 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-268"><a href="population-growth-conflicts-and-migrations.html#cb41-268" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;40 migrant from F to F&quot;</span></span>
<span id="cb41-269"><a href="population-growth-conflicts-and-migrations.html#cb41-269" tabindex="-1"></a><span class="do">## [1] &quot;year 144 total 1718 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-270"><a href="population-growth-conflicts-and-migrations.html#cb41-270" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;48 migrant from F to F&quot;</span></span>
<span id="cb41-271"><a href="population-growth-conflicts-and-migrations.html#cb41-271" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;5 migrant from HG to HG&quot;</span></span>
<span id="cb41-272"><a href="population-growth-conflicts-and-migrations.html#cb41-272" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-273"><a href="population-growth-conflicts-and-migrations.html#cb41-273" tabindex="-1"></a><span class="do">## [1] &quot;year 145 total 1729 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-274"><a href="population-growth-conflicts-and-migrations.html#cb41-274" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;54 migrant from F to F&quot;</span></span>
<span id="cb41-275"><a href="population-growth-conflicts-and-migrations.html#cb41-275" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-276"><a href="population-growth-conflicts-and-migrations.html#cb41-276" tabindex="-1"></a><span class="do">## [1] &quot;year 146 total 1759 with 44 sites ( F:1,HG:39 )&quot;</span></span>
<span id="cb41-277"><a href="population-growth-conflicts-and-migrations.html#cb41-277" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (F) of K 189 and pop 68&quot;</span></span>
<span id="cb41-278"><a href="population-growth-conflicts-and-migrations.html#cb41-278" tabindex="-1"></a><span class="do">## [1] &quot;year 147 total 1779 with 45 sites ( F:2,HG:39 )&quot;</span></span>
<span id="cb41-279"><a href="population-growth-conflicts-and-migrations.html#cb41-279" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 29 and pop 4&quot;</span></span>
<span id="cb41-280"><a href="population-growth-conflicts-and-migrations.html#cb41-280" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          |---------|---------|---------|---------|=========================================                                          [1] &quot;new settlement (HG) of K 30 and pop 4&quot;</span></span>
<span id="cb41-281"><a href="population-growth-conflicts-and-migrations.html#cb41-281" tabindex="-1"></a><span class="do">## [1] &quot;year 148 total 1824 with 47 sites ( F:2,HG:41 )&quot;</span></span>
<span id="cb41-282"><a href="population-growth-conflicts-and-migrations.html#cb41-282" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;4 migrant from HG to HG&quot;</span></span>
<span id="cb41-283"><a href="population-growth-conflicts-and-migrations.html#cb41-283" tabindex="-1"></a><span class="do">## [1] &quot;year 149 total 1857 with 47 sites ( F:2,HG:41 )&quot;</span></span>
<span id="cb41-284"><a href="population-growth-conflicts-and-migrations.html#cb41-284" tabindex="-1"></a><span class="do">## |---------|---------|---------|---------|=========================================                                          [1] &quot;6 migrant from HG to HG&quot;</span></span>
<span id="cb41-285"><a href="population-growth-conflicts-and-migrations.html#cb41-285" tabindex="-1"></a><span class="do">## [1] &quot;year 150 total 1873 with 47 sites ( F:2,HG:41 )&quot;</span></span>
<span id="cb41-286"><a href="population-growth-conflicts-and-migrations.html#cb41-286" tabindex="-1"></a><span class="do">## [1] &quot;year 151 total 1889 with 47 sites ( F:2,HG:41 )&quot;</span></span></code></pre></div>
Check the code of the simulation functions here:
<details>
<summary>
Show code
</summary>
<p><strong>Code</strong></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="population-growth-conflicts-and-migrations.html#cb42-1" tabindex="-1"></a><span class="do">## Function 17. Change population sizes</span></span>
<span id="cb42-2"><a href="population-growth-conflicts-and-migrations.html#cb42-2" tabindex="-1"></a>changePopSize <span class="ot">&lt;-</span> <span class="cf">function</span>(loosingPop, size, <span class="at">winingPop=</span><span class="cn">NULL</span>, <span class="at">new=</span>F,</span>
<span id="cb42-3"><a href="population-growth-conflicts-and-migrations.html#cb42-3" tabindex="-1"></a>                          <span class="at">method=</span><span class="st">&quot;random&quot;</span>, <span class="at">probs=</span>dnorm,</span>
<span id="cb42-4"><a href="population-growth-conflicts-and-migrations.html#cb42-4" tabindex="-1"></a>                          <span class="at">prob.option=</span><span class="fu">list</span>(<span class="st">&quot;sd&quot;</span><span class="ot">=</span><span class="dv">10</span>, <span class="st">&quot;mean&quot;</span><span class="ot">=</span><span class="dv">22</span>)) {</span>
<span id="cb42-5"><a href="population-growth-conflicts-and-migrations.html#cb42-5" tabindex="-1"></a>  <span class="co">#print(dim(loosingPop))</span></span>
<span id="cb42-6"><a href="population-growth-conflicts-and-migrations.html#cb42-6" tabindex="-1"></a>  <span class="co">#if(!is.null(winingPop))</span></span>
<span id="cb42-7"><a href="population-growth-conflicts-and-migrations.html#cb42-7" tabindex="-1"></a>  <span class="co">#    print(dim(winingPop))</span></span>
<span id="cb42-8"><a href="population-growth-conflicts-and-migrations.html#cb42-8" tabindex="-1"></a>  <span class="co">#if(length(size)==0 || size==0)return(data.frame(Age=numeric(),Sex=character()))</span></span>
<span id="cb42-9"><a href="population-growth-conflicts-and-migrations.html#cb42-9" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(loosingPop)<span class="sc">==</span><span class="dv">0</span>){</span>
<span id="cb42-10"><a href="population-growth-conflicts-and-migrations.html#cb42-10" tabindex="-1"></a>    kill <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb42-11"><a href="population-growth-conflicts-and-migrations.html#cb42-11" tabindex="-1"></a>  }<span class="cf">else</span> <span class="cf">if</span>(method<span class="sc">==</span><span class="st">&quot;random&quot;</span>){</span>
<span id="cb42-12"><a href="population-growth-conflicts-and-migrations.html#cb42-12" tabindex="-1"></a>    kill <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>(</span>
<span id="cb42-13"><a href="population-growth-conflicts-and-migrations.html#cb42-13" tabindex="-1"></a>      <span class="fu">sample</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(loosingPop), <span class="at">size=</span>size,</span>
<span id="cb42-14"><a href="population-growth-conflicts-and-migrations.html#cb42-14" tabindex="-1"></a>             <span class="at">prob=</span><span class="fu">probs</span>(loosingPop<span class="sc">$</span>Age, <span class="at">mean=</span>prob.option<span class="sc">$</span>mean, <span class="at">sd=</span>prob.option<span class="sc">$</span>sd)),</span>
<span id="cb42-15"><a href="population-growth-conflicts-and-migrations.html#cb42-15" tabindex="-1"></a>      <span class="at">error=</span><span class="cf">function</span>(e){</span>
<span id="cb42-16"><a href="population-growth-conflicts-and-migrations.html#cb42-16" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;problem with population replacement for settlement of size:&quot;</span>,</span>
<span id="cb42-17"><a href="population-growth-conflicts-and-migrations.html#cb42-17" tabindex="-1"></a>                     <span class="fu">nrow</span>(loosingPop), <span class="st">&quot; need to loose &quot;</span>, size));<span class="dv">0</span></span>
<span id="cb42-18"><a href="population-growth-conflicts-and-migrations.html#cb42-18" tabindex="-1"></a>        }</span>
<span id="cb42-19"><a href="population-growth-conflicts-and-migrations.html#cb42-19" tabindex="-1"></a>      )</span>
<span id="cb42-20"><a href="population-growth-conflicts-and-migrations.html#cb42-20" tabindex="-1"></a>  }</span>
<span id="cb42-21"><a href="population-growth-conflicts-and-migrations.html#cb42-21" tabindex="-1"></a>  <span class="co">#print(paste(&quot;diff&quot;,nrow(popdistrib)-size,&quot;new&quot;,size))</span></span>
<span id="cb42-22"><a href="population-growth-conflicts-and-migrations.html#cb42-22" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(winingPop)){</span>
<span id="cb42-23"><a href="population-growth-conflicts-and-migrations.html#cb42-23" tabindex="-1"></a>    winingPop <span class="ot">&lt;-</span> <span class="fu">rbind</span>(winingPop, loosingPop[kill,])</span>
<span id="cb42-24"><a href="population-growth-conflicts-and-migrations.html#cb42-24" tabindex="-1"></a>  }</span>
<span id="cb42-25"><a href="population-growth-conflicts-and-migrations.html#cb42-25" tabindex="-1"></a>  loosingPop <span class="ot">&lt;-</span> loosingPop[<span class="sc">-</span>kill,]</span>
<span id="cb42-26"><a href="population-growth-conflicts-and-migrations.html#cb42-26" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(winingPop))</span>
<span id="cb42-27"><a href="population-growth-conflicts-and-migrations.html#cb42-27" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(loosingPop, winingPop))</span>
<span id="cb42-28"><a href="population-growth-conflicts-and-migrations.html#cb42-28" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb42-29"><a href="population-growth-conflicts-and-migrations.html#cb42-29" tabindex="-1"></a>    <span class="fu">return</span>(loosingPop)</span>
<span id="cb42-30"><a href="population-growth-conflicts-and-migrations.html#cb42-30" tabindex="-1"></a>  </span>
<span id="cb42-31"><a href="population-growth-conflicts-and-migrations.html#cb42-31" tabindex="-1"></a>}</span>
<span id="cb42-32"><a href="population-growth-conflicts-and-migrations.html#cb42-32" tabindex="-1"></a></span>
<span id="cb42-33"><a href="population-growth-conflicts-and-migrations.html#cb42-33" tabindex="-1"></a></span>
<span id="cb42-34"><a href="population-growth-conflicts-and-migrations.html#cb42-34" tabindex="-1"></a><span class="do">## Function 18. Check sites touching</span></span>
<span id="cb42-35"><a href="population-growth-conflicts-and-migrations.html#cb42-35" tabindex="-1"></a>whotouch <span class="ot">&lt;-</span> <span class="cf">function</span>(i, sites, Ne, <span class="at">homophily=</span>F, <span class="at">buffersize=</span><span class="dv">200</span>){</span>
<span id="cb42-36"><a href="population-growth-conflicts-and-migrations.html#cb42-36" tabindex="-1"></a>  touch <span class="ot">&lt;-</span> <span class="fu">st_intersects</span>(</span>
<span id="cb42-37"><a href="population-growth-conflicts-and-migrations.html#cb42-37" tabindex="-1"></a>    <span class="fu">st_make_valid</span>(<span class="fu">st_as_sf</span>(<span class="fu">buffer</span>(sites[i], Ne[i] <span class="sc">*</span> buffersize<span class="fl">+0.00001</span>))),</span>
<span id="cb42-38"><a href="population-growth-conflicts-and-migrations.html#cb42-38" tabindex="-1"></a>    <span class="fu">st_make_valid</span>(<span class="fu">st_as_sf</span>(<span class="fu">buffer</span>(sites, Ne <span class="sc">*</span> buffersize<span class="fl">+0.00001</span>))))</span>
<span id="cb42-39"><a href="population-growth-conflicts-and-migrations.html#cb42-39" tabindex="-1"></a>  <span class="cf">if</span>( <span class="fu">length</span>(touch) <span class="sc">&gt;</span> <span class="dv">0</span> ){</span>
<span id="cb42-40"><a href="population-growth-conflicts-and-migrations.html#cb42-40" tabindex="-1"></a>    enemies <span class="ot">&lt;-</span> <span class="fu">unlist</span>(touch)</span>
<span id="cb42-41"><a href="population-growth-conflicts-and-migrations.html#cb42-41" tabindex="-1"></a>    <span class="cf">if</span>(homophily){</span>
<span id="cb42-42"><a href="population-growth-conflicts-and-migrations.html#cb42-42" tabindex="-1"></a>      enemies <span class="ot">&lt;-</span> enemies[enemies <span class="sc">!=</span> i]</span>
<span id="cb42-43"><a href="population-growth-conflicts-and-migrations.html#cb42-43" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb42-44"><a href="population-growth-conflicts-and-migrations.html#cb42-44" tabindex="-1"></a>      enemies <span class="ot">&lt;-</span> enemies[sites<span class="sc">$</span>culture[enemies] <span class="sc">!=</span> sites<span class="sc">$</span>culture[i]]</span>
<span id="cb42-45"><a href="population-growth-conflicts-and-migrations.html#cb42-45" tabindex="-1"></a>    }</span>
<span id="cb42-46"><a href="population-growth-conflicts-and-migrations.html#cb42-46" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb42-47"><a href="population-growth-conflicts-and-migrations.html#cb42-47" tabindex="-1"></a>    enemies <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb42-48"><a href="population-growth-conflicts-and-migrations.html#cb42-48" tabindex="-1"></a>  }</span>
<span id="cb42-49"><a href="population-growth-conflicts-and-migrations.html#cb42-49" tabindex="-1"></a>  <span class="co">#after adding a small number to zero, does that means that often some zero size group may be taken as fighter? checking below if this happen</span></span>
<span id="cb42-50"><a href="population-growth-conflicts-and-migrations.html#cb42-50" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">sum</span>(Ne[enemies]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb42-51"><a href="population-growth-conflicts-and-migrations.html#cb42-51" tabindex="-1"></a>      <span class="fu">print</span>(<span class="st">&quot;some already dead enemies&quot;</span>)</span>
<span id="cb42-52"><a href="population-growth-conflicts-and-migrations.html#cb42-52" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">which</span>(Ne[enemies]<span class="sc">==</span><span class="dv">0</span>))</span>
<span id="cb42-53"><a href="population-growth-conflicts-and-migrations.html#cb42-53" tabindex="-1"></a>      enemies<span class="ot">=</span>enemies[Ne[enemies]<span class="sc">&gt;</span><span class="dv">0</span>]</span>
<span id="cb42-54"><a href="population-growth-conflicts-and-migrations.html#cb42-54" tabindex="-1"></a>  }</span>
<span id="cb42-55"><a href="population-growth-conflicts-and-migrations.html#cb42-55" tabindex="-1"></a></span>
<span id="cb42-56"><a href="population-growth-conflicts-and-migrations.html#cb42-56" tabindex="-1"></a>  <span class="fu">return</span>(enemies)</span>
<span id="cb42-57"><a href="population-growth-conflicts-and-migrations.html#cb42-57" tabindex="-1"></a>}</span>
<span id="cb42-58"><a href="population-growth-conflicts-and-migrations.html#cb42-58" tabindex="-1"></a></span>
<span id="cb42-59"><a href="population-growth-conflicts-and-migrations.html#cb42-59" tabindex="-1"></a></span>
<span id="cb42-60"><a href="population-growth-conflicts-and-migrations.html#cb42-60" tabindex="-1"></a><span class="do">## Function 19. Model a simple fight</span></span>
<span id="cb42-61"><a href="population-growth-conflicts-and-migrations.html#cb42-61" tabindex="-1"></a>simplefight <span class="ot">&lt;-</span> <span class="cf">function</span>(Ne, a, b){</span>
<span id="cb42-62"><a href="population-growth-conflicts-and-migrations.html#cb42-62" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> Ne[a] <span class="sc">/</span> (Ne[a] <span class="sc">+</span> Ne[b])){</span>
<span id="cb42-63"><a href="population-growth-conflicts-and-migrations.html#cb42-63" tabindex="-1"></a>    v <span class="ot">&lt;-</span> a</span>
<span id="cb42-64"><a href="population-growth-conflicts-and-migrations.html#cb42-64" tabindex="-1"></a>    l <span class="ot">&lt;-</span> b</span>
<span id="cb42-65"><a href="population-growth-conflicts-and-migrations.html#cb42-65" tabindex="-1"></a>  }</span>
<span id="cb42-66"><a href="population-growth-conflicts-and-migrations.html#cb42-66" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb42-67"><a href="population-growth-conflicts-and-migrations.html#cb42-67" tabindex="-1"></a>    v <span class="ot">&lt;-</span> b</span>
<span id="cb42-68"><a href="population-growth-conflicts-and-migrations.html#cb42-68" tabindex="-1"></a>    l <span class="ot">&lt;-</span> a</span>
<span id="cb42-69"><a href="population-growth-conflicts-and-migrations.html#cb42-69" tabindex="-1"></a>  }</span>
<span id="cb42-70"><a href="population-growth-conflicts-and-migrations.html#cb42-70" tabindex="-1"></a>  <span class="co"># Keep the original pop sizes for reporting outcome</span></span>
<span id="cb42-71"><a href="population-growth-conflicts-and-migrations.html#cb42-71" tabindex="-1"></a>  one <span class="ot">&lt;-</span> Ne</span>
<span id="cb42-72"><a href="population-growth-conflicts-and-migrations.html#cb42-72" tabindex="-1"></a>  <span class="co"># Update population sizes using a binomial</span></span>
<span id="cb42-73"><a href="population-growth-conflicts-and-migrations.html#cb42-73" tabindex="-1"></a>  Ne[v] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">prob=</span><span class="fl">0.9</span>, <span class="at">size=</span>Ne[v])</span>
<span id="cb42-74"><a href="population-growth-conflicts-and-migrations.html#cb42-74" tabindex="-1"></a>  Ne[l] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">prob=</span><span class="fl">0.4</span>, <span class="at">size=</span>Ne[l])</span>
<span id="cb42-75"><a href="population-growth-conflicts-and-migrations.html#cb42-75" tabindex="-1"></a>  <span class="fu">print</span>(</span>
<span id="cb42-76"><a href="population-growth-conflicts-and-migrations.html#cb42-76" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">&quot;victory&quot;</span>, v, <span class="st">&quot;(&quot;</span>, one[v], <span class="st">&quot;-&quot;</span>, Ne[v],<span class="st">&quot;) over&quot;</span>, l, </span>
<span id="cb42-77"><a href="population-growth-conflicts-and-migrations.html#cb42-77" tabindex="-1"></a>          <span class="st">&quot;(&quot;</span>,one[l],<span class="st">&quot;-&quot;</span>,Ne[l],<span class="st">&quot;), total of: &quot;</span>, (one[v]<span class="sc">-</span>Ne[v]) <span class="sc">+</span> (one[l]<span class="sc">-</span>Ne[l]), <span class="st">&quot;people&quot;</span>))</span>
<span id="cb42-78"><a href="population-growth-conflicts-and-migrations.html#cb42-78" tabindex="-1"></a>  <span class="fu">return</span>(Ne)</span>
<span id="cb42-79"><a href="population-growth-conflicts-and-migrations.html#cb42-79" tabindex="-1"></a>}   </span>
<span id="cb42-80"><a href="population-growth-conflicts-and-migrations.html#cb42-80" tabindex="-1"></a></span>
<span id="cb42-81"><a href="population-growth-conflicts-and-migrations.html#cb42-81" tabindex="-1"></a></span>
<span id="cb42-82"><a href="population-growth-conflicts-and-migrations.html#cb42-82" tabindex="-1"></a><span class="do">## Function 20. Model fight with better probabilities</span></span>
<span id="cb42-83"><a href="population-growth-conflicts-and-migrations.html#cb42-83" tabindex="-1"></a>fightbetterloss <span class="ot">&lt;-</span> <span class="cf">function</span>(Ne,a,b){</span>
<span id="cb42-84"><a href="population-growth-conflicts-and-migrations.html#cb42-84" tabindex="-1"></a>  <span class="cf">if</span>( <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> Ne[a]<span class="sc">/</span>(Ne[a] <span class="sc">+</span> Ne[b]) ){</span>
<span id="cb42-85"><a href="population-growth-conflicts-and-migrations.html#cb42-85" tabindex="-1"></a>    v <span class="ot">&lt;-</span> a</span>
<span id="cb42-86"><a href="population-growth-conflicts-and-migrations.html#cb42-86" tabindex="-1"></a>    l <span class="ot">&lt;-</span> b</span>
<span id="cb42-87"><a href="population-growth-conflicts-and-migrations.html#cb42-87" tabindex="-1"></a>  }</span>
<span id="cb42-88"><a href="population-growth-conflicts-and-migrations.html#cb42-88" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb42-89"><a href="population-growth-conflicts-and-migrations.html#cb42-89" tabindex="-1"></a>    v <span class="ot">&lt;-</span> b</span>
<span id="cb42-90"><a href="population-growth-conflicts-and-migrations.html#cb42-90" tabindex="-1"></a>    l <span class="ot">&lt;-</span> a</span>
<span id="cb42-91"><a href="population-growth-conflicts-and-migrations.html#cb42-91" tabindex="-1"></a>  }</span>
<span id="cb42-92"><a href="population-growth-conflicts-and-migrations.html#cb42-92" tabindex="-1"></a>  one <span class="ot">&lt;-</span> Ne</span>
<span id="cb42-93"><a href="population-growth-conflicts-and-migrations.html#cb42-93" tabindex="-1"></a>  Ne[v] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">prob=</span><span class="dv">1</span> <span class="sc">-</span> Ne[l]<span class="sc">/</span>(Ne[v] <span class="sc">+</span> Ne[l]), <span class="at">size=</span>Ne[v])</span>
<span id="cb42-94"><a href="population-growth-conflicts-and-migrations.html#cb42-94" tabindex="-1"></a>  Ne[l] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">prob=</span><span class="dv">1</span> <span class="sc">-</span> Ne[v]<span class="sc">/</span>(Ne[v] <span class="sc">+</span> Ne[l]), <span class="at">size=</span>Ne[l])</span>
<span id="cb42-95"><a href="population-growth-conflicts-and-migrations.html#cb42-95" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;victory &quot;</span>, v, <span class="st">&quot;(&quot;</span>, one[v], <span class="st">&quot;-&quot;</span>, Ne[v],<span class="st">&quot;) over &quot;</span>, l,</span>
<span id="cb42-96"><a href="population-growth-conflicts-and-migrations.html#cb42-96" tabindex="-1"></a>               <span class="st">&quot; (&quot;</span>, one[l], <span class="st">&quot;-&quot;</span>, Ne[l], <span class="st">&quot;), tot: &quot;</span>, (one[v]<span class="sc">-</span>Ne[v]) <span class="sc">+</span> (one[l]<span class="sc">-</span>Ne[l]), <span class="st">&quot;losses&quot;</span>))</span>
<span id="cb42-97"><a href="population-growth-conflicts-and-migrations.html#cb42-97" tabindex="-1"></a>  <span class="fu">return</span>(Ne)</span>
<span id="cb42-98"><a href="population-growth-conflicts-and-migrations.html#cb42-98" tabindex="-1"></a>}   </span>
<span id="cb42-99"><a href="population-growth-conflicts-and-migrations.html#cb42-99" tabindex="-1"></a></span>
<span id="cb42-100"><a href="population-growth-conflicts-and-migrations.html#cb42-100" tabindex="-1"></a></span>
<span id="cb42-101"><a href="population-growth-conflicts-and-migrations.html#cb42-101" tabindex="-1"></a><span class="do">## Function 21. Draw a war symbol where two clans are fighting</span></span>
<span id="cb42-102"><a href="population-growth-conflicts-and-migrations.html#cb42-102" tabindex="-1"></a>warpoints <span class="ot">&lt;-</span> <span class="cf">function</span>(sites, a, b, Ne, <span class="at">buffersize=</span><span class="dv">300</span>, <span class="at">plot=</span>T, <span class="at">sizewar=</span><span class="dv">2</span>){</span>
<span id="cb42-103"><a href="population-growth-conflicts-and-migrations.html#cb42-103" tabindex="-1"></a>  meetpoints <span class="ot">&lt;-</span> <span class="fu">crop</span>(</span>
<span id="cb42-104"><a href="population-growth-conflicts-and-migrations.html#cb42-104" tabindex="-1"></a>    <span class="fu">buffer</span>(sites[a], <span class="dv">1</span><span class="sc">+</span>Ne[a] <span class="sc">*</span> buffersize),</span>
<span id="cb42-105"><a href="population-growth-conflicts-and-migrations.html#cb42-105" tabindex="-1"></a>    <span class="fu">buffer</span>(sites[b], <span class="dv">1</span><span class="sc">+</span>Ne[b] <span class="sc">*</span> buffersize)</span>
<span id="cb42-106"><a href="population-growth-conflicts-and-migrations.html#cb42-106" tabindex="-1"></a>  )</span>
<span id="cb42-107"><a href="population-growth-conflicts-and-migrations.html#cb42-107" tabindex="-1"></a>  <span class="cf">if</span>( <span class="fu">length</span>(meetpoints)<span class="sc">&gt;</span><span class="dv">0</span> ){</span>
<span id="cb42-108"><a href="population-growth-conflicts-and-migrations.html#cb42-108" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">spatSample</span>(meetpoints, <span class="dv">1</span>)</span>
<span id="cb42-109"><a href="population-growth-conflicts-and-migrations.html#cb42-109" tabindex="-1"></a>    <span class="cf">if</span>(plot <span class="sc">&amp;</span> <span class="fu">length</span>(p)<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb42-110"><a href="population-growth-conflicts-and-migrations.html#cb42-110" tabindex="-1"></a>      <span class="fu">plot</span>(p, <span class="at">add=</span>T, <span class="at">bg=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch=</span><span class="st">&quot;🔥&quot;</span>, <span class="at">cex=</span>sizewar,</span>
<span id="cb42-111"><a href="population-growth-conflicts-and-migrations.html#cb42-111" tabindex="-1"></a>           <span class="at">col=</span><span class="fu">adjustcolor</span>(<span class="st">&quot;yellow&quot;</span>, <span class="fl">0.1</span>))</span>
<span id="cb42-112"><a href="population-growth-conflicts-and-migrations.html#cb42-112" tabindex="-1"></a>      <span class="fu">plot</span>(p, <span class="at">add=</span>T, <span class="at">bg=</span><span class="st">&quot;yellow&quot;</span>, <span class="at">pch=</span><span class="st">&quot;⚔️&quot;</span> ,<span class="at">cex=</span>sizewar)</span>
<span id="cb42-113"><a href="population-growth-conflicts-and-migrations.html#cb42-113" tabindex="-1"></a>    }</span>
<span id="cb42-114"><a href="population-growth-conflicts-and-migrations.html#cb42-114" tabindex="-1"></a>    <span class="fu">return</span>(p)</span>
<span id="cb42-115"><a href="population-growth-conflicts-and-migrations.html#cb42-115" tabindex="-1"></a>  }</span>
<span id="cb42-116"><a href="population-growth-conflicts-and-migrations.html#cb42-116" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">return</span>(<span class="cn">NULL</span>)</span>
<span id="cb42-117"><a href="population-growth-conflicts-and-migrations.html#cb42-117" tabindex="-1"></a>}</span>
<span id="cb42-118"><a href="population-growth-conflicts-and-migrations.html#cb42-118" tabindex="-1"></a></span>
<span id="cb42-119"><a href="population-growth-conflicts-and-migrations.html#cb42-119" tabindex="-1"></a></span>
<span id="cb42-120"><a href="population-growth-conflicts-and-migrations.html#cb42-120" tabindex="-1"></a></span>
<span id="cb42-121"><a href="population-growth-conflicts-and-migrations.html#cb42-121" tabindex="-1"></a><span class="do">## Function 22. Run simulation</span></span>
<span id="cb42-122"><a href="population-growth-conflicts-and-migrations.html#cb42-122" tabindex="-1"></a>run_simulation <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">cultures=</span><span class="cn">NULL</span>,</span>
<span id="cb42-123"><a href="population-growth-conflicts-and-migrations.html#cb42-123" tabindex="-1"></a>                           <span class="at">viable=</span><span class="cn">NULL</span>,</span>
<span id="cb42-124"><a href="population-growth-conflicts-and-migrations.html#cb42-124" tabindex="-1"></a>                           <span class="at">sites=</span><span class="cn">NULL</span>,</span>
<span id="cb42-125"><a href="population-growth-conflicts-and-migrations.html#cb42-125" tabindex="-1"></a>                           <span class="at">dem=</span><span class="cn">NULL</span>,</span>
<span id="cb42-126"><a href="population-growth-conflicts-and-migrations.html#cb42-126" tabindex="-1"></a>                           <span class="at">ressources=</span><span class="cn">NULL</span>,</span>
<span id="cb42-127"><a href="population-growth-conflicts-and-migrations.html#cb42-127" tabindex="-1"></a>                           <span class="at">water=</span><span class="cn">NULL</span>,</span>
<span id="cb42-128"><a href="population-growth-conflicts-and-migrations.html#cb42-128" tabindex="-1"></a>                           <span class="at">foldervid=</span><span class="st">&quot;pathtofinal&quot;</span>,</span>
<span id="cb42-129"><a href="population-growth-conflicts-and-migrations.html#cb42-129" tabindex="-1"></a>                           <span class="at">visu=</span><span class="cn">FALSE</span>,</span>
<span id="cb42-130"><a href="population-growth-conflicts-and-migrations.html#cb42-130" tabindex="-1"></a>                           <span class="at">visumin=</span><span class="cn">TRUE</span>,</span>
<span id="cb42-131"><a href="population-growth-conflicts-and-migrations.html#cb42-131" tabindex="-1"></a>                           <span class="at">ts=</span><span class="dv">20000</span>,</span>
<span id="cb42-132"><a href="population-growth-conflicts-and-migrations.html#cb42-132" tabindex="-1"></a>                           <span class="at">Kbase=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">35</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">120</span>),</span>
<span id="cb42-133"><a href="population-growth-conflicts-and-migrations.html#cb42-133" tabindex="-1"></a>                           <span class="at">cul_ext=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">7</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">6</span>),</span>
<span id="cb42-134"><a href="population-growth-conflicts-and-migrations.html#cb42-134" tabindex="-1"></a>                           <span class="at">penal_cul=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="dv">4</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="dv">5</span>),</span>
<span id="cb42-135"><a href="population-growth-conflicts-and-migrations.html#cb42-135" tabindex="-1"></a>                           <span class="at">prob_birth=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.3</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.5</span>),</span>
<span id="cb42-136"><a href="population-growth-conflicts-and-migrations.html#cb42-136" tabindex="-1"></a>                           <span class="at">prob_survive=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.8</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.6</span>),</span>
<span id="cb42-137"><a href="population-growth-conflicts-and-migrations.html#cb42-137" tabindex="-1"></a>                           <span class="at">prob_split=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span> .<span class="dv">2</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.6</span>),</span>
<span id="cb42-138"><a href="population-growth-conflicts-and-migrations.html#cb42-138" tabindex="-1"></a>                           <span class="at">prob_move=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span><span class="fl">0.2</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span><span class="fl">0.1</span>),</span>
<span id="cb42-139"><a href="population-growth-conflicts-and-migrations.html#cb42-139" tabindex="-1"></a>                           <span class="at">minimals=</span><span class="fu">c</span>(<span class="st">&quot;HG&quot;</span><span class="ot">=</span>.<span class="dv">14</span>, <span class="st">&quot;F&quot;</span><span class="ot">=</span>.<span class="dv">20</span>), </span>
<span id="cb42-140"><a href="population-growth-conflicts-and-migrations.html#cb42-140" tabindex="-1"></a>                           <span class="at">bufferatack=</span><span class="dv">400</span>,</span>
<span id="cb42-141"><a href="population-growth-conflicts-and-migrations.html#cb42-141" tabindex="-1"></a>                           <span class="at">buffersettl=</span><span class="dv">2000</span>,</span>
<span id="cb42-142"><a href="population-growth-conflicts-and-migrations.html#cb42-142" tabindex="-1"></a>                           <span class="at">Nts=</span><span class="cn">NULL</span>,</span>
<span id="cb42-143"><a href="population-growth-conflicts-and-migrations.html#cb42-143" tabindex="-1"></a>                           <span class="at">Ips=</span><span class="cn">NULL</span></span>
<span id="cb42-144"><a href="population-growth-conflicts-and-migrations.html#cb42-144" tabindex="-1"></a>){</span>
<span id="cb42-145"><a href="population-growth-conflicts-and-migrations.html#cb42-145" tabindex="-1"></a>  <span class="do">## Run stochastic process  </span></span>
<span id="cb42-146"><a href="population-growth-conflicts-and-migrations.html#cb42-146" tabindex="-1"></a>  </span>
<span id="cb42-147"><a href="population-growth-conflicts-and-migrations.html#cb42-147" tabindex="-1"></a>  Ks <span class="ot">&lt;-</span> sites<span class="sc">$</span>Ks</span>
<span id="cb42-148"><a href="population-growth-conflicts-and-migrations.html#cb42-148" tabindex="-1"></a>  cultures <span class="ot">&lt;-</span> sites<span class="sc">$</span>culture</span>
<span id="cb42-149"><a href="population-growth-conflicts-and-migrations.html#cb42-149" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.null</span>(Nts)){ </span>
<span id="cb42-150"><a href="population-growth-conflicts-and-migrations.html#cb42-150" tabindex="-1"></a>    INs <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">runif</span>(<span class="fu">length</span>(sites), <span class="fl">0.85</span>, <span class="fl">0.95</span>) <span class="sc">*</span> sites<span class="sc">$</span>Ks) <span class="co">#Population size at initialisation</span></span>
<span id="cb42-151"><a href="population-growth-conflicts-and-migrations.html#cb42-151" tabindex="-1"></a>    Ips <span class="ot">&lt;-</span> <span class="fu">lapply</span>(INs, initpopstruc) <span class="co">#initialise population structure for all sites</span></span>
<span id="cb42-152"><a href="population-growth-conflicts-and-migrations.html#cb42-152" tabindex="-1"></a>    Nts <span class="ot">&lt;-</span> <span class="fu">initlistsites</span>(Ips, <span class="at">ts=</span>ts)</span>
<span id="cb42-153"><a href="population-growth-conflicts-and-migrations.html#cb42-153" tabindex="-1"></a>    frame <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb42-154"><a href="population-growth-conflicts-and-migrations.html#cb42-154" tabindex="-1"></a>    mint <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb42-155"><a href="population-growth-conflicts-and-migrations.html#cb42-155" tabindex="-1"></a>  } <span class="cf">else</span> {<span class="do">##should check and test howto start back a simulation</span></span>
<span id="cb42-156"><a href="population-growth-conflicts-and-migrations.html#cb42-156" tabindex="-1"></a>    mint <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Nts) </span>
<span id="cb42-157"><a href="population-growth-conflicts-and-migrations.html#cb42-157" tabindex="-1"></a>    frame <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Nts) </span>
<span id="cb42-158"><a href="population-growth-conflicts-and-migrations.html#cb42-158" tabindex="-1"></a>  }</span>
<span id="cb42-159"><a href="population-growth-conflicts-and-migrations.html#cb42-159" tabindex="-1"></a>  </span>
<span id="cb42-160"><a href="population-growth-conflicts-and-migrations.html#cb42-160" tabindex="-1"></a>  <span class="do">### visualisation =====</span></span>
<span id="cb42-161"><a href="population-growth-conflicts-and-migrations.html#cb42-161" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(foldervid) <span class="sc">&amp;</span> visu){</span>
<span id="cb42-162"><a href="population-growth-conflicts-and-migrations.html#cb42-162" tabindex="-1"></a>    <span class="fu">dir.create</span>(foldervid)</span>
<span id="cb42-163"><a href="population-growth-conflicts-and-migrations.html#cb42-163" tabindex="-1"></a>  }</span>
<span id="cb42-164"><a href="population-growth-conflicts-and-migrations.html#cb42-164" tabindex="-1"></a>  <span class="do">###</span></span>
<span id="cb42-165"><a href="population-growth-conflicts-and-migrations.html#cb42-165" tabindex="-1"></a>  </span>
<span id="cb42-166"><a href="population-growth-conflicts-and-migrations.html#cb42-166" tabindex="-1"></a>  warcasualties <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;integer&quot;</span>, ts)</span>
<span id="cb42-167"><a href="population-growth-conflicts-and-migrations.html#cb42-167" tabindex="-1"></a>  </span>
<span id="cb42-168"><a href="population-growth-conflicts-and-migrations.html#cb42-168" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(ts<span class="sc">+</span><span class="dv">1</span>)){</span>
<span id="cb42-169"><a href="population-growth-conflicts-and-migrations.html#cb42-169" tabindex="-1"></a>    countcult <span class="ot">&lt;-</span> <span class="fu">table</span>(sites<span class="sc">$</span>culture[Nts[i<span class="dv">-1</span>, ] <span class="sc">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb42-170"><a href="population-growth-conflicts-and-migrations.html#cb42-170" tabindex="-1"></a>    <span class="cf">if</span> ( <span class="fu">length</span>(countcult) <span class="sc">!=</span> <span class="dv">2</span> ) {</span>
<span id="cb42-171"><a href="population-growth-conflicts-and-migrations.html#cb42-171" tabindex="-1"></a>      <span class="fu">return</span>(</span>
<span id="cb42-172"><a href="population-growth-conflicts-and-migrations.html#cb42-172" tabindex="-1"></a>        <span class="fu">list</span>(<span class="at">Nts=</span>Nts[,<span class="dv">1</span><span class="sc">:</span>i], </span>
<span id="cb42-173"><a href="population-growth-conflicts-and-migrations.html#cb42-173" tabindex="-1"></a>             <span class="at">warcasualties=</span>warcasualties[<span class="dv">1</span><span class="sc">:</span>i],</span>
<span id="cb42-174"><a href="population-growth-conflicts-and-migrations.html#cb42-174" tabindex="-1"></a>             <span class="at">Ips=</span>Ips,</span>
<span id="cb42-175"><a href="population-growth-conflicts-and-migrations.html#cb42-175" tabindex="-1"></a>             <span class="at">sites=</span>sites</span>
<span id="cb42-176"><a href="population-growth-conflicts-and-migrations.html#cb42-176" tabindex="-1"></a>        )</span>
<span id="cb42-177"><a href="population-growth-conflicts-and-migrations.html#cb42-177" tabindex="-1"></a>      )</span>
<span id="cb42-178"><a href="population-growth-conflicts-and-migrations.html#cb42-178" tabindex="-1"></a>    }</span>
<span id="cb42-179"><a href="population-growth-conflicts-and-migrations.html#cb42-179" tabindex="-1"></a>    <span class="fu">print</span>(</span>
<span id="cb42-180"><a href="population-growth-conflicts-and-migrations.html#cb42-180" tabindex="-1"></a>      <span class="fu">paste</span>(<span class="st">&quot;year&quot;</span>, i, <span class="st">&quot;total&quot;</span>, <span class="fu">sum</span>(<span class="fu">sapply</span>(Ips,nrow)),</span>
<span id="cb42-181"><a href="population-growth-conflicts-and-migrations.html#cb42-181" tabindex="-1"></a>            <span class="st">&quot;with&quot;</span>, <span class="fu">length</span>(sites), <span class="st">&quot;sites (&quot;</span>, </span>
<span id="cb42-182"><a href="population-growth-conflicts-and-migrations.html#cb42-182" tabindex="-1"></a>            <span class="fu">paste0</span>(<span class="fu">paste</span>(<span class="fu">names</span>(countcult), countcult, <span class="at">sep=</span><span class="st">&quot;:&quot;</span>), <span class="at">collapse=</span><span class="st">&quot;,&quot;</span>), <span class="st">&quot;)&quot;</span>))</span>
<span id="cb42-183"><a href="population-growth-conflicts-and-migrations.html#cb42-183" tabindex="-1"></a>    <span class="cf">if</span> (visumin){</span>
<span id="cb42-184"><a href="population-growth-conflicts-and-migrations.html#cb42-184" tabindex="-1"></a>      <span class="do">### visualisation =====</span></span>
<span id="cb42-185"><a href="population-growth-conflicts-and-migrations.html#cb42-185" tabindex="-1"></a>      frame <span class="ot">&lt;-</span> frame<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb42-186"><a href="population-growth-conflicts-and-migrations.html#cb42-186" tabindex="-1"></a>      filename <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;map_%06d.png&quot;</span>, frame)</span>
<span id="cb42-187"><a href="population-growth-conflicts-and-migrations.html#cb42-187" tabindex="-1"></a>      <span class="fu">png</span>(<span class="fu">file.path</span>(foldervid,filename), <span class="at">width=</span><span class="dv">800</span>, <span class="at">height=</span><span class="dv">800</span>, <span class="at">pointsize=</span><span class="dv">20</span>)</span>
<span id="cb42-188"><a href="population-growth-conflicts-and-migrations.html#cb42-188" tabindex="-1"></a>      <span class="fu">plotMap</span>(dem, water, <span class="fu">paste0</span>(<span class="st">&quot;year &quot;</span>,i))</span>
<span id="cb42-189"><a href="population-growth-conflicts-and-migrations.html#cb42-189" tabindex="-1"></a>      <span class="do">########</span></span>
<span id="cb42-190"><a href="population-growth-conflicts-and-migrations.html#cb42-190" tabindex="-1"></a>    }</span>
<span id="cb42-191"><a href="population-growth-conflicts-and-migrations.html#cb42-191" tabindex="-1"></a>    inactives <span class="ot">&lt;-</span> (Nts[i<span class="dv">-1</span>,]<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb42-192"><a href="population-growth-conflicts-and-migrations.html#cb42-192" tabindex="-1"></a>    <span class="cf">for</span> ( s <span class="cf">in</span> <span class="fu">sample</span>(<span class="fu">seq_along</span>(sites)[<span class="sc">!</span>inactives]) ){</span>
<span id="cb42-193"><a href="population-growth-conflicts-and-migrations.html#cb42-193" tabindex="-1"></a>      <span class="cf">if</span> ( visu ) {</span>
<span id="cb42-194"><a href="population-growth-conflicts-and-migrations.html#cb42-194" tabindex="-1"></a>        <span class="do">### visualisation =====</span></span>
<span id="cb42-195"><a href="population-growth-conflicts-and-migrations.html#cb42-195" tabindex="-1"></a>        frame <span class="ot">&lt;-</span> frame<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb42-196"><a href="population-growth-conflicts-and-migrations.html#cb42-196" tabindex="-1"></a>        filename <span class="ot">&lt;-</span> <span class="fu">sprintf</span>(<span class="st">&quot;map_%08d.png&quot;</span>, frame)</span>
<span id="cb42-197"><a href="population-growth-conflicts-and-migrations.html#cb42-197" tabindex="-1"></a>        <span class="fu">png</span>(<span class="fu">file.path</span>(foldervid,filename), <span class="at">width=</span><span class="dv">800</span>, <span class="at">height=</span><span class="dv">800</span>, <span class="at">pointsize=</span><span class="dv">20</span>)</span>
<span id="cb42-198"><a href="population-growth-conflicts-and-migrations.html#cb42-198" tabindex="-1"></a>        <span class="fu">plotMap</span>(dem,water,<span class="fu">paste0</span>(<span class="st">&quot;year &quot;</span>, i))</span>
<span id="cb42-199"><a href="population-growth-conflicts-and-migrations.html#cb42-199" tabindex="-1"></a>        <span class="do">########</span></span>
<span id="cb42-200"><a href="population-growth-conflicts-and-migrations.html#cb42-200" tabindex="-1"></a>      }</span>
<span id="cb42-201"><a href="population-growth-conflicts-and-migrations.html#cb42-201" tabindex="-1"></a>      </span>
<span id="cb42-202"><a href="population-growth-conflicts-and-migrations.html#cb42-202" tabindex="-1"></a>      city <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb42-203"><a href="population-growth-conflicts-and-migrations.html#cb42-203" tabindex="-1"></a>      Ips[[s]] <span class="ot">&lt;-</span> <span class="fu">Gpd</span>( <span class="co">#compute new population for the sites</span></span>
<span id="cb42-204"><a href="population-growth-conflicts-and-migrations.html#cb42-204" tabindex="-1"></a>        Ips[[s]], <span class="at">K =</span> Ks[[s]],</span>
<span id="cb42-205"><a href="population-growth-conflicts-and-migrations.html#cb42-205" tabindex="-1"></a>        <span class="at">p_offspring =</span> prob_birth[sites<span class="sc">$</span>culture[s]],</span>
<span id="cb42-206"><a href="population-growth-conflicts-and-migrations.html#cb42-206" tabindex="-1"></a>        <span class="at">prob =</span> prob_survive[sites<span class="sc">$</span>culture[s]]</span>
<span id="cb42-207"><a href="population-growth-conflicts-and-migrations.html#cb42-207" tabindex="-1"></a>      )</span>
<span id="cb42-208"><a href="population-growth-conflicts-and-migrations.html#cb42-208" tabindex="-1"></a>      newN <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Ips[[s]]) <span class="co">#count population size</span></span>
<span id="cb42-209"><a href="population-growth-conflicts-and-migrations.html#cb42-209" tabindex="-1"></a>      </span>
<span id="cb42-210"><a href="population-growth-conflicts-and-migrations.html#cb42-210" tabindex="-1"></a>      <span class="cf">if</span>(newN <span class="sc">&gt;=</span> (Ks[[s]])){ <span class="co">#if new population is more than carrying capacity: migration scenario</span></span>
<span id="cb42-211"><a href="population-growth-conflicts-and-migrations.html#cb42-211" tabindex="-1"></a>        migrants <span class="ot">&lt;-</span> newN <span class="sc">-</span> <span class="fu">round</span>(Ks[[s]]<span class="sc">*</span><span class="fl">0.9</span>)</span>
<span id="cb42-212"><a href="population-growth-conflicts-and-migrations.html#cb42-212" tabindex="-1"></a>        <span class="do">##Creation of new city</span></span>
<span id="cb42-213"><a href="population-growth-conflicts-and-migrations.html#cb42-213" tabindex="-1"></a>        new_site <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb42-214"><a href="population-growth-conflicts-and-migrations.html#cb42-214" tabindex="-1"></a>        <span class="co">#if(sites$culture[s]==&quot;F&quot;)print(paste(&quot;possib&quot;,migrants, (minimals[sites$culture[s]]*sites$Ks[s])))</span></span>
<span id="cb42-215"><a href="population-growth-conflicts-and-migrations.html#cb42-215" tabindex="-1"></a>        tmp <span class="ot">&lt;-</span> Nts[i<span class="dv">-1</span>,]</span>
<span id="cb42-216"><a href="population-growth-conflicts-and-migrations.html#cb42-216" tabindex="-1"></a>        tmp[Nts[i,] <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> Nts[i, Nts[i,] <span class="sc">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb42-217"><a href="population-growth-conflicts-and-migrations.html#cb42-217" tabindex="-1"></a>        <span class="co">#tmp=tmp+sqrt(sites$Ks)</span></span>
<span id="cb42-218"><a href="population-growth-conflicts-and-migrations.html#cb42-218" tabindex="-1"></a>        havemoved <span class="ot">&lt;-</span> F</span>
<span id="cb42-219"><a href="population-growth-conflicts-and-migrations.html#cb42-219" tabindex="-1"></a>        </span>
<span id="cb42-220"><a href="population-growth-conflicts-and-migrations.html#cb42-220" tabindex="-1"></a>        <span class="cf">if</span> (migrants <span class="sc">&gt;=</span> (minimals[sites<span class="sc">$</span>culture[s]]<span class="sc">*</span>sites<span class="sc">$</span>Ks[s]) <span class="sc">&amp;</span> <span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">&lt;</span>prob_split[sites<span class="sc">$</span>culture[s]] ){</span>
<span id="cb42-221"><a href="population-growth-conflicts-and-migrations.html#cb42-221" tabindex="-1"></a>          <span class="co">#if supopulation &gt; 10 people, 10% chance of creation of a new city</span></span>
<span id="cb42-222"><a href="population-growth-conflicts-and-migrations.html#cb42-222" tabindex="-1"></a>          </span>
<span id="cb42-223"><a href="population-growth-conflicts-and-migrations.html#cb42-223" tabindex="-1"></a>          <span class="co">#print(paste(&quot;look for new spot for &quot;,migrants, &quot;from site&quot;,s,&quot;culture&quot;,sites$culture[s]))</span></span>
<span id="cb42-224"><a href="population-growth-conflicts-and-migrations.html#cb42-224" tabindex="-1"></a>          <span class="co">#mean of area of influence</span></span>
<span id="cb42-225"><a href="population-growth-conflicts-and-migrations.html#cb42-225" tabindex="-1"></a>          infarea <span class="ot">&lt;-</span> (<span class="fu">sqrt</span>(tmp)<span class="sc">+</span>penal_cul[cultures]) <span class="sc">*</span> buffersettl</span>
<span id="cb42-226"><a href="population-growth-conflicts-and-migrations.html#cb42-226" tabindex="-1"></a>          buffersize <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(infarea), infarea, infarea <span class="sc">*</span> <span class="fl">0.1</span>)</span>
<span id="cb42-227"><a href="population-growth-conflicts-and-migrations.html#cb42-227" tabindex="-1"></a>          buffersize[tmp<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fl">0.00001</span></span>
<span id="cb42-228"><a href="population-growth-conflicts-and-migrations.html#cb42-228" tabindex="-1"></a>          territory <span class="ot">&lt;-</span> <span class="fu">erase</span>(viable, <span class="fu">buffer</span>(sites, buffersize))</span>
<span id="cb42-229"><a href="population-growth-conflicts-and-migrations.html#cb42-229" tabindex="-1"></a>          </span>
<span id="cb42-230"><a href="population-growth-conflicts-and-migrations.html#cb42-230" tabindex="-1"></a>          <span class="cf">if</span>( <span class="fu">length</span>(territory)<span class="sc">&gt;</span><span class="dv">0</span> ){</span>
<span id="cb42-231"><a href="population-growth-conflicts-and-migrations.html#cb42-231" tabindex="-1"></a>            <span class="co">#print(paste(&quot;found new spot&quot;,migrants))</span></span>
<span id="cb42-232"><a href="population-growth-conflicts-and-migrations.html#cb42-232" tabindex="-1"></a>            </span>
<span id="cb42-233"><a href="population-growth-conflicts-and-migrations.html#cb42-233" tabindex="-1"></a>            <span class="do">##select a new site given its distance to the old one and the ressourcesource available in ressources</span></span>
<span id="cb42-234"><a href="population-growth-conflicts-and-migrations.html#cb42-234" tabindex="-1"></a>            d2 <span class="ot">&lt;-</span> <span class="fu">logisticdecay</span>(</span>
<span id="cb42-235"><a href="population-growth-conflicts-and-migrations.html#cb42-235" tabindex="-1"></a>              sites[s], dem, <span class="at">x=</span><span class="dv">20000</span><span class="sc">*</span>cul_ext[sites<span class="sc">$</span>culture[s]]</span>
<span id="cb42-236"><a href="population-growth-conflicts-and-migrations.html#cb42-236" tabindex="-1"></a>            )</span>
<span id="cb42-237"><a href="population-growth-conflicts-and-migrations.html#cb42-237" tabindex="-1"></a>            w <span class="ot">&lt;-</span> (<span class="fl">0.7</span> <span class="sc">*</span> d2 <span class="sc">+</span> <span class="fl">0.3</span><span class="sc">*</span>ressources) <span class="sc">/</span> (<span class="fl">0.7</span><span class="sc">*</span><span class="fu">minmax</span>(d2)[<span class="dv">2</span>] <span class="sc">+</span> <span class="fl">0.3</span><span class="sc">*</span><span class="fu">minmax</span>(ressources)[<span class="dv">2</span>])</span>
<span id="cb42-238"><a href="population-growth-conflicts-and-migrations.html#cb42-238" tabindex="-1"></a>            new_site <span class="ot">&lt;-</span> <span class="fu">spatSample</span>(</span>
<span id="cb42-239"><a href="population-growth-conflicts-and-migrations.html#cb42-239" tabindex="-1"></a>              <span class="at">x=</span><span class="fu">mask</span>(</span>
<span id="cb42-240"><a href="population-growth-conflicts-and-migrations.html#cb42-240" tabindex="-1"></a>                w <span class="sc">*</span> <span class="fu">logisticdecay</span>(sites[s], dem, <span class="at">k=</span><span class="fl">0.00002</span>,</span>
<span id="cb42-241"><a href="population-growth-conflicts-and-migrations.html#cb42-241" tabindex="-1"></a>                                  <span class="at">x=</span><span class="dv">20000</span><span class="sc">*</span>cul_ext[sites<span class="sc">$</span>culture[s]]),</span>
<span id="cb42-242"><a href="population-growth-conflicts-and-migrations.html#cb42-242" tabindex="-1"></a>                territory),</span>
<span id="cb42-243"><a href="population-growth-conflicts-and-migrations.html#cb42-243" tabindex="-1"></a>              <span class="at">size=</span><span class="dv">1</span>, <span class="at">method=</span><span class="st">&quot;weights&quot;</span>, <span class="at">xy=</span>T)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span>
<span id="cb42-244"><a href="population-growth-conflicts-and-migrations.html#cb42-244" tabindex="-1"></a>            new_site <span class="ot">&lt;-</span> <span class="fu">vect</span>(new_site, <span class="at">geom=</span><span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>))</span>
<span id="cb42-245"><a href="population-growth-conflicts-and-migrations.html#cb42-245" tabindex="-1"></a>            </span>
<span id="cb42-246"><a href="population-growth-conflicts-and-migrations.html#cb42-246" tabindex="-1"></a>            <span class="cf">if</span> ( <span class="fu">length</span>(new_site)<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">all</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="fu">crds</span>(new_site))) ){</span>
<span id="cb42-247"><a href="population-growth-conflicts-and-migrations.html#cb42-247" tabindex="-1"></a>              <span class="do">##add new site to site listes</span></span>
<span id="cb42-248"><a href="population-growth-conflicts-and-migrations.html#cb42-248" tabindex="-1"></a>              <span class="do">##initialise population struc of new site</span></span>
<span id="cb42-249"><a href="population-growth-conflicts-and-migrations.html#cb42-249" tabindex="-1"></a>              <span class="co">#print(paste(&quot;total sites:&quot;,length(Ips)))</span></span>
<span id="cb42-250"><a href="population-growth-conflicts-and-migrations.html#cb42-250" tabindex="-1"></a>              <span class="co">#print(paste(&quot;dim Nts:&quot;,dim(Nts)[2]))</span></span>
<span id="cb42-251"><a href="population-growth-conflicts-and-migrations.html#cb42-251" tabindex="-1"></a>              <span class="co">#print(paste(&quot;site sf Nts:&quot;,length(sites)))</span></span>
<span id="cb42-252"><a href="population-growth-conflicts-and-migrations.html#cb42-252" tabindex="-1"></a>              </span>
<span id="cb42-253"><a href="population-growth-conflicts-and-migrations.html#cb42-253" tabindex="-1"></a>              Ips[[<span class="fu">length</span>(Ips)<span class="sc">+</span><span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="fu">initpopstruc</span>(<span class="at">n=</span>migrants) <span class="co">#initialise a fake populaition, will be updated by real migrants later</span></span>
<span id="cb42-254"><a href="population-growth-conflicts-and-migrations.html#cb42-254" tabindex="-1"></a>              new_site<span class="sc">$</span>culture <span class="ot">&lt;-</span> sites<span class="sc">$</span>culture[s]</span>
<span id="cb42-255"><a href="population-growth-conflicts-and-migrations.html#cb42-255" tabindex="-1"></a>              new_site<span class="sc">$</span>Ks <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">initKs</span>(</span>
<span id="cb42-256"><a href="population-growth-conflicts-and-migrations.html#cb42-256" tabindex="-1"></a>                Kbase, <span class="at">sites=</span>new_site, ressources,</span>
<span id="cb42-257"><a href="population-growth-conflicts-and-migrations.html#cb42-257" tabindex="-1"></a>                <span class="at">sizeex=</span><span class="st">&quot;F&quot;</span>, <span class="at">rate=</span><span class="fl">0.45</span>))</span>
<span id="cb42-258"><a href="population-growth-conflicts-and-migrations.html#cb42-258" tabindex="-1"></a>              <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;new settlement (&quot;</span>, sites<span class="sc">$</span>culture[s], <span class="st">&quot;) of K &quot;</span>,</span>
<span id="cb42-259"><a href="population-growth-conflicts-and-migrations.html#cb42-259" tabindex="-1"></a>                           new_site<span class="sc">$</span>Ks, <span class="st">&quot; and pop &quot;</span>, migrants))</span>
<span id="cb42-260"><a href="population-growth-conflicts-and-migrations.html#cb42-260" tabindex="-1"></a>              </span>
<span id="cb42-261"><a href="population-growth-conflicts-and-migrations.html#cb42-261" tabindex="-1"></a>              sites <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sites, new_site)</span>
<span id="cb42-262"><a href="population-growth-conflicts-and-migrations.html#cb42-262" tabindex="-1"></a>              </span>
<span id="cb42-263"><a href="population-growth-conflicts-and-migrations.html#cb42-263" tabindex="-1"></a>              Ks[<span class="fu">length</span>(Ks)<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> new_site<span class="sc">$</span>Ks</span>
<span id="cb42-264"><a href="population-growth-conflicts-and-migrations.html#cb42-264" tabindex="-1"></a>              city <span class="ot">&lt;-</span> <span class="fu">length</span>(Ips)</span>
<span id="cb42-265"><a href="population-growth-conflicts-and-migrations.html#cb42-265" tabindex="-1"></a>              Nts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Nts, <span class="fu">rep</span>(<span class="dv">0</span>,ts<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb42-266"><a href="population-growth-conflicts-and-migrations.html#cb42-266" tabindex="-1"></a>              Nts[i, city] <span class="ot">&lt;-</span> migrants</span>
<span id="cb42-267"><a href="population-growth-conflicts-and-migrations.html#cb42-267" tabindex="-1"></a>              cultures <span class="ot">&lt;-</span> <span class="fu">c</span>(cultures, cultures[s])</span>
<span id="cb42-268"><a href="population-growth-conflicts-and-migrations.html#cb42-268" tabindex="-1"></a>              <span class="co">#print(paste(&quot;new site sf Nts:&quot;,length(sites)))</span></span>
<span id="cb42-269"><a href="population-growth-conflicts-and-migrations.html#cb42-269" tabindex="-1"></a>              <span class="co">#print(paste(&quot;new dim Nts:&quot;,dim(Nts)[2]))</span></span>
<span id="cb42-270"><a href="population-growth-conflicts-and-migrations.html#cb42-270" tabindex="-1"></a>              <span class="co">#print(paste(&quot;new total sites:&quot;,length(Ips)))</span></span>
<span id="cb42-271"><a href="population-growth-conflicts-and-migrations.html#cb42-271" tabindex="-1"></a>              havemoved <span class="ot">&lt;-</span> T</span>
<span id="cb42-272"><a href="population-growth-conflicts-and-migrations.html#cb42-272" tabindex="-1"></a>            }</span>
<span id="cb42-273"><a href="population-growth-conflicts-and-migrations.html#cb42-273" tabindex="-1"></a>          }</span>
<span id="cb42-274"><a href="population-growth-conflicts-and-migrations.html#cb42-274" tabindex="-1"></a>        }</span>
<span id="cb42-275"><a href="population-growth-conflicts-and-migrations.html#cb42-275" tabindex="-1"></a>        <span class="do">## if no creation of new city happen, there is a certain probability that people will move</span></span>
<span id="cb42-276"><a href="population-growth-conflicts-and-migrations.html#cb42-276" tabindex="-1"></a>        <span class="cf">if</span>( <span class="fu">length</span>(new_site)<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> prob_move[sites<span class="sc">$</span>culture[s]] ){</span>
<span id="cb42-277"><a href="population-growth-conflicts-and-migrations.html#cb42-277" tabindex="-1"></a>          </span>
<span id="cb42-278"><a href="population-growth-conflicts-and-migrations.html#cb42-278" tabindex="-1"></a>          <span class="co">#getj</span></span>
<span id="cb42-279"><a href="population-growth-conflicts-and-migrations.html#cb42-279" tabindex="-1"></a>          att <span class="ot">&lt;-</span> <span class="fu">extract</span>(ressources,sites)[,<span class="dv">2</span>]</span>
<span id="cb42-280"><a href="population-growth-conflicts-and-migrations.html#cb42-280" tabindex="-1"></a>          space <span class="ot">&lt;-</span> sites<span class="sc">$</span>Ks <span class="sc">-</span> (Nts[i<span class="dv">-1</span>,] <span class="sc">+</span> migrants)</span>
<span id="cb42-281"><a href="population-growth-conflicts-and-migrations.html#cb42-281" tabindex="-1"></a>          dis <span class="ot">&lt;-</span> <span class="fu">extract</span>(<span class="fu">logisticdecay</span>(sites[s], dem, <span class="at">k=</span><span class="fl">0.00002</span>, <span class="at">x=</span><span class="dv">1</span>), sites)[,<span class="dv">2</span>]</span>
<span id="cb42-282"><a href="population-growth-conflicts-and-migrations.html#cb42-282" tabindex="-1"></a>          attractivity <span class="ot">&lt;-</span> att <span class="sc">*</span> space <span class="sc">*</span> dis</span>
<span id="cb42-283"><a href="population-growth-conflicts-and-migrations.html#cb42-283" tabindex="-1"></a>          <span class="co">#attractivity=attractivity*(1+10*(sites$culture[s]==sites$culture)) #4 times more likely to go to similar culture</span></span>
<span id="cb42-284"><a href="population-growth-conflicts-and-migrations.html#cb42-284" tabindex="-1"></a>          attractivity[s] <span class="ot">&lt;-</span> <span class="fu">min</span>(attractivity)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb42-285"><a href="population-growth-conflicts-and-migrations.html#cb42-285" tabindex="-1"></a>          attractivity <span class="ot">&lt;-</span> <span class="fu">exp</span>(attractivity)<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">exp</span>(attractivity))</span>
<span id="cb42-286"><a href="population-growth-conflicts-and-migrations.html#cb42-286" tabindex="-1"></a>          attractivity[Nts[i<span class="dv">-1</span>,]<span class="sc">&lt;</span><span class="dv">10</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb42-287"><a href="population-growth-conflicts-and-migrations.html#cb42-287" tabindex="-1"></a>          attractivity[sites<span class="sc">$</span>culture<span class="sc">!=</span>sites<span class="sc">$</span>culture[s]] <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb42-288"><a href="population-growth-conflicts-and-migrations.html#cb42-288" tabindex="-1"></a>          <span class="cf">if</span>(<span class="fu">any</span>(<span class="fu">is.na</span>(attractivity))){</span>
<span id="cb42-289"><a href="population-growth-conflicts-and-migrations.html#cb42-289" tabindex="-1"></a>            <span class="fu">print</span>(attractivity)</span>
<span id="cb42-290"><a href="population-growth-conflicts-and-migrations.html#cb42-290" tabindex="-1"></a>            attractivity[<span class="fu">is.na</span>(attractivity)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb42-291"><a href="population-growth-conflicts-and-migrations.html#cb42-291" tabindex="-1"></a>          }</span>
<span id="cb42-292"><a href="population-growth-conflicts-and-migrations.html#cb42-292" tabindex="-1"></a>          </span>
<span id="cb42-293"><a href="population-growth-conflicts-and-migrations.html#cb42-293" tabindex="-1"></a>          city <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">size=</span><span class="dv">1</span>, <span class="at">x=</span><span class="fu">seq_along</span>(sites), <span class="at">prob=</span>attractivity)</span>
<span id="cb42-294"><a href="population-growth-conflicts-and-migrations.html#cb42-294" tabindex="-1"></a>          Nts[i,city] <span class="ot">&lt;-</span> Nts[i<span class="dv">-1</span>,city] <span class="sc">+</span> migrants</span>
<span id="cb42-295"><a href="population-growth-conflicts-and-migrations.html#cb42-295" tabindex="-1"></a>          <span class="fu">print</span>(<span class="fu">paste</span>(migrants, <span class="st">&quot;migrant from&quot;</span>, sites<span class="sc">$</span>culture[s],</span>
<span id="cb42-296"><a href="population-growth-conflicts-and-migrations.html#cb42-296" tabindex="-1"></a>                      <span class="st">&quot;to&quot;</span>, sites<span class="sc">$</span>culture[city]))</span>
<span id="cb42-297"><a href="population-growth-conflicts-and-migrations.html#cb42-297" tabindex="-1"></a>          havemoved <span class="ot">&lt;-</span> T</span>
<span id="cb42-298"><a href="population-growth-conflicts-and-migrations.html#cb42-298" tabindex="-1"></a>        }</span>
<span id="cb42-299"><a href="population-growth-conflicts-and-migrations.html#cb42-299" tabindex="-1"></a>        <span class="cf">if</span>( havemoved ){</span>
<span id="cb42-300"><a href="population-growth-conflicts-and-migrations.html#cb42-300" tabindex="-1"></a>          </span>
<span id="cb42-301"><a href="population-growth-conflicts-and-migrations.html#cb42-301" tabindex="-1"></a>          <span class="co">#print(paste(&quot;old spot&quot;,migrants,&quot; for &quot;,nrow(Ips[[s]])))</span></span>
<span id="cb42-302"><a href="population-growth-conflicts-and-migrations.html#cb42-302" tabindex="-1"></a>          <span class="co">#print(paste(&quot;old new spot&quot;,migrants,&quot; for &quot;,nrow(Ips[[city]])))</span></span>
<span id="cb42-303"><a href="population-growth-conflicts-and-migrations.html#cb42-303" tabindex="-1"></a>          </span>
<span id="cb42-304"><a href="population-growth-conflicts-and-migrations.html#cb42-304" tabindex="-1"></a>          <span class="co">#if(city&gt;length(Ips))print(paste(&quot;problem, migrants:&quot;,migrants))</span></span>
<span id="cb42-305"><a href="population-growth-conflicts-and-migrations.html#cb42-305" tabindex="-1"></a>          <span class="co">#print(paste(&quot;the other:&quot;,city))</span></span>
<span id="cb42-306"><a href="population-growth-conflicts-and-migrations.html#cb42-306" tabindex="-1"></a>          Ips[<span class="fu">c</span>(s,city)] <span class="ot">&lt;-</span> <span class="fu">changePopSize</span>(</span>
<span id="cb42-307"><a href="population-growth-conflicts-and-migrations.html#cb42-307" tabindex="-1"></a>            <span class="at">loosingPop=</span>Ips[[s]], <span class="at">winingPop=</span>Ips[[city]], <span class="at">size=</span>migrants</span>
<span id="cb42-308"><a href="population-growth-conflicts-and-migrations.html#cb42-308" tabindex="-1"></a>          )</span>
<span id="cb42-309"><a href="population-growth-conflicts-and-migrations.html#cb42-309" tabindex="-1"></a>          newN <span class="ot">&lt;-</span> newN <span class="sc">-</span> migrants</span>
<span id="cb42-310"><a href="population-growth-conflicts-and-migrations.html#cb42-310" tabindex="-1"></a>          <span class="co">#print(paste(&quot;loosing &quot;,newN,&quot; vs &quot;,nrow(Ips[[s]])))</span></span>
<span id="cb42-311"><a href="population-growth-conflicts-and-migrations.html#cb42-311" tabindex="-1"></a>          <span class="co">#print(paste(&quot;wining &quot;,newN,&quot; vs &quot;,nrow(Ips[[city]])))</span></span>
<span id="cb42-312"><a href="population-growth-conflicts-and-migrations.html#cb42-312" tabindex="-1"></a>        }</span>
<span id="cb42-313"><a href="population-growth-conflicts-and-migrations.html#cb42-313" tabindex="-1"></a>        </span>
<span id="cb42-314"><a href="population-growth-conflicts-and-migrations.html#cb42-314" tabindex="-1"></a>      }</span>
<span id="cb42-315"><a href="population-growth-conflicts-and-migrations.html#cb42-315" tabindex="-1"></a>      Nts[i,s] <span class="ot">&lt;-</span> newN</span>
<span id="cb42-316"><a href="population-growth-conflicts-and-migrations.html#cb42-316" tabindex="-1"></a>      </span>
<span id="cb42-317"><a href="population-growth-conflicts-and-migrations.html#cb42-317" tabindex="-1"></a>      <span class="cf">if</span> (visu){</span>
<span id="cb42-318"><a href="population-growth-conflicts-and-migrations.html#cb42-318" tabindex="-1"></a>        <span class="do">###visualisation=========</span></span>
<span id="cb42-319"><a href="population-growth-conflicts-and-migrations.html#cb42-319" tabindex="-1"></a>        sitescols <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(sites))</span>
<span id="cb42-320"><a href="population-growth-conflicts-and-migrations.html#cb42-320" tabindex="-1"></a>        siteslwd <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(sites))</span>
<span id="cb42-321"><a href="population-growth-conflicts-and-migrations.html#cb42-321" tabindex="-1"></a>        ii<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb42-322"><a href="population-growth-conflicts-and-migrations.html#cb42-322" tabindex="-1"></a>        <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(city)){</span>
<span id="cb42-323"><a href="population-growth-conflicts-and-migrations.html#cb42-323" tabindex="-1"></a>          sitescols[s] <span class="ot">&lt;-</span> <span class="st">&quot;yellow&quot;</span></span>
<span id="cb42-324"><a href="population-growth-conflicts-and-migrations.html#cb42-324" tabindex="-1"></a>          sitescols[city] <span class="ot">&lt;-</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb42-325"><a href="population-growth-conflicts-and-migrations.html#cb42-325" tabindex="-1"></a>          siteslwd[s] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb42-326"><a href="population-growth-conflicts-and-migrations.html#cb42-326" tabindex="-1"></a>          siteslwd[city] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb42-327"><a href="population-growth-conflicts-and-migrations.html#cb42-327" tabindex="-1"></a>          ii <span class="ot">&lt;-</span> <span class="fu">st_cast</span>(<span class="fu">st_combine</span>(<span class="fu">st_as_sf</span>(sites[<span class="fu">c</span>(s, city)])), <span class="st">&quot;LINESTRING&quot;</span>)</span>
<span id="cb42-328"><a href="population-growth-conflicts-and-migrations.html#cb42-328" tabindex="-1"></a>        }</span>
<span id="cb42-329"><a href="population-growth-conflicts-and-migrations.html#cb42-329" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(ii)){</span>
<span id="cb42-330"><a href="population-growth-conflicts-and-migrations.html#cb42-330" tabindex="-1"></a>          <span class="fu">plot</span>(ii ,<span class="at">add=</span>T)</span>
<span id="cb42-331"><a href="population-growth-conflicts-and-migrations.html#cb42-331" tabindex="-1"></a>        }</span>
<span id="cb42-332"><a href="population-growth-conflicts-and-migrations.html#cb42-332" tabindex="-1"></a>        tmp <span class="ot">&lt;-</span> Nts[i<span class="dv">-1</span>,]</span>
<span id="cb42-333"><a href="population-growth-conflicts-and-migrations.html#cb42-333" tabindex="-1"></a>        tmp[Nts[i,]<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> Nts[i,Nts[i,]<span class="sc">&gt;</span><span class="dv">0</span>]</span>
<span id="cb42-334"><a href="population-growth-conflicts-and-migrations.html#cb42-334" tabindex="-1"></a>        <span class="fu">plot</span>(sites, <span class="at">cex=</span>(<span class="fu">as.integer</span>(Nts[i,]<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">*</span> <span class="fl">0.3</span> <span class="sc">+</span> Nts[i,]<span class="sc">/</span><span class="dv">200</span>), </span>
<span id="cb42-335"><a href="population-growth-conflicts-and-migrations.html#cb42-335" tabindex="-1"></a>             <span class="at">pch=</span><span class="dv">21</span>, <span class="at">add=</span>T, <span class="at">bg=</span><span class="fu">rainbow</span>(<span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.6</span>)[<span class="fu">as.factor</span>(sites<span class="sc">$</span>culture)],</span>
<span id="cb42-336"><a href="population-growth-conflicts-and-migrations.html#cb42-336" tabindex="-1"></a>             <span class="at">lwd=</span>siteslwd, <span class="at">col=</span>sitescols)</span>
<span id="cb42-337"><a href="population-growth-conflicts-and-migrations.html#cb42-337" tabindex="-1"></a>        <span class="fu">dev.off</span>()</span>
<span id="cb42-338"><a href="population-growth-conflicts-and-migrations.html#cb42-338" tabindex="-1"></a>        <span class="do">###=======================</span></span>
<span id="cb42-339"><a href="population-growth-conflicts-and-migrations.html#cb42-339" tabindex="-1"></a>      }</span>
<span id="cb42-340"><a href="population-growth-conflicts-and-migrations.html#cb42-340" tabindex="-1"></a>    }</span>
<span id="cb42-341"><a href="population-growth-conflicts-and-migrations.html#cb42-341" tabindex="-1"></a>    <span class="cf">if</span>(visumin){</span>
<span id="cb42-342"><a href="population-growth-conflicts-and-migrations.html#cb42-342" tabindex="-1"></a>      <span class="fu">plot</span>(sites, <span class="at">cex=</span>(<span class="fu">as.integer</span>(Nts[i,]<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">*</span> <span class="fl">0.3</span> <span class="sc">+</span> Nts[i,]<span class="sc">/</span><span class="dv">200</span>),</span>
<span id="cb42-343"><a href="population-growth-conflicts-and-migrations.html#cb42-343" tabindex="-1"></a>           <span class="at">pch=</span><span class="dv">21</span>, <span class="at">add=</span>T, <span class="at">bg=</span><span class="fu">rainbow</span>(<span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.6</span>)[<span class="fu">as.factor</span>(sites<span class="sc">$</span>culture)])</span>
<span id="cb42-344"><a href="population-growth-conflicts-and-migrations.html#cb42-344" tabindex="-1"></a>    }</span>
<span id="cb42-345"><a href="population-growth-conflicts-and-migrations.html#cb42-345" tabindex="-1"></a>    potentialfighters <span class="ot">&lt;-</span> <span class="fu">which</span>(sites<span class="sc">$</span>culture<span class="sc">==</span><span class="st">&quot;F&quot;</span> <span class="sc">&amp;</span> Nts[i,]<span class="sc">&gt;</span><span class="dv">50</span>)</span>
<span id="cb42-346"><a href="population-growth-conflicts-and-migrations.html#cb42-346" tabindex="-1"></a>    <span class="cf">for</span> (s <span class="cf">in</span> <span class="fu">sample</span>(<span class="at">x=</span>potentialfighters, <span class="at">size=</span><span class="fu">round</span>(<span class="fu">length</span>(potentialfighters)<span class="sc">*</span><span class="fl">0.1</span>))){</span>
<span id="cb42-347"><a href="population-growth-conflicts-and-migrations.html#cb42-347" tabindex="-1"></a>      buff <span class="ot">&lt;-</span> bufferatack</span>
<span id="cb42-348"><a href="population-growth-conflicts-and-migrations.html#cb42-348" tabindex="-1"></a>      potentialvictims <span class="ot">&lt;-</span> <span class="fu">which</span>(sites<span class="sc">$</span>culture <span class="sc">!=</span>sites<span class="sc">$</span>culture[s] <span class="sc">&amp;</span> Nts[i,]<span class="sc">&gt;</span><span class="dv">0</span>) </span>
<span id="cb42-349"><a href="population-growth-conflicts-and-migrations.html#cb42-349" tabindex="-1"></a>      clash <span class="ot">&lt;-</span> <span class="fu">whotouch</span>(s, sites, <span class="at">Ne=</span>Nts[i,], <span class="at">buffersize=</span>buff)</span>
<span id="cb42-350"><a href="population-growth-conflicts-and-migrations.html#cb42-350" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">length</span>(clash)<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(clash)){</span>
<span id="cb42-351"><a href="population-growth-conflicts-and-migrations.html#cb42-351" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">length</span>(clash) <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb42-352"><a href="population-growth-conflicts-and-migrations.html#cb42-352" tabindex="-1"></a>          attack <span class="ot">&lt;-</span> clash</span>
<span id="cb42-353"><a href="population-growth-conflicts-and-migrations.html#cb42-353" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb42-354"><a href="population-growth-conflicts-and-migrations.html#cb42-354" tabindex="-1"></a>          attack <span class="ot">&lt;-</span> <span class="fu">sample</span>(clash, <span class="dv">1</span>)</span>
<span id="cb42-355"><a href="population-growth-conflicts-and-migrations.html#cb42-355" tabindex="-1"></a>        }</span>
<span id="cb42-356"><a href="population-growth-conflicts-and-migrations.html#cb42-356" tabindex="-1"></a>        newns <span class="ot">&lt;-</span> <span class="fu">fightbetterloss</span>(<span class="at">Ne=</span>Nts[i,], <span class="at">a=</span>s, <span class="at">b=</span>attack)</span>
<span id="cb42-357"><a href="population-growth-conflicts-and-migrations.html#cb42-357" tabindex="-1"></a>        casualties <span class="ot">&lt;-</span> <span class="fu">sum</span>(Nts[i, <span class="fu">c</span>(s,attack)] <span class="sc">-</span> newns[<span class="fu">c</span>(s,attack)])</span>
<span id="cb42-358"><a href="population-growth-conflicts-and-migrations.html#cb42-358" tabindex="-1"></a>        warcasualties[i] <span class="ot">&lt;-</span> casualties</span>
<span id="cb42-359"><a href="population-growth-conflicts-and-migrations.html#cb42-359" tabindex="-1"></a>        sizew <span class="ot">&lt;-</span> casualties<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">4000</span></span>
<span id="cb42-360"><a href="population-growth-conflicts-and-migrations.html#cb42-360" tabindex="-1"></a>        <span class="fu">warpoints</span>(sites, s, attack, <span class="at">Ne=</span>Nts[i,],</span>
<span id="cb42-361"><a href="population-growth-conflicts-and-migrations.html#cb42-361" tabindex="-1"></a>                  <span class="at">buffersize=</span>buff, <span class="at">sizewar=</span>sizew<span class="fl">+0.5</span>)</span>
<span id="cb42-362"><a href="population-growth-conflicts-and-migrations.html#cb42-362" tabindex="-1"></a>        </span>
<span id="cb42-363"><a href="population-growth-conflicts-and-migrations.html#cb42-363" tabindex="-1"></a>        <span class="co">#effectively kill people in population (should be done taking into account age pyramid to be more realistic)</span></span>
<span id="cb42-364"><a href="population-growth-conflicts-and-migrations.html#cb42-364" tabindex="-1"></a>        Ips[[s]] <span class="ot">&lt;-</span> <span class="fu">changePopSize</span>(<span class="at">loosingPop=</span>Ips[[s]],</span>
<span id="cb42-365"><a href="population-growth-conflicts-and-migrations.html#cb42-365" tabindex="-1"></a>                                  <span class="at">size=</span>(Nts[i,s] <span class="sc">-</span> newns[s]))</span>
<span id="cb42-366"><a href="population-growth-conflicts-and-migrations.html#cb42-366" tabindex="-1"></a>        Ips[[attack]] <span class="ot">&lt;-</span> <span class="fu">changePopSize</span>(<span class="at">loosingPop=</span>Ips[[attack]],</span>
<span id="cb42-367"><a href="population-growth-conflicts-and-migrations.html#cb42-367" tabindex="-1"></a>                                       <span class="at">size=</span>(Nts[i, attack] <span class="sc">-</span> newns[attack]))</span>
<span id="cb42-368"><a href="population-growth-conflicts-and-migrations.html#cb42-368" tabindex="-1"></a>        Nts[i,] <span class="ot">&lt;-</span> newns</span>
<span id="cb42-369"><a href="population-growth-conflicts-and-migrations.html#cb42-369" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;fight : #&quot;</span>, s, <span class="st">&quot; (&quot;</span>,</span>
<span id="cb42-370"><a href="population-growth-conflicts-and-migrations.html#cb42-370" tabindex="-1"></a>                     cultures[s], <span class="st">&quot;) left with &quot;</span>, Nts[i,s],</span>
<span id="cb42-371"><a href="population-growth-conflicts-and-migrations.html#cb42-371" tabindex="-1"></a>                     <span class="st">&quot; (bef:&quot;</span>, Nts[i<span class="dv">-1</span>,s], <span class="st">&quot;) ind., attacked: #&quot;</span>, attack, <span class="st">&quot; (&quot;</span>,</span>
<span id="cb42-372"><a href="population-growth-conflicts-and-migrations.html#cb42-372" tabindex="-1"></a>                     cultures[attack], <span class="st">&quot;) left with &quot;</span>, Nts[i,attack],</span>
<span id="cb42-373"><a href="population-growth-conflicts-and-migrations.html#cb42-373" tabindex="-1"></a>                     <span class="st">&quot; (bef:&quot;</span>, Nts[i<span class="dv">-1</span>,attack],<span class="st">&quot;) ind., #death=&quot;</span>,casualties))</span>
<span id="cb42-374"><a href="population-growth-conflicts-and-migrations.html#cb42-374" tabindex="-1"></a>      }</span>
<span id="cb42-375"><a href="population-growth-conflicts-and-migrations.html#cb42-375" tabindex="-1"></a>    }</span>
<span id="cb42-376"><a href="population-growth-conflicts-and-migrations.html#cb42-376" tabindex="-1"></a>    <span class="cf">if</span>(visumin){</span>
<span id="cb42-377"><a href="population-growth-conflicts-and-migrations.html#cb42-377" tabindex="-1"></a>      <span class="fu">dev.off</span>()</span>
<span id="cb42-378"><a href="population-growth-conflicts-and-migrations.html#cb42-378" tabindex="-1"></a>    }</span>
<span id="cb42-379"><a href="population-growth-conflicts-and-migrations.html#cb42-379" tabindex="-1"></a>  }</span>
<span id="cb42-380"><a href="population-growth-conflicts-and-migrations.html#cb42-380" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">Nts=</span>Nts, <span class="at">warcasualties=</span>warcasualties, <span class="at">Ips=</span>Ips, <span class="at">sites=</span>sites))</span>
<span id="cb42-381"><a href="population-growth-conflicts-and-migrations.html#cb42-381" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>The list <code>onesimu</code> contains a few interesting info:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="population-growth-conflicts-and-migrations.html#cb43-1" tabindex="-1"></a>Nts <span class="ot">&lt;-</span> onesimu<span class="sc">$</span>Nts <span class="co"># population at each timestep</span></span>
<span id="cb43-2"><a href="population-growth-conflicts-and-migrations.html#cb43-2" tabindex="-1"></a>warcasualties <span class="ot">&lt;-</span> onesimu<span class="sc">$</span>warcasualties <span class="co">#death by war at each time step</span></span></code></pre></div>
<p>Use ressource to adjust the Ks:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="population-growth-conflicts-and-migrations.html#cb44-1" tabindex="-1"></a><span class="fu">plot</span>(sites, <span class="at">cex=</span>(<span class="dv">1</span><span class="sc">+</span>Nts[<span class="dv">1</span>,]<span class="sc">/</span><span class="dv">100</span>), <span class="at">pch=</span><span class="dv">21</span>, <span class="at">bg=</span><span class="fu">rainbow</span>(<span class="dv">2</span>, <span class="at">alpha=</span><span class="fl">0.6</span>)[<span class="fu">as.factor</span>(sites<span class="sc">$</span>culture)])</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>We look at the simulation step by stepk
Step by step to allow interaction between sites:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="population-growth-conflicts-and-migrations.html#cb45-1" tabindex="-1"></a><span class="do">## visualise trajectories for each site</span></span>
<span id="cb45-2"><a href="population-growth-conflicts-and-migrations.html#cb45-2" tabindex="-1"></a></span>
<span id="cb45-3"><a href="population-growth-conflicts-and-migrations.html#cb45-3" tabindex="-1"></a>i <span class="ot">&lt;-</span> ts</span>
<span id="cb45-4"><a href="population-growth-conflicts-and-migrations.html#cb45-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,i), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(Nts)), <span class="at">xlab=</span><span class="st">&quot;time&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;popsize&quot;</span>)</span>
<span id="cb45-5"><a href="population-growth-conflicts-and-migrations.html#cb45-5" tabindex="-1"></a><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(Nts),</span>
<span id="cb45-6"><a href="population-growth-conflicts-and-migrations.html#cb45-6" tabindex="-1"></a>       <span class="cf">function</span>(j)<span class="fu">lines</span>(Nts[,j],<span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">2</span>)[<span class="fu">as.factor</span>(sites<span class="sc">$</span>culture)[j]])</span>
<span id="cb45-7"><a href="population-growth-conflicts-and-migrations.html#cb45-7" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="_main_files/figure-html/trajpersite-1.png" width="672" /></p>
<pre><code>## [[1]]
## NULL
## 
## [[2]]
## NULL
## 
## [[3]]
## NULL
## 
## [[4]]
## NULL
## 
## [[5]]
## NULL
## 
## [[6]]
## NULL
## 
## [[7]]
## NULL
## 
## [[8]]
## NULL
## 
## [[9]]
## NULL
## 
## [[10]]
## NULL
## 
## [[11]]
## NULL
## 
## [[12]]
## NULL
## 
## [[13]]
## NULL
## 
## [[14]]
## NULL
## 
## [[15]]
## NULL
## 
## [[16]]
## NULL
## 
## [[17]]
## NULL
## 
## [[18]]
## NULL
## 
## [[19]]
## NULL
## 
## [[20]]
## NULL
## 
## [[21]]
## NULL
## 
## [[22]]
## NULL
## 
## [[23]]
## NULL
## 
## [[24]]
## NULL
## 
## [[25]]
## NULL
## 
## [[26]]
## NULL
## 
## [[27]]
## NULL
## 
## [[28]]
## NULL
## 
## [[29]]
## NULL
## 
## [[30]]
## NULL
## 
## [[31]]
## NULL
## 
## [[32]]
## NULL
## 
## [[33]]
## NULL
## 
## [[34]]
## NULL
## 
## [[35]]
## NULL
## 
## [[36]]
## NULL
## 
## [[37]]
## NULL
## 
## [[38]]
## NULL
## 
## [[39]]
## NULL
## 
## [[40]]
## NULL
## 
## [[41]]
## NULL
## 
## [[42]]
## NULL
## 
## [[43]]
## NULL
## 
## [[44]]
## NULL
## 
## [[45]]
## NULL
## 
## [[46]]
## NULL
## 
## [[47]]
## NULL</code></pre>
<p>Visualise, Record deposit and loss. for the 5 first sites (see next chapters for <code>A_rates</code>).</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="population-growth-conflicts-and-migrations.html#cb47-1" tabindex="-1"></a>alldeposit <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb47-2"><a href="population-growth-conflicts-and-migrations.html#cb47-2" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb47-3"><a href="population-growth-conflicts-and-migrations.html#cb47-3" tabindex="-1"></a>  <span class="cf">function</span>(i){</span>
<span id="cb47-4"><a href="population-growth-conflicts-and-migrations.html#cb47-4" tabindex="-1"></a>    <span class="fu">Rec_c</span>(<span class="fu">sapply</span>(Nts[,i], A_rates), <span class="at">InitBP =</span> <span class="dv">15000</span>, <span class="at">ts=</span>ts, <span class="at">r=</span><span class="fl">0.2</span>, <span class="at">max_bone_thickness=</span><span class="st">&quot;m&quot;</span>)</span>
<span id="cb47-5"><a href="population-growth-conflicts-and-migrations.html#cb47-5" tabindex="-1"></a>  }</span>
<span id="cb47-6"><a href="population-growth-conflicts-and-migrations.html#cb47-6" tabindex="-1"></a>)</span>
<span id="cb47-7"><a href="population-growth-conflicts-and-migrations.html#cb47-7" tabindex="-1"></a>maxy <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">sapply</span>(alldeposit, <span class="cf">function</span>(i)<span class="fu">max</span>(<span class="fu">apply</span>(i,<span class="dv">2</span>,sum))))</span>
<span id="cb47-8"><a href="population-growth-conflicts-and-migrations.html#cb47-8" tabindex="-1"></a></span>
<span id="cb47-9"><a href="population-growth-conflicts-and-migrations.html#cb47-9" tabindex="-1"></a>nill <span class="ot">&lt;-</span> <span class="fu">lapply</span>(alldeposit, <span class="cf">function</span>(depo)<span class="fu">barplot</span>(<span class="fu">t</span>(depo), <span class="at">col=</span><span class="fu">viridis</span>(ts<span class="sc">+</span><span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,maxy)))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-23-1.png" width="25%" /><img src="_main_files/figure-html/unnamed-chunk-23-2.png" width="25%" /><img src="_main_files/figure-html/unnamed-chunk-23-3.png" width="25%" /><img src="_main_files/figure-html/unnamed-chunk-23-4.png" width="25%" /><img src="_main_files/figure-html/unnamed-chunk-23-5.png" width="25%" /></p>
<p>Population by time and culture</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="population-growth-conflicts-and-migrations.html#cb48-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">type=</span><span class="st">&quot;n&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,i), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">max</span>(Nts)),</span>
<span id="cb48-2"><a href="population-growth-conflicts-and-migrations.html#cb48-2" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;time&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;popsize&quot;</span>)</span>
<span id="cb48-3"><a href="population-growth-conflicts-and-migrations.html#cb48-3" tabindex="-1"></a><span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(Nts),</span>
<span id="cb48-4"><a href="population-growth-conflicts-and-migrations.html#cb48-4" tabindex="-1"></a>       <span class="cf">function</span>(i)<span class="fu">lines</span>(Nts[,i], <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">2</span>)[<span class="fu">as.factor</span>(sites<span class="sc">$</span>culture)[i]]))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<pre><code>## [[1]]
## NULL
## 
## [[2]]
## NULL
## 
## [[3]]
## NULL
## 
## [[4]]
## NULL
## 
## [[5]]
## NULL
## 
## [[6]]
## NULL
## 
## [[7]]
## NULL
## 
## [[8]]
## NULL
## 
## [[9]]
## NULL
## 
## [[10]]
## NULL
## 
## [[11]]
## NULL
## 
## [[12]]
## NULL
## 
## [[13]]
## NULL
## 
## [[14]]
## NULL
## 
## [[15]]
## NULL
## 
## [[16]]
## NULL
## 
## [[17]]
## NULL
## 
## [[18]]
## NULL
## 
## [[19]]
## NULL
## 
## [[20]]
## NULL
## 
## [[21]]
## NULL
## 
## [[22]]
## NULL
## 
## [[23]]
## NULL
## 
## [[24]]
## NULL
## 
## [[25]]
## NULL
## 
## [[26]]
## NULL
## 
## [[27]]
## NULL
## 
## [[28]]
## NULL
## 
## [[29]]
## NULL
## 
## [[30]]
## NULL
## 
## [[31]]
## NULL
## 
## [[32]]
## NULL
## 
## [[33]]
## NULL
## 
## [[34]]
## NULL
## 
## [[35]]
## NULL
## 
## [[36]]
## NULL
## 
## [[37]]
## NULL
## 
## [[38]]
## NULL
## 
## [[39]]
## NULL
## 
## [[40]]
## NULL
## 
## [[41]]
## NULL
## 
## [[42]]
## NULL
## 
## [[43]]
## NULL
## 
## [[44]]
## NULL
## 
## [[45]]
## NULL
## 
## [[46]]
## NULL
## 
## [[47]]
## NULL</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="population-growth-conflicts-and-migrations.html#cb50-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">apply</span>(Nts, <span class="dv">1</span>, sum)[<span class="dv">1</span><span class="sc">:</span>i], <span class="at">xlab=</span><span class="st">&quot;time&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;popsize&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-24-2.png" width="672" /></p>
<p>Exploring some trajectories of the simulations</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="population-growth-conflicts-and-migrations.html#cb51-1" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">nrow</span>(Nts)  <span class="co"># Get the number of rows in Nts</span></span>
<span id="cb51-2"><a href="population-growth-conflicts-and-migrations.html#cb51-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">apply</span>(Nts[<span class="dv">1</span><span class="sc">:</span>i, sites<span class="sc">$</span>culture<span class="sc">==</span><span class="st">&quot;F&quot;</span>,<span class="at">drop=</span>F], <span class="dv">1</span>, sum), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb51-3"><a href="population-growth-conflicts-and-migrations.html#cb51-3" tabindex="-1"></a>     <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">apply</span>(Nts, <span class="dv">1</span>, sum))))  <span class="co"># Plot sum of &#39;F&#39; culture values</span></span>
<span id="cb51-4"><a href="population-growth-conflicts-and-migrations.html#cb51-4" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">apply</span>(Nts[<span class="dv">1</span><span class="sc">:</span>i, sites<span class="sc">$</span>culture<span class="sc">==</span><span class="st">&quot;HG&quot;</span>], <span class="dv">1</span>, sum),</span>
<span id="cb51-5"><a href="population-growth-conflicts-and-migrations.html#cb51-5" tabindex="-1"></a>       <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)  <span class="co"># Add points for &#39;HG&#39; culture values</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="population-growth-conflicts-and-migrations.html#cb52-1" tabindex="-1"></a><span class="fu">plot</span>(warcasualties[<span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>)], <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">type=</span><span class="st">&quot;h&quot;</span>, <span class="at">yaxt=</span><span class="st">&quot;n&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>)  <span class="co"># Plot war casualties</span></span>
<span id="cb52-2"><a href="population-growth-conflicts-and-migrations.html#cb52-2" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">4</span>)  <span class="co"># Add an axis on the right side</span></span>
<span id="cb52-3"><a href="population-growth-conflicts-and-migrations.html#cb52-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span>T)  <span class="co"># Allow a new plot to be drawn on the existing plot</span></span>
<span id="cb52-4"><a href="population-growth-conflicts-and-migrations.html#cb52-4" tabindex="-1"></a>growF <span class="ot">&lt;-</span> <span class="fu">apply</span>(Nts[<span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>), sites<span class="sc">$</span>culture<span class="sc">==</span><span class="st">&quot;F&quot;</span>,<span class="at">drop=</span>F], <span class="dv">1</span>, sum)  <span class="co"># Sum of &#39;F&#39; culture values excluding last row</span></span>
<span id="cb52-5"><a href="population-growth-conflicts-and-migrations.html#cb52-5" tabindex="-1"></a>growHG <span class="ot">&lt;-</span> <span class="fu">apply</span>(Nts[<span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-1</span>), sites<span class="sc">$</span>culture<span class="sc">==</span><span class="st">&quot;HG&quot;</span>,<span class="at">drop=</span>F], <span class="dv">1</span>, sum)  <span class="co"># Sum of &#39;HG&#39; culture values excluding last row</span></span>
<span id="cb52-6"><a href="population-growth-conflicts-and-migrations.html#cb52-6" tabindex="-1"></a><span class="fu">plot</span>(growF, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(growF, growHG)))  <span class="co"># Plot growth of &#39;F&#39; culture</span></span>
<span id="cb52-7"><a href="population-growth-conflicts-and-migrations.html#cb52-7" tabindex="-1"></a><span class="fu">points</span>(growHG, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)  <span class="co"># Add points for growth of &#39;HG&#39; culture</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-25-2.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="landscape-climate-environment.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="record-formation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
